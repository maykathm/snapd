Running command: spread google-nested:ubuntu-24.04-64:tests/nested/classic/hotplug google-nested:ubuntu-24.04-64:tests/nested/classic/snapshots-with-core-refresh-revert google-nested:ubuntu-24.04-64:tests/nested/core/bad-try-kernel-no-reboot google-nested:ubuntu-24.04-64:tests/nested/core/base-revert-after-boot google-nested:ubuntu-24.04-64:tests/nested/core/connected-after-reboot-revert google-nested:ubuntu-24.04-64:tests/nested/core/core-fde-state google-nested:ubuntu-24.04-64:tests/nested/core/core-gadget-mounted google-nested:ubuntu-24.04-64:tests/nested/core/core20-basic google-nested:ubuntu-24.04-64:tests/nested/core/core20-degraded google-nested:ubuntu-24.04-64:tests/nested/core/core20-factory-reset:nofde google-nested:ubuntu-24.04-64:tests/nested/core/core20-factory-reset:fde google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-install:snapd_reboot_auto_connect google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-install:snapd_panic_auto_connect google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:snapd_reboot_link_snap google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_reboot_refresh_gadget_assets google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_panic_auto_connect google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_panic_link_snap google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_panic_link_snap google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_reboot_link_snap google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_reboot_refresh_gadget_assets google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_panic_auto_connect google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_reboot_link_snap google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_reboot_link_snap google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_panic_refresh_gadget_assets google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_panic_auto_connect google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_panic_refresh_gadget_assets google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_reboot_auto_connect google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_reboot_auto_connect google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:snapd_panic_link_snap google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_reboot_auto_connect google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_panic_link_snap google-nested:ubuntu-24.04-64:tests/nested/core/core20-gadget-reseal google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:empty google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:bad_initrd google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:zeros google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:nolink google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:bad_text google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:bad_linux google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:crash google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-reseal google-nested:ubuntu-24.04-64:tests/nested/core/core20-reinstall-partitions google-nested:ubuntu-24.04-64:tests/nested/core/core20-set-efi-boot-variables google-nested:ubuntu-24.04-64:tests/nested/core/coreconfig-services google-nested:ubuntu-24.04-64:tests/nested/core/interfaces-custom-devices google-nested:ubuntu-24.04-64:tests/nested/core/kernel-revert-after-boot google-nested:ubuntu-24.04-64:tests/nested/core/remount-hotplug google-nested:ubuntu-24.04-64:tests/nested/core/save-data google-nested:ubuntu-24.04-64:tests/nested/manual/broken-model:tpm google-nested:ubuntu-24.04-64:tests/nested/manual/broken-model:hook google-nested:ubuntu-24.04-64:tests/nested/manual/build-with-kernel-modules-components:encrypted google-nested:ubuntu-24.04-64:tests/nested/manual/build-with-kernel-modules-components:plain google-nested:ubuntu-24.04-64:tests/nested/manual/cmdline-option:signed google-nested:ubuntu-24.04-64:tests/nested/manual/cmdline-option:dangerous google-nested:ubuntu-24.04-64:tests/nested/manual/cmdline-remove-append google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system-offline google-nested:ubuntu-24.04-64:tests/nested/manual/core-dbx-revokes-old-keys google-nested:ubuntu-24.04-64:tests/nested/manual/core-factory-reset-new-secboot:tpm google-nested:ubuntu-24.04-64:tests/nested/manual/core-factory-reset-new-secboot:hook google-nested:ubuntu-24.04-64:tests/nested/manual/core-recover-from-recovery:clear_tpm google-nested:ubuntu-24.04-64:tests/nested/manual/core-recover-from-recovery:break_dbx google-nested:ubuntu-24.04-64:tests/nested/manual/core-shim-update-revokes-old-keys google-nested:ubuntu-24.04-64:tests/nested/manual/core20-4k-sector-size:logical google-nested:ubuntu-24.04-64:tests/nested/manual/core20-4k-sector-size:physical_only google-nested:ubuntu-24.04-64:tests/nested/manual/core20-auto-remove-user google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:gadgetfull google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:gadgetextra google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:nogadget google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetwithoutopinion google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetsaysnone google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetsaysmaas google-nested:ubuntu-24.04-64:tests/nested/manual/core20-create-recovery google-nested:ubuntu-24.04-64:tests/nested/manual/core20-custom-kernel-commandline google-nested:ubuntu-24.04-64:tests/nested/manual/core20-da-lockout:encrypted google-nested:ubuntu-24.04-64:tests/nested/manual/core20-early-config google-nested:ubuntu-24.04-64:tests/nested/manual/core20-factory-reset-install-device-hook google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-install-component:kernel_panic_prepare_kernel_components google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:gadget_reboot_remodel_boot_assets google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:kernel_reboot_remodel_boot_assets google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:kernel_panic_remodel_boot_assets google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:gadget_panic_remodel_boot_assets google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-update-config:gadget_panic_command_line google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fde-dbx google-nested:ubuntu-24.04-64:tests/nested/manual/core20-gadget-cloud-conf:secured google-nested:ubuntu-24.04-64:tests/nested/manual/core20-gadget-cloud-conf:signed google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-above-testkeys-boot:secured google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-above-testkeys-boot:signed google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-cloud-init-testkeys google-nested:ubuntu-24.04-64:tests/nested/manual/core20-initramfs-time-moves-forward google-nested:ubuntu-24.04-64:tests/nested/manual/core20-install-device-file-install-ubuntu-save-via-hook google-nested:ubuntu-24.04-64:tests/nested/manual/core20-install-device-file-install-via-hook-hack google-nested:ubuntu-24.04-64:tests/nested/manual/core20-install-mode-shutdown-via-hook google-nested:ubuntu-24.04-64:tests/nested/manual/core20-new-snapd-does-not-break-old-initrd google-nested:ubuntu-24.04-64:tests/nested/manual/core20-nofde-dbx google-nested:ubuntu-24.04-64:tests/nested/manual/core20-preseed google-nested:ubuntu-24.04-64:tests/nested/manual/core20-remodel google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:UBUNTUDIR google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:UBUNTUDIR_NOSEC google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:BOOTDIR_NOSEC google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:BOOTDIR google-nested:ubuntu-24.04-64:tests/nested/manual/core22-basic:files google-nested:ubuntu-24.04-64:tests/nested/manual/core22-basic:tokens google-nested:ubuntu-24.04-64:tests/nested/manual/devmode-snap-seeded-dangerous google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-dbx google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2504 google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2404 google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-remodel google-nested:ubuntu-24.04-64:tests/nested/manual/install-min-size google-nested:ubuntu-24.04-64:tests/nested/manual/install-volume-assignment google-nested:ubuntu-24.04-64:tests/nested/manual/kernel-modules-components:plain google-nested:ubuntu-24.04-64:tests/nested/manual/kernel-modules-components:encrypted google-nested:ubuntu-24.04-64:tests/nested/manual/minimal-smoke:secboot_disabled google-nested:ubuntu-24.04-64:tests/nested/manual/minimal-smoke:secboot_enabled google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:plain google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:passphrase_auth google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_snap_and_comp google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_snap google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_all google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-oldbasenewkernel google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:seeded google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:encrypted google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:partial google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:plain google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2404 google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2504 google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2id google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:pbkdf2 google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2i google-nested:ubuntu-24.04-64:tests/nested/manual/preseed google-nested:ubuntu-24.04-64:tests/nested/manual/preseed-early-snap-run google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:tested google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:untested google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:pre_installed_snaps google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:pre_installed_snaps_json google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-reboot:factory_reset google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-reboot:install google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-reboot:recover google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:default google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:no_test_or_default google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:tested google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:tested_and_default google-nested:ubuntu-24.04-64:tests/nested/manual/refresh-revert-fundamentals:base google-nested:ubuntu-24.04-64:tests/nested/manual/refresh-revert-fundamentals:snapd google-nested:ubuntu-24.04-64:tests/nested/manual/refresh-revert-fundamentals:kernel google-nested:ubuntu-24.04-64:tests/nested/manual/refresh-revert-fundamentals:gadget google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-min-size google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-simple:offline google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-to-installed-kernel google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-validation-sets-downgrade google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-validation-sets-invalid google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-with-components google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-with-components-offline google-nested:ubuntu-24.04-64:tests/nested/manual/seeding-failure google-nested:ubuntu-24.04-64:tests/nested/manual/snapd-removes-vulnerable-snap-confine-revs:core google-nested:ubuntu-24.04-64:tests/nested/manual/snapd-removes-vulnerable-snap-confine-revs:snapd google-nested:ubuntu-24.04-64:tests/nested/manual/split-refresh google-nested:ubuntu-24.04-64:tests/nested/manual/uc-grub-boot-chains google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-assets-secure:both google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-assets-secure:boot google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-assets-secure:seed google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-command-line-secure google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-fde-hooks-ice google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-fde-hooks-v1 google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-fde-hooks:files google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-fde-hooks:tokens google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:both google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:hook google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:none google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:secureboot google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-storage-safety:preferunencrypted google-nested:ubuntu-24.04-64:tests/nested/manual/update-snapd-seed-and-factory-reset:tpm     
2025-07-31 06:00:16 Project content is packed for delivery (2.04MB).
2025-07-31 06:00:16 Sequence of jobs produced with -seed=1753941616
2025-07-31 06:00:16 If killed, discard servers with: spread -reuse-pid=555098 -discard
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:16 Allocating google-nested:ubuntu-24.04-64...
2025-07-31 06:00:34 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372884) to boot at 35.239.216.206...
2025-07-31 06:00:35 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372894) to boot at 35.193.69.92...
2025-07-31 06:00:35 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372800) to boot at 34.123.232.97...
2025-07-31 06:00:35 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372836) to boot at 34.123.101.152...
2025-07-31 06:00:36 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372849) to boot at 34.61.61.18...
2025-07-31 06:00:37 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372870) to boot at 35.192.46.150...
2025-07-31 06:00:38 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372880) to boot at 34.63.221.169...
2025-07-31 06:00:39 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372875) to boot at 104.154.111.230...
2025-07-31 06:00:40 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372844) to boot at 34.59.233.143...
2025-07-31 06:00:42 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372854) to boot at 34.136.212.199...
2025-07-31 06:00:42 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372865) to boot at 34.134.52.60...
2025-07-31 06:00:43 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372859) to boot at 34.61.216.207...
2025-07-31 06:00:44 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372889) to boot at 34.132.74.39...
2025-07-31 06:00:44 Waiting for google-nested:ubuntu-24.04-64 (jul310600-372695) to boot at 34.67.112.69...
2025-07-31 06:00:56 Allocated google-nested:ubuntu-24.04-64 (jul310600-372800).
2025-07-31 06:00:56 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372800)...
2025-07-31 06:00:56 Allocated google-nested:ubuntu-24.04-64 (jul310600-372836).
2025-07-31 06:00:57 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372836)...
2025-07-31 06:00:57 Connected to google-nested:ubuntu-24.04-64 (jul310600-372800) at 34.123.232.97.
2025-07-31 06:00:57 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372800)...
2025-07-31 06:00:57 Connected to google-nested:ubuntu-24.04-64 (jul310600-372836) at 34.123.101.152.
2025-07-31 06:00:57 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372836)...
2025-07-31 06:00:57 Allocated google-nested:ubuntu-24.04-64 (jul310600-372849).
2025-07-31 06:00:58 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372849)...
2025-07-31 06:00:58 Allocated google-nested:ubuntu-24.04-64 (jul310600-372865).
2025-07-31 06:00:58 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372865)...
2025-07-31 06:00:58 Connected to google-nested:ubuntu-24.04-64 (jul310600-372849) at 34.61.61.18.
2025-07-31 06:00:58 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372849)...
2025-07-31 06:00:59 Connected to google-nested:ubuntu-24.04-64 (jul310600-372865) at 34.134.52.60.
2025-07-31 06:00:59 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372865)...
2025-07-31 06:00:59 Allocated google-nested:ubuntu-24.04-64 (jul310600-372880).
2025-07-31 06:00:59 Preparing google-nested:ubuntu-24.04-64 (jul310600-372800)...
2025-07-31 06:00:59 Preparing google-nested:ubuntu-24.04-64 (jul310600-372836)...
2025-07-31 06:01:00 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372880)...
2025-07-31 06:01:00 Allocated google-nested:ubuntu-24.04-64 (jul310600-372875).
2025-07-31 06:01:00 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372875)...
2025-07-31 06:01:00 Allocated google-nested:ubuntu-24.04-64 (jul310600-372889).
2025-07-31 06:01:00 Connected to google-nested:ubuntu-24.04-64 (jul310600-372880) at 34.63.221.169.
2025-07-31 06:01:00 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372880)...
2025-07-31 06:01:01 Preparing google-nested:ubuntu-24.04-64 (jul310600-372849)...
2025-07-31 06:01:01 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372889)...
2025-07-31 06:01:01 Preparing google-nested:ubuntu-24.04-64 (jul310600-372865)...
2025-07-31 06:01:01 Allocated google-nested:ubuntu-24.04-64 (jul310600-372884).
2025-07-31 06:01:01 Connected to google-nested:ubuntu-24.04-64 (jul310600-372875) at 104.154.111.230.
2025-07-31 06:01:01 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372875)...
2025-07-31 06:01:01 Allocated google-nested:ubuntu-24.04-64 (jul310600-372894).
2025-07-31 06:01:01 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372884)...
2025-07-31 06:01:02 Allocated google-nested:ubuntu-24.04-64 (jul310600-372844).
2025-07-31 06:01:02 Connected to google-nested:ubuntu-24.04-64 (jul310600-372889) at 34.132.74.39.
2025-07-31 06:01:02 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372889)...
2025-07-31 06:01:02 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372894)...
2025-07-31 06:01:02 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372844)...
2025-07-31 06:01:02 Connected to google-nested:ubuntu-24.04-64 (jul310600-372884) at 35.239.216.206.
2025-07-31 06:01:02 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372884)...
2025-07-31 06:01:02 Connected to google-nested:ubuntu-24.04-64 (jul310600-372894) at 35.193.69.92.
2025-07-31 06:01:02 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372894)...
2025-07-31 06:01:03 Preparing google-nested:ubuntu-24.04-64 (jul310600-372880)...
2025-07-31 06:01:03 Connected to google-nested:ubuntu-24.04-64 (jul310600-372844) at 34.59.233.143.
2025-07-31 06:01:03 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372844)...
2025-07-31 06:01:03 Allocated google-nested:ubuntu-24.04-64 (jul310600-372854).
2025-07-31 06:01:03 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372854)...
2025-07-31 06:01:03 Preparing google-nested:ubuntu-24.04-64 (jul310600-372875)...
2025-07-31 06:01:03 Allocated google-nested:ubuntu-24.04-64 (jul310600-372870).
2025-07-31 06:01:03 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372870)...
2025-07-31 06:01:03 Preparing google-nested:ubuntu-24.04-64 (jul310600-372889)...
2025-07-31 06:01:04 Allocated google-nested:ubuntu-24.04-64 (jul310600-372859).
2025-07-31 06:01:04 Connected to google-nested:ubuntu-24.04-64 (jul310600-372854) at 34.136.212.199.
2025-07-31 06:01:04 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372854)...
2025-07-31 06:01:04 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372859)...
2025-07-31 06:01:04 Connected to google-nested:ubuntu-24.04-64 (jul310600-372870) at 35.192.46.150.
2025-07-31 06:01:04 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372870)...
2025-07-31 06:01:05 Preparing google-nested:ubuntu-24.04-64 (jul310600-372884)...
2025-07-31 06:01:05 Preparing google-nested:ubuntu-24.04-64 (jul310600-372844)...
2025-07-31 06:01:05 Connected to google-nested:ubuntu-24.04-64 (jul310600-372859) at 34.61.216.207.
2025-07-31 06:01:05 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372859)...
2025-07-31 06:01:05 Allocated google-nested:ubuntu-24.04-64 (jul310600-372695).
2025-07-31 06:01:05 Connecting to google-nested:ubuntu-24.04-64 (jul310600-372695)...
2025-07-31 06:01:06 Preparing google-nested:ubuntu-24.04-64 (jul310600-372894)...
2025-07-31 06:01:06 Preparing google-nested:ubuntu-24.04-64 (jul310600-372870)...
2025-07-31 06:01:06 Preparing google-nested:ubuntu-24.04-64 (jul310600-372854)...
2025-07-31 06:01:06 Connected to google-nested:ubuntu-24.04-64 (jul310600-372695) at 34.67.112.69.
2025-07-31 06:01:06 Sending project content to google-nested:ubuntu-24.04-64 (jul310600-372695)...
2025-07-31 06:01:07 Preparing google-nested:ubuntu-24.04-64 (jul310600-372859)...
2025-07-31 06:01:08 Preparing google-nested:ubuntu-24.04-64 (jul310600-372695)...
2025-07-31 06:06:00 WARNING: jul310600-372800 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 700 lines above ...)
334 translated messages, 147 untranslated messages.
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
-----
.
2025-07-31 06:06:00 WARNING: jul310600-372836 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 708 lines above ...)
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
(cd _build/bin && GOPATH=$(pwd)/.. go build -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie  -tags "nomanagers,withtestkeys,faultinject,statelocktrace,nooptee" github.com/snapcore/snapd/cmd/snap)
-----
.
2025-07-31 06:06:01 WARNING: jul310600-372849 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 701 lines above ...)
334 translated messages, 147 untranslated messages.
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
-----
.
2025-07-31 06:06:01 WARNING: jul310600-372865 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 701 lines above ...)
334 translated messages, 147 untranslated messages.
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
-----
.
2025-07-31 06:06:03 WARNING: jul310600-372880 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 702 lines above ...)
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
(cd _build/bin && GOPATH=$(pwd)/.. go build -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie  -tags "nomanagers,withtestkeys,faultinject,statelocktrace,nooptee" github.com/snapcore/snapd/cmd/snap)
-----
.
2025-07-31 06:06:03 WARNING: jul310600-372875 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 702 lines above ...)
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
(cd _build/bin && GOPATH=$(pwd)/.. go build -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie  -tags "nomanagers,withtestkeys,faultinject,statelocktrace,nooptee" github.com/snapcore/snapd/cmd/snap)
-----
.
2025-07-31 06:06:04 WARNING: jul310600-372889 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 710 lines above ...)
334 translated messages, 147 untranslated messages.
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
-----
.
2025-07-31 06:06:05 WARNING: jul310600-372884 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 707 lines above ...)
334 translated messages, 147 untranslated messages.
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
-----
.
2025-07-31 06:06:05 WARNING: jul310600-372844 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 702 lines above ...)
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
(cd _build/bin && GOPATH=$(pwd)/.. go build -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie  -tags "nomanagers,withtestkeys,faultinject,statelocktrace,nooptee" github.com/snapcore/snapd/cmd/snap)
-----
.
2025-07-31 06:06:06 WARNING: jul310600-372894 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 701 lines above ...)
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
(cd _build/bin && GOPATH=$(pwd)/.. go build -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie  -tags "nomanagers,withtestkeys,faultinject,statelocktrace,nooptee" github.com/snapcore/snapd/cmd/snap)
-----
.
2025-07-31 06:06:06 WARNING: jul310600-372870 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 708 lines above ...)
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
(cd _build/bin && GOPATH=$(pwd)/.. go build -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie  -tags "nomanagers,withtestkeys,faultinject,statelocktrace,nooptee" github.com/snapcore/snapd/cmd/snap)
-----
.
2025-07-31 06:06:06 WARNING: jul310600-372854 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 713 lines above ...)
334 translated messages, 147 untranslated messages.
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
-----
.
2025-07-31 06:06:07 WARNING: jul310600-372859 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 708 lines above ...)
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
(cd _build/bin && GOPATH=$(pwd)/.. go build -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie  -tags "nomanagers,withtestkeys,faultinject,statelocktrace,nooptee" github.com/snapcore/snapd/cmd/snap)
-----
.
2025-07-31 06:06:09 WARNING: jul310600-372695 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 701 lines above ...)
0 translated messages, 481 untranslated messages.
7 translated messages, 474 untranslated messages.
164 translated messages, 317 untranslated messages.
0 translated messages, 481 untranslated messages.
297 translated messages, 184 untranslated messages.
0 translated messages, 481 untranslated messages.
3 translated messages, 478 untranslated messages.
*** Setting version to '1337.2.70' from changelog.
cd _build && go install -trimpath -v -p 1 -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie -tags withtestkeys,withbootassetstesting,faultinject,statelocktrace,nooptee github.com/snapcore/snapd/cmd/... github.com/snapcore/snapd/advisor github.com/snapcore/snapd/arch github.com/snapcore/snapd/arch/archtest github.com/snapcore/snapd/asserts github.com/snapcore/snapd/asserts/assertstest github.com/snapcore/snapd/asserts/info github.com/snapcore/snapd/asserts/internal github.com/snapcore/snapd/asserts/signtool github.com/snapcore/snapd/asserts/snapasserts github.com/snapcore/snapd/asserts/sysdb github.com/snapcore/snapd/asserts/systestkeys github.com/snapcore/snapd/boot github.com/snapcore/snapd/boot/boottest github.com/snapcore/snapd/bootloader github.com/snapcore/snapd/bootloader/androidbootenv github.com/snapcore/snapd/bootloader/assets github.com/snapcore/snapd/bootloader/assets/genasset github.com/snapcore/snapd/bootloader/bootloadertest github.com/snapcore/snapd/bootloader/efi github.com/snapcore/snapd/bootloader/grubenv github.com/snapcore/snapd/bootloader/lkenv github.com/snapcore/snapd/bootloader/ubootenv github.com/snapcore/snapd/client github.com/snapcore/snapd/client/clientutil github.com/snapcore/snapd/cluster/assemblestate github.com/snapcore/snapd/cluster/assemblestate/bimap github.com/snapcore/snapd/cluster/assemblestate/intset github.com/snapcore/snapd/cmd/snap github.com/snapcore/snapd/cmd/snap-bootstrap github.com/snapcore/snapd/cmd/snap-bootstrap/blkid github.com/snapcore/snapd/cmd/snap-bootstrap/triggerwatch github.com/snapcore/snapd/cmd/snap-exec github.com/snapcore/snapd/cmd/snap-failure github.com/snapcore/snapd/cmd/snap-fde-keymgr github.com/snapcore/snapd/cmd/snap-gpio-helper github.com/snapcore/snapd/cmd/snap-preseed github.com/snapcore/snapd/cmd/snap-recovery-chooser github.com/snapcore/snapd/cmd/snap-repair github.com/snapcore/snapd/cmd/snap-seccomp github.com/snapcore/snapd/cmd/snap-seccomp/syscalls github.com/snapcore/snapd/cmd/snap-update-ns github.com/snapcore/snapd/cmd/snapctl github.com/snapcore/snapd/cmd/snapd github.com/snapcore/snapd/cmd/snapd-apparmor github.com/snapcore/snapd/cmd/snaplock github.com/snapcore/snapd/cmd/snaplock/runinhibit github.com/snapcore/snapd/confdb github.com/snapcore/snapd/daemon github.com/snapcore/snapd/dbusutil github.com/snapcore/snapd/dbusutil/dbustest github.com/snapcore/snapd/dbusutil/netplantest github.com/snapcore/snapd/desktop/desktopentry github.com/snapcore/snapd/desktop/notification github.com/snapcore/snapd/desktop/notification/notificationtest github.com/snapcore/snapd/desktop/portal github.com/snapcore/snapd/dirs github.com/snapcore/snapd/dirs/dirstest github.com/snapcore/snapd/docs github.com/snapcore/snapd/features github.com/snapcore/snapd/gadget github.com/snapcore/snapd/gadget/device github.com/snapcore/snapd/gadget/edition github.com/snapcore/snapd/gadget/gadgettest github.com/snapcore/snapd/gadget/install github.com/snapcore/snapd/gadget/quantity github.com/snapcore/snapd/httputil github.com/snapcore/snapd/i18n github.com/snapcore/snapd/i18n/xgettext-go github.com/snapcore/snapd/image github.com/snapcore/snapd/image/preseed github.com/snapcore/snapd/interfaces github.com/snapcore/snapd/interfaces/apparmor github.com/snapcore/snapd/interfaces/backends github.com/snapcore/snapd/interfaces/builtin github.com/snapcore/snapd/interfaces/configfiles github.com/snapcore/snapd/interfaces/dbus github.com/snapcore/snapd/interfaces/hotplug github.com/snapcore/snapd/interfaces/ifacetest github.com/snapcore/snapd/interfaces/kmod github.com/snapcore/snapd/interfaces/ldconfig github.com/snapcore/snapd/interfaces/mount github.com/snapcore/snapd/interfaces/policy github.com/snapcore/snapd/interfaces/polkit github.com/snapcore/snapd/interfaces/prompting github.com/snapcore/snapd/interfaces/prompting/errors github.com/snapcore/snapd/interfaces/prompting/internal/maxidmmap github.com/snapcore/snapd/interfaces/prompting/patterns github.com/snapcore/snapd/interfaces/prompting/requestprompts github.com/snapcore/snapd/interfaces/prompting/requestrules github.com/snapcore/snapd/interfaces/seccomp github.com/snapcore/snapd/interfaces/symlinks github.com/snapcore/snapd/interfaces/systemd github.com/snapcore/snapd/interfaces/udev github.com/snapcore/snapd/interfaces/utils github.com/snapcore/snapd/jsonutil github.com/snapcore/snapd/jsonutil/safejson github.com/snapcore/snapd/kernel github.com/snapcore/snapd/kernel/fde github.com/snapcore/snapd/kernel/fde/optee github.com/snapcore/snapd/kernel/fde/optee/opteetest github.com/snapcore/snapd/logger github.com/snapcore/snapd/metautil github.com/snapcore/snapd/netutil github.com/snapcore/snapd/osutil github.com/snapcore/snapd/osutil/disks github.com/snapcore/snapd/osutil/epoll github.com/snapcore/snapd/osutil/fips github.com/snapcore/snapd/osutil/inotify github.com/snapcore/snapd/osutil/kcmdline github.com/snapcore/snapd/osutil/kmod github.com/snapcore/snapd/osutil/mkfs github.com/snapcore/snapd/osutil/mount github.com/snapcore/snapd/osutil/mount/libmount github.com/snapcore/snapd/osutil/squashfs github.com/snapcore/snapd/osutil/strace github.com/snapcore/snapd/osutil/sys github.com/snapcore/snapd/osutil/udev/crawler github.com/snapcore/snapd/osutil/udev/netlink github.com/snapcore/snapd/osutil/user github.com/snapcore/snapd/osutil/vfs github.com/snapcore/snapd/overlord github.com/snapcore/snapd/overlord/assertstate github.com/snapcore/snapd/overlord/assertstate/assertstatetest github.com/snapcore/snapd/overlord/auth github.com/snapcore/snapd/overlord/cmdstate github.com/snapcore/snapd/overlord/confdbstate github.com/snapcore/snapd/overlord/configstate github.com/snapcore/snapd/overlord/configstate/config github.com/snapcore/snapd/overlord/configstate/configcore github.com/snapcore/snapd/overlord/configstate/proxyconf github.com/snapcore/snapd/overlord/devicestate github.com/snapcore/snapd/overlord/devicestate/devicestatetest github.com/snapcore/snapd/overlord/devicestate/internal github.com/snapcore/snapd/overlord/fdestate github.com/snapcore/snapd/overlord/fdestate/backend github.com/snapcore/snapd/overlord/healthstate github.com/snapcore/snapd/overlord/hookstate github.com/snapcore/snapd/overlord/hookstate/ctlcmd github.com/snapcore/snapd/overlord/hookstate/hooktest github.com/snapcore/snapd/overlord/ifacestate github.com/snapcore/snapd/overlord/ifacestate/apparmorprompting github.com/snapcore/snapd/overlord/ifacestate/ifacerepo github.com/snapcore/snapd/overlord/ifacestate/schema github.com/snapcore/snapd/overlord/ifacestate/udevmonitor github.com/snapcore/snapd/overlord/install github.com/snapcore/snapd/overlord/patch github.com/snapcore/snapd/overlord/restart github.com/snapcore/snapd/overlord/servicestate github.com/snapcore/snapd/overlord/servicestate/internal github.com/snapcore/snapd/overlord/servicestate/servicestatetest github.com/snapcore/snapd/overlord/snapshotstate github.com/snapcore/snapd/overlord/snapshotstate/backend github.com/snapcore/snapd/overlord/snapstate github.com/snapcore/snapd/overlord/snapstate/agentnotify github.com/snapcore/snapd/overlord/snapstate/backend github.com/snapcore/snapd/overlord/snapstate/policy github.com/snapcore/snapd/overlord/snapstate/sequence github.com/snapcore/snapd/overlord/snapstate/snapstatetest github.com/snapcore/snapd/overlord/standby github.com/snapcore/snapd/overlord/state github.com/snapcore/snapd/overlord/storecontext github.com/snapcore/snapd/overlord/swfeats github.com/snapcore/snapd/polkit github.com/snapcore/snapd/polkit/validate github.com/snapcore/snapd/progress github.com/snapcore/snapd/progress/progresstest github.com/snapcore/snapd/randutil github.com/snapcore/snapd/release github.com/snapcore/snapd/sandbox github.com/snapcore/snapd/sandbox/apparmor github.com/snapcore/snapd/sandbox/apparmor/notify github.com/snapcore/snapd/sandbox/apparmor/notify/listener github.com/snapcore/snapd/sandbox/cgroup github.com/snapcore/snapd/sandbox/gpio github.com/snapcore/snapd/sandbox/lsm github.com/snapcore/snapd/sandbox/seccomp github.com/snapcore/snapd/sandbox/selinux github.com/snapcore/snapd/secboot github.com/snapcore/snapd/secboot/keymgr github.com/snapcore/snapd/secboot/keys github.com/snapcore/snapd/secboot/luks2 github.com/snapcore/snapd/seed github.com/snapcore/snapd/seed/internal github.com/snapcore/snapd/seed/seedtest github.com/snapcore/snapd/seed/seedwriter github.com/snapcore/snapd/snap github.com/snapcore/snapd/snap/channel github.com/snapcore/snapd/snap/integrity github.com/snapcore/snapd/snap/integrity/dmverity github.com/snapcore/snapd/snap/internal github.com/snapcore/snapd/snap/naming github.com/snapcore/snapd/snap/pack github.com/snapcore/snapd/snap/quota github.com/snapcore/snapd/snap/snapdir github.com/snapcore/snapd/snap/snapenv github.com/snapcore/snapd/snap/snapfile github.com/snapcore/snapd/snap/snaptest github.com/snapcore/snapd/snap/squashfs github.com/snapcore/snapd/snap/sysparams github.com/snapcore/snapd/snapdenv github.com/snapcore/snapd/snapdtool github.com/snapcore/snapd/spdx github.com/snapcore/snapd/store github.com/snapcore/snapd/store/storetest github.com/snapcore/snapd/store/tooling github.com/snapcore/snapd/strutil github.com/snapcore/snapd/strutil/chrorder github.com/snapcore/snapd/strutil/quantity github.com/snapcore/snapd/strutil/shlex github.com/snapcore/snapd/syscheck github.com/snapcore/snapd/sysconfig github.com/snapcore/snapd/systemd github.com/snapcore/snapd/systemd/systemdtest github.com/snapcore/snapd/testtime github.com/snapcore/snapd/testutil github.com/snapcore/snapd/timeout github.com/snapcore/snapd/timeutil github.com/snapcore/snapd/timings github.com/snapcore/snapd/usersession/agent github.com/snapcore/snapd/usersession/autostart github.com/snapcore/snapd/usersession/client github.com/snapcore/snapd/usersession/userd github.com/snapcore/snapd/usersession/userd/ui github.com/snapcore/snapd/usersession/xdgopenproxy github.com/snapcore/snapd/wrappers github.com/snapcore/snapd/wrappers/internal github.com/snapcore/snapd/x11
(cd _build/bin && GOPATH=$(pwd)/.. go build -mod=vendor -pkgdir=/home/gopath/src/github.com/snapcore/snapd/_build/std -ldflags=-w -buildmode=pie  -tags "nomanagers,withtestkeys,faultinject,statelocktrace,nooptee" github.com/snapcore/snapd/cmd/snap)
-----
.
2025-07-31 06:10:23 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372880)...
2025-07-31 06:10:24 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372870)...
2025-07-31 06:10:31 Preparing google-nested:ubuntu-24.04-64:tests/nested/classic/ (jul310600-372875)...
2025-07-31 06:10:31 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372844)...
2025-07-31 06:10:34 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372836)...
2025-07-31 06:10:41 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372859)...
2025-07-31 06:10:46 Preparing google-nested:ubuntu-24.04-64:tests/nested/classic/snapshots-with-core-refresh-revert (jul310600-372875)...
2025-07-31 06:11:00 WARNING: jul310600-372800 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 1326 lines above ...)
make[1]: Leaving directory '/home/gopath/src/github.com/snapcore/snapd'
dpkg-source -Zgzip --after-build .
dpkg-source: info: using options from snapd/debian/source/options: --tar-ignore=tests/lib/cache/*
dpkg-buildpackage: info: binary-only upload (no source included)
+ cp ../golang-github-snapcore-snapd-dev_1337.2.70_all.deb ../golang-github-ubuntu-core-snappy-dev_1337.2.70_all.deb ../snap-confine_1337.2.70_amd64.deb ../snapd-xdg-open_1337.2.70_amd64.deb ../snapd_1337.2.70_amd64.deb ../ubuntu-core-launcher_1337.2.70_amd64.deb ../ubuntu-core-snapd-units_1337.2.70_all.deb ../ubuntu-snappy-cli_1337.2.70_all.deb ../ubuntu-snappy_1337.2.70_all.deb /home/gopath
+ os.query is-debian sid
+ fakestore_tags=
+ '[' production = staging ']'
+ eval 'go install  ./tests/lib/fakestore/cmd/fakestore'
++ go install ./tests/lib/fakestore/cmd/fakestore
-----
.
2025-07-31 06:11:01 WARNING: jul310600-372849 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 1326 lines above ...)
make[1]: Leaving directory '/home/gopath/src/github.com/snapcore/snapd'
dpkg-source -Zgzip --after-build .
dpkg-source: info: using options from snapd/debian/source/options: --tar-ignore=tests/lib/cache/*
dpkg-buildpackage: info: binary-only upload (no source included)
+ cp ../golang-github-snapcore-snapd-dev_1337.2.70_all.deb ../golang-github-ubuntu-core-snappy-dev_1337.2.70_all.deb ../snap-confine_1337.2.70_amd64.deb ../snapd-xdg-open_1337.2.70_amd64.deb ../snapd_1337.2.70_amd64.deb ../ubuntu-core-launcher_1337.2.70_amd64.deb ../ubuntu-core-snapd-units_1337.2.70_all.deb ../ubuntu-snappy-cli_1337.2.70_all.deb ../ubuntu-snappy_1337.2.70_all.deb /home/gopath
+ os.query is-debian sid
+ fakestore_tags=
+ '[' production = staging ']'
+ eval 'go install  ./tests/lib/fakestore/cmd/fakestore'
++ go install ./tests/lib/fakestore/cmd/fakestore
-----
.
2025-07-31 06:11:01 WARNING: jul310600-372865 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 1036 lines above ...)
dh_md5sums -O--buildsystem=golang -O--fail-missing -O--builddirectory=_build
dh_builddeb -O--buildsystem=golang -O--fail-missing -O--builddirectory=_build
dpkg-deb: building package 'golang-github-ubuntu-core-snappy-dev' in '../golang-github-ubuntu-core-snappy-dev_1337.2.70_all.deb'.
dpkg-deb: building package 'ubuntu-snappy-cli' in '../ubuntu-snappy-cli_1337.2.70_all.deb'.
dpkg-deb: building package 'golang-github-snapcore-snapd-dev' in '../golang-github-snapcore-snapd-dev_1337.2.70_all.deb'.
dpkg-deb: building package 'ubuntu-core-snapd-units' in '../ubuntu-core-snapd-units_1337.2.70_all.deb'.
dpkg-deb: building package 'snap-confine' in '../snap-confine_1337.2.70_amd64.deb'.
dpkg-deb: building package 'ubuntu-core-launcher' in '../ubuntu-core-launcher_1337.2.70_amd64.deb'.
dpkg-deb: building package 'snapd-xdg-open' in '../snapd-xdg-open_1337.2.70_amd64.deb'.
dpkg-deb: building package 'snapd' in '../snapd_1337.2.70_amd64.deb'.
-----
.
2025-07-31 06:11:04 WARNING: jul310600-372889 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 1326 lines above ...)
make[1]: Leaving directory '/home/gopath/src/github.com/snapcore/snapd'
dpkg-source -Zgzip --after-build .
dpkg-source: info: using options from snapd/debian/source/options: --tar-ignore=tests/lib/cache/*
dpkg-buildpackage: info: binary-only upload (no source included)
+ cp ../golang-github-snapcore-snapd-dev_1337.2.70_all.deb ../golang-github-ubuntu-core-snappy-dev_1337.2.70_all.deb ../snap-confine_1337.2.70_amd64.deb ../snapd-xdg-open_1337.2.70_amd64.deb ../snapd_1337.2.70_amd64.deb ../ubuntu-core-launcher_1337.2.70_amd64.deb ../ubuntu-core-snapd-units_1337.2.70_all.deb ../ubuntu-snappy-cli_1337.2.70_all.deb ../ubuntu-snappy_1337.2.70_all.deb /home/gopath
+ os.query is-debian sid
+ fakestore_tags=
+ '[' production = staging ']'
+ eval 'go install  ./tests/lib/fakestore/cmd/fakestore'
++ go install ./tests/lib/fakestore/cmd/fakestore
-----
.
2025-07-31 06:11:05 WARNING: jul310600-372884 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 1036 lines above ...)
dh_md5sums -O--buildsystem=golang -O--fail-missing -O--builddirectory=_build
dh_builddeb -O--buildsystem=golang -O--fail-missing -O--builddirectory=_build
dpkg-deb: building package 'golang-github-ubuntu-core-snappy-dev' in '../golang-github-ubuntu-core-snappy-dev_1337.2.70_all.deb'.
dpkg-deb: building package 'ubuntu-snappy-cli' in '../ubuntu-snappy-cli_1337.2.70_all.deb'.
dpkg-deb: building package 'golang-github-snapcore-snapd-dev' in '../golang-github-snapcore-snapd-dev_1337.2.70_all.deb'.
dpkg-deb: building package 'ubuntu-core-snapd-units' in '../ubuntu-core-snapd-units_1337.2.70_all.deb'.
dpkg-deb: building package 'snap-confine' in '../snap-confine_1337.2.70_amd64.deb'.
dpkg-deb: building package 'ubuntu-core-launcher' in '../ubuntu-core-launcher_1337.2.70_amd64.deb'.
dpkg-deb: building package 'snapd-xdg-open' in '../snapd-xdg-open_1337.2.70_amd64.deb'.
dpkg-deb: building package 'snapd' in '../snapd_1337.2.70_amd64.deb'.
-----
.
2025-07-31 06:11:06 WARNING: jul310600-372894 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 1326 lines above ...)
dpkg-source -Zgzip --after-build .
dpkg-source: info: using options from snapd/debian/source/options: --tar-ignore=tests/lib/cache/*
dpkg-buildpackage: info: binary-only upload (no source included)
+ cp ../golang-github-snapcore-snapd-dev_1337.2.70_all.deb ../golang-github-ubuntu-core-snappy-dev_1337.2.70_all.deb ../snap-confine_1337.2.70_amd64.deb ../snapd-xdg-open_1337.2.70_amd64.deb ../snapd_1337.2.70_amd64.deb ../ubuntu-core-launcher_1337.2.70_amd64.deb ../ubuntu-core-snapd-units_1337.2.70_all.deb ../ubuntu-snappy-cli_1337.2.70_all.deb ../ubuntu-snappy_1337.2.70_all.deb /home/gopath
+ os.query is-debian sid
+ fakestore_tags=
+ '[' production = staging ']'
+ eval 'go install  ./tests/lib/fakestore/cmd/fakestore'
++ go install ./tests/lib/fakestore/cmd/fakestore
+ go install ./tests/lib/fakedevicesvc
-----
.
2025-07-31 06:11:06 WARNING: jul310600-372854 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 1036 lines above ...)
dh_md5sums -O--buildsystem=golang -O--fail-missing -O--builddirectory=_build
dh_builddeb -O--buildsystem=golang -O--fail-missing -O--builddirectory=_build
dpkg-deb: building package 'golang-github-ubuntu-core-snappy-dev' in '../golang-github-ubuntu-core-snappy-dev_1337.2.70_all.deb'.
dpkg-deb: building package 'ubuntu-snappy-cli' in '../ubuntu-snappy-cli_1337.2.70_all.deb'.
dpkg-deb: building package 'golang-github-snapcore-snapd-dev' in '../golang-github-snapcore-snapd-dev_1337.2.70_all.deb'.
dpkg-deb: building package 'ubuntu-core-snapd-units' in '../ubuntu-core-snapd-units_1337.2.70_all.deb'.
dpkg-deb: building package 'snap-confine' in '../snap-confine_1337.2.70_amd64.deb'.
dpkg-deb: building package 'ubuntu-core-launcher' in '../ubuntu-core-launcher_1337.2.70_amd64.deb'.
dpkg-deb: building package 'snapd-xdg-open' in '../snapd-xdg-open_1337.2.70_amd64.deb'.
dpkg-deb: building package 'snapd' in '../snapd_1337.2.70_amd64.deb'.
-----
.
2025-07-31 06:11:09 WARNING: jul310600-372695 (google-nested:ubuntu-24.04-64) running late. Current output:
-----
(... 1325 lines above ...)
make[1]: Leaving directory '/home/gopath/src/github.com/snapcore/snapd'
dpkg-source -Zgzip --after-build .
dpkg-source: info: using options from snapd/debian/source/options: --tar-ignore=tests/lib/cache/*
dpkg-buildpackage: info: binary-only upload (no source included)
+ cp ../golang-github-snapcore-snapd-dev_1337.2.70_all.deb ../golang-github-ubuntu-core-snappy-dev_1337.2.70_all.deb ../snap-confine_1337.2.70_amd64.deb ../snapd-xdg-open_1337.2.70_amd64.deb ../snapd_1337.2.70_amd64.deb ../ubuntu-core-launcher_1337.2.70_amd64.deb ../ubuntu-core-snapd-units_1337.2.70_all.deb ../ubuntu-snappy-cli_1337.2.70_all.deb ../ubuntu-snappy_1337.2.70_all.deb /home/gopath
+ os.query is-debian sid
+ fakestore_tags=
+ '[' production = staging ']'
+ eval 'go install  ./tests/lib/fakestore/cmd/fakestore'
++ go install ./tests/lib/fakestore/cmd/fakestore
-----
.
2025-07-31 06:11:10 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372894)...
2025-07-31 06:11:21 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372800)...
2025-07-31 06:11:24 Preparing google-nested:ubuntu-24.04-64:tests/nested/classic/ (jul310600-372849)...
2025-07-31 06:11:26 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372889)...
2025-07-31 06:11:28 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372695)...
2025-07-31 06:11:39 Preparing google-nested:ubuntu-24.04-64:tests/nested/classic/hotplug (jul310600-372849)...
2025-07-31 06:12:04 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372884)...
2025-07-31 06:12:07 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372865)...
2025-07-31 06:12:24 Executing google-nested:ubuntu-24.04-64:tests/nested/classic/snapshots-with-core-refresh-revert (jul310600-372875) (1/173)...
2025-07-31 06:12:28 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372854)...
2025-07-31 06:12:39 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-fde-hooks-ice (jul310600-372870)...
2025-07-31 06:12:51 Restoring google-nested:ubuntu-24.04-64:tests/nested/classic/snapshots-with-core-refresh-revert (jul310600-372875)...
2025-07-31 06:12:57 Restoring google-nested:ubuntu-24.04-64:tests/nested/classic/ (jul310600-372875)...
2025-07-31 06:12:57 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372875)...
2025-07-31 06:13:01 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/seeding-failure (jul310600-372844)...
2025-07-31 06:13:17 Executing google-nested:ubuntu-24.04-64:tests/nested/classic/hotplug (jul310600-372849) (2/173)...
2025-07-31 06:13:35 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:no_test_or_default (jul310600-372800)...
2025-07-31 06:14:30 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-dbx (jul310600-372865)...
2025-07-31 06:14:58 Restoring google-nested:ubuntu-24.04-64:tests/nested/classic/hotplug (jul310600-372849)...
2025-07-31 06:15:04 Restoring google-nested:ubuntu-24.04-64:tests/nested/classic/ (jul310600-372849)...
2025-07-31 06:15:05 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372849)...
2025-07-31 06:15:23 WARNING: jul310600-372880 (google-nested:ubuntu-24.04-64:tests/nested/core/) running late. Current output:
-----
(... 5370 lines above ...)
+ UBUNTU_IMAGE_SNAP_CMD=/usr/bin/snap
+ export UBUNTU_IMAGE_SNAP_CMD
+ '[' -n beta ']'
+ UBUNTU_IMAGE_CHANNEL_ARG='--channel beta'
+ declare -a UBUNTU_IMAGE_PRESEED_ARGS
+ '[' -n '' ']'
+ tee /var/tmp/work-dir/logs/ubuntu-image.log
+ SNAPD_DEBUG=1
+ /home/gopath/bin/ubuntu-image snap --image-size 10G --validation=enforce /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/nested-24-amd64.model --channel beta '' --output-dir /var/tmp/work-dir/images --sector-size 512 --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap
[0] prepare_image
-----
.
2025-07-31 06:15:24 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-reboot:factory_reset (jul310600-372875)...
2025-07-31 06:15:33 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-factory-reset:nofde (jul310600-372836)...
2025-07-31 06:15:38 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_panic_auto_connect (jul310600-372880)...
2025-07-31 06:15:39 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_reboot_link_snap (jul310600-372859)...
2025-07-31 06:16:10 WARNING: jul310600-372894 (google-nested:ubuntu-24.04-64:tests/nested/core/) running late. Current output:
-----
(... 5530 lines above ...)
+ ubuntuSeedDev=/dev/loop0p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop0p2
+ '[' -b /dev/loop0p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.SFRphIp83J
+ retry -n 5 --wait 2 mount /dev/loop0p2 /tmp/tmp.SFRphIp83J
+ mkdir -p /tmp/tmp.SFRphIp83J/data/etc/cloud/cloud.cfg.d/
+ cp -f /var/tmp/work-dir/assets/data.cfg /tmp/tmp.SFRphIp83J/data/etc/cloud/cloud.cfg.d/
+ sync
-----
.
2025-07-31 06:16:13 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:bad_linux (jul310600-372894)...
2025-07-31 06:16:22 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/seeding-failure (jul310600-372844) (3/173)...
2025-07-31 06:17:04 WARNING: jul310600-372884 (google-nested:ubuntu-24.04-64:tests/nested/core/) running late. Current output:
-----
(... 5379 lines above ...)
[0] prepare_image
WARNING: "snapd", "pc-kernel", "core24", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
[1] load_gadget_yaml
[2] set_artifact_names
[3] populate_rootfs_contents
[4] generate_disk_info
[5] calculate_rootfs_size
[6] populate_bootfs_contents
[7] populate_prepare_partitions
WARNING: No mkfs configuration found for this series: 16.04. Will fallback on the default one.
-----
.
2025-07-31 06:17:14 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:bad_text (jul310600-372884)...
2025-07-31 06:17:28 WARNING: jul310600-372854 (google-nested:ubuntu-24.04-64:tests/nested/core/) running late. Current output:
-----
(... 5300 lines above ...)
created 0 fifos
created 0 sockets
created 3 hardlinks
+ mkdir -p /tmp/core-unpack.W4gjAaVZ/etc/systemd/journald.conf.d
+ cat
+ mkdir -p /tmp/core-unpack.W4gjAaVZ/etc/systemd/system/snapd.service.d
+ cat
+ '[' false = true ']'
+ cp /home/gopath/src/github.com/snapcore/snapd/data/completion/bash/complete.sh /tmp/core-unpack.W4gjAaVZ/usr/lib/snapd/complete.sh
+ snap pack --filename=new-core24.snap /tmp/core-unpack.W4gjAaVZ
-----
.
2025-07-31 06:17:51 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-fde-hooks-ice (jul310600-372870) (4/173)...
2025-07-31 06:17:53 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-fde-hooks-ice (jul310600-372870)...
2025-07-31 06:17:58 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fde-dbx (jul310600-372870)...
2025-07-31 06:18:06 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_panic_link_snap (jul310600-372854)...
2025-07-31 06:18:11 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-factory-reset:nofde (jul310600-372836) (5/173)...
2025-07-31 06:18:14 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_reboot_link_snap (jul310600-372859) (6/173)...
2025-07-31 06:18:18 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_panic_auto_connect (jul310600-372880) (7/173)...
2025-07-31 06:18:31 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_panic_auto_connect (jul310600-372880)...
2025-07-31 06:18:37 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_reboot_refresh_gadget_assets (jul310600-372880)...
2025-07-31 06:20:05 WARNING: jul310600-372849 (google-nested:ubuntu-24.04-64:tests/nested/core/) running late. Current output:
-----
(... 5370 lines above ...)
+ export UBUNTU_IMAGE_SNAP_CMD
+ '[' -n beta ']'
+ UBUNTU_IMAGE_CHANNEL_ARG='--channel beta'
+ declare -a UBUNTU_IMAGE_PRESEED_ARGS
+ '[' -n '' ']'
+ SNAPD_DEBUG=1
+ /home/gopath/bin/ubuntu-image snap --image-size 10G --validation=enforce /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/nested-24-amd64.model --channel beta '' --output-dir /var/tmp/work-dir/images --sector-size 512 --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap
+ tee /var/tmp/work-dir/logs/ubuntu-image.log
[0] prepare_image
WARNING: "snapd", "pc-kernel", "core24", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
-----
.
2025-07-31 06:20:14 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:no_test_or_default (jul310600-372800) (8/173)...
2025-07-31 06:20:16 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-install:snapd_reboot_auto_connect (jul310600-372849)...
2025-07-31 06:20:38 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:bad_linux (jul310600-372894) (9/173)...
2025-07-31 06:20:48 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_reboot_link_snap (jul310600-372859)...
2025-07-31 06:20:55 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/base-revert-after-boot (jul310600-372859)...
2025-07-31 06:21:03 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_panic_link_snap (jul310600-372854) (10/173)...
2025-07-31 06:21:03 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_reboot_refresh_gadget_assets (jul310600-372880) (11/173)...
2025-07-31 06:21:05 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:no_test_or_default (jul310600-372800)...
2025-07-31 06:21:18 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/refresh-revert-fundamentals:base (jul310600-372800)...
2025-07-31 06:21:20 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/refresh-revert-fundamentals:base (jul310600-372800) (12/173)...
2025-07-31 06:21:20 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/refresh-revert-fundamentals:base (jul310600-372800)...
2025-07-31 06:21:22 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:UBUNTUDIR_NOSEC (jul310600-372800)...
2025-07-31 06:21:26 WARNING: jul310600-372889 (google-nested:ubuntu-24.04-64:tests/nested/manual/) running late. Current output:
-----
(... 4742 lines above ...)
-o -name TAGS -o \( -path '*/.deps/*' -a -name '*.P' \) \
\) -exec rm -f {} + \) -o \
\( -type d -a \( -name autom4te.cache -o -name __pycache__ \) -prune -exec rm -rf {} + \) \)
rm -f snap-bootstrap
make[1]: Leaving directory '/home/gopath/src/github.com/snapcore/snapd/core-initrd/24.04'
dpkg-source --after-build .
dpkg-buildpackage: info: full upload; Debian-native package (full source is included)
+ popd
/home/gopath/src/github.com/snapcore/snapd/core-initrd /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-nofde-dbx
+ quiet eatmydata apt-get install -y ./ubuntu-core-initramfs_69+1337.2.70+24.04_amd64.deb
-----
.
2025-07-31 06:21:28 WARNING: jul310600-372695 (google-nested:ubuntu-24.04-64:tests/nested/manual/) running late. Current output:
-----
(... 4742 lines above ...)
-o -name TAGS -o \( -path '*/.deps/*' -a -name '*.P' \) \
\) -exec rm -f {} + \) -o \
\( -type d -a \( -name autom4te.cache -o -name __pycache__ \) -prune -exec rm -rf {} + \) \)
rm -f snap-bootstrap
make[1]: Leaving directory '/home/gopath/src/github.com/snapcore/snapd/core-initrd/24.04'
dpkg-source --after-build .
dpkg-buildpackage: info: full upload; Debian-native package (full source is included)
+ popd
/home/gopath/src/github.com/snapcore/snapd/core-initrd /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/snapd-removes-vulnerable-snap-confine-revs
+ quiet eatmydata apt-get install -y ./ubuntu-core-initramfs_69+1337.2.70+24.04_amd64.deb
-----
.
2025-07-31 06:21:39 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:bad_text (jul310600-372884) (13/173)...
2025-07-31 06:21:47 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/seeding-failure (jul310600-372844)...
2025-07-31 06:21:49 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_reboot_refresh_gadget_assets (jul310600-372880)...
2025-07-31 06:21:54 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-gadget-reseal (jul310600-372880)...
2025-07-31 06:22:00 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-install-component:kernel_panic_prepare_kernel_components (jul310600-372844)...
2025-07-31 06:22:38 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-factory-reset:nofde (jul310600-372836)...
2025-07-31 06:22:44 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core-fde-state (jul310600-372836)...
2025-07-31 06:23:00 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_panic_link_snap (jul310600-372854)...
2025-07-31 06:23:06 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-reseal (jul310600-372854)...
2025-07-31 06:23:51 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-install:snapd_reboot_auto_connect (jul310600-372849) (14/173)...
2025-07-31 06:23:53 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:bad_linux (jul310600-372894)...
2025-07-31 06:24:02 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/interfaces-custom-devices (jul310600-372894)...
2025-07-31 06:24:18 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fde-dbx (jul310600-372870) (15/173)...
2025-07-31 06:24:19 Executing google-nested:ubuntu-24.04-64:tests/nested/core/base-revert-after-boot (jul310600-372859) (16/173)...
2025-07-31 06:24:24 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-reboot:factory_reset (jul310600-372875) (17/173)...
2025-07-31 06:24:30 WARNING: jul310600-372865 (google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-dbx) running late. Current output:
-----
(... 966 lines above ...)
SNAPD_TRACE=1
SNAPD_JSON_LOGGING=1
SNAP_LOG_TO_JOURNAL=1
status: disabled
+ remote.exec 'sudo mkdir -p /var/lib/snapd/seed'
+ remote.exec 'sudo mount -o bind /var/lib/snapd/install-seed /var/lib/snapd/seed'
+ remote.push /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
+ remote.exec 'sudo snap install --classic --dangerous muinstaller_0.1_amd64.snap'
-----
.
2025-07-31 06:24:52 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-install:snapd_reboot_auto_connect (jul310600-372849)...
2025-07-31 06:24:54 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:bad_text (jul310600-372884)...
2025-07-31 06:25:00 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_panic_refresh_gadget_assets (jul310600-372849)...
2025-07-31 06:25:04 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_panic_auto_connect (jul310600-372884)...
2025-07-31 06:25:16 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-gadget-reseal (jul310600-372880) (18/173)...
2025-07-31 06:26:06 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core-fde-state (jul310600-372836) (19/173)...
2025-07-31 06:26:07 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core-fde-state (jul310600-372836)...
2025-07-31 06:26:14 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_reboot_link_snap (jul310600-372836)...
2025-07-31 06:26:33 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:UBUNTUDIR_NOSEC (jul310600-372800) (20/173)...
2025-07-31 06:27:28 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_panic_refresh_gadget_assets (jul310600-372849) (21/173)...
2025-07-31 06:27:35 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_panic_auto_connect (jul310600-372884) (22/173)...
2025-07-31 06:27:40 Executing google-nested:ubuntu-24.04-64:tests/nested/core/interfaces-custom-devices (jul310600-372894) (23/173)...
2025-07-31 06:27:45 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/interfaces-custom-devices (jul310600-372894)...
2025-07-31 06:27:51 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_panic_auto_connect (jul310600-372894)...
2025-07-31 06:28:05 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-reseal (jul310600-372854) (24/173)...
2025-07-31 06:28:07 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-dbx (jul310600-372865) (25/173)...
2025-07-31 06:28:15 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-gadget-reseal (jul310600-372880)...
2025-07-31 06:28:20 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:UBUNTUDIR_NOSEC (jul310600-372800)...
2025-07-31 06:28:22 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/coreconfig-services (jul310600-372880)...
2025-07-31 06:28:26 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-fde-hooks:files (jul310600-372800)...
2025-07-31 06:28:38 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_reboot_link_snap (jul310600-372836) (26/173)...
2025-07-31 06:29:00 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-install-component:kernel_panic_prepare_kernel_components (jul310600-372844) (27/173)...
2025-07-31 06:29:15 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-install-component:kernel_panic_prepare_kernel_components (jul310600-372844)...
2025-07-31 06:29:19 WARNING: jul310600-372859 (google-nested:ubuntu-24.04-64:tests/nested/core/base-revert-after-boot) running late. Current output:
-----
(... 49 lines above ...)
.
remote.wait-for: reboot completed
++ tests.nested boot-id
+ boot_id=fb2248de-c4c0-420f-8930-4004e47a4f24
+ echo 'Wait for second reboot after post-refresh hook failure'
Wait for second reboot after post-refresh hook failure
+ remote.wait-for reboot fb2248de-c4c0-420f-8930-4004e47a4f24
remote.wait-for: waiting for reboot
..................Connection timed out during banner exchange
.Connection timed out during banner exchange
-----
.
2025-07-31 06:29:23 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-assets-secure:both (jul310600-372844)...
2025-07-31 06:29:26 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_panic_auto_connect (jul310600-372884)...
2025-07-31 06:29:28 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-dbx (jul310600-372865)...
2025-07-31 06:29:29 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:empty (jul310600-372884)...
2025-07-31 06:29:35 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_panic_refresh_gadget_assets (jul310600-372849)...
2025-07-31 06:29:38 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_panic_refresh_gadget_assets (jul310600-372849)...
2025-07-31 06:29:47 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/base-revert-after-boot (jul310600-372859)...
2025-07-31 06:29:55 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_reboot_refresh_gadget_assets (jul310600-372859)...
2025-07-31 06:30:12 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:gadgetfull (jul310600-372865)...
2025-07-31 06:30:17 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_panic_auto_connect (jul310600-372894) (28/173)...
2025-07-31 06:30:49 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fde-dbx (jul310600-372870)...
2025-07-31 06:31:01 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetsaysmaas (jul310600-372870)...
2025-07-31 06:31:06 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-reseal (jul310600-372854)...
2025-07-31 06:31:14 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core-gadget-mounted (jul310600-372854)...
2025-07-31 06:31:16 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-reboot:factory_reset (jul310600-372875)...
2025-07-31 06:31:25 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system-offline (jul310600-372875)...
2025-07-31 06:31:26 WARNING: jul310600-372889 (google-nested:ubuntu-24.04-64:tests/nested/manual/) running late. Output unchanged.
2025-07-31 06:31:27 Executing google-nested:ubuntu-24.04-64:tests/nested/core/coreconfig-services (jul310600-372880) (29/173)...
2025-07-31 06:31:28 WARNING: jul310600-372695 (google-nested:ubuntu-24.04-64:tests/nested/manual/) running late. Output unchanged.
2025-07-31 06:32:07 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_panic_refresh_gadget_assets (jul310600-372849) (30/173)...
2025-07-31 06:32:17 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_panic_auto_connect (jul310600-372894)...
2025-07-31 06:32:21 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject (jul310600-372894)...
2025-07-31 06:32:21 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_panic_refresh_gadget_assets (jul310600-372849)...
2025-07-31 06:32:23 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/coreconfig-services (jul310600-372880)...
2025-07-31 06:32:23 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_reboot_refresh_gadget_assets (jul310600-372859) (31/173)...
2025-07-31 06:32:24 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_reboot_auto_connect (jul310600-372849)...
2025-07-31 06:32:29 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/save-data (jul310600-372880)...
2025-07-31 06:33:21 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:empty (jul310600-372884) (32/173)...
2025-07-31 06:33:35 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-fde-hooks:files (jul310600-372800) (33/173)...
2025-07-31 06:33:37 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-fde-hooks:files (jul310600-372800)...
2025-07-31 06:33:39 WARNING: jul310600-372836 (google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_reboot_link_snap) running late. Current output:
-----
(... 24 lines above ...)
.............Connection timed out during banner exchange
.Connection timed out during banner exchange
.
remote.wait-for: reboot completed
++ tests.nested boot-id
+ boot_id=a6f0ace4-53d9-45a6-8a8b-d29335c7c1f1
+ '[' true = true ']'
+ remote.wait-for reboot a6f0ace4-53d9-45a6-8a8b-d29335c7c1f1
remote.wait-for: waiting for reboot
...............................
-----
.
2025-07-31 06:33:40 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/snapd-removes-vulnerable-snap-confine-revs:snapd (jul310600-372800)...
2025-07-31 06:33:52 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:empty (jul310600-372884)...
2025-07-31 06:33:59 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/remount-hotplug (jul310600-372884)...
2025-07-31 06:34:47 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_reboot_auto_connect (jul310600-372849) (34/173)...
2025-07-31 06:34:53 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core-gadget-mounted (jul310600-372854) (35/173)...
2025-07-31 06:34:57 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_reboot_refresh_gadget_assets (jul310600-372859)...
2025-07-31 06:35:01 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:nolink (jul310600-372859)...
2025-07-31 06:35:23 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/snapd-removes-vulnerable-snap-confine-revs:snapd (jul310600-372800) (36/173)...
2025-07-31 06:35:32 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-assets-secure:both (jul310600-372844) (37/173)...
2025-07-31 06:35:33 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject (jul310600-372894) (38/173)...
2025-07-31 06:35:34 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_reboot_auto_connect (jul310600-372849)...
2025-07-31 06:35:38 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:zeros (jul310600-372849)...
2025-07-31 06:35:39 Executing google-nested:ubuntu-24.04-64:tests/nested/core/save-data (jul310600-372880) (39/173)...
2025-07-31 06:35:40 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/snapd-removes-vulnerable-snap-confine-revs:snapd (jul310600-372800)...
2025-07-31 06:35:47 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core-shim-update-revokes-old-keys (jul310600-372800)...
2025-07-31 06:35:54 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core-gadget-mounted (jul310600-372854)...
2025-07-31 06:35:59 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/save-data (jul310600-372880)...
2025-07-31 06:36:02 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-install:snapd_panic_auto_connect (jul310600-372854)...
2025-07-31 06:36:06 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-set-efi-boot-variables (jul310600-372880)...
2025-07-31 06:36:50 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject (jul310600-372894)...
2025-07-31 06:36:57 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_panic_link_snap (jul310600-372894)...
2025-07-31 06:37:05 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:gadgetfull (jul310600-372865) (40/173)...
2025-07-31 06:37:13 Executing google-nested:ubuntu-24.04-64:tests/nested/core/remount-hotplug (jul310600-372884) (41/173)...
2025-07-31 06:37:25 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/remount-hotplug (jul310600-372884)...
2025-07-31 06:37:31 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-degraded (jul310600-372884)...
2025-07-31 06:38:19 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:nolink (jul310600-372859) (42/173)...
2025-07-31 06:38:20 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system-offline (jul310600-372875) (43/173)...
2025-07-31 06:38:29 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-assets-secure:both (jul310600-372844)...
2025-07-31 06:38:39 WARNING: jul310600-372836 (google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_reboot_link_snap) running late. Current output:
-----
(...)
........................................................................................
-----
.
2025-07-31 06:38:39 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-command-line-secure (jul310600-372844)...
2025-07-31 06:39:09 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:gadgetfull (jul310600-372865)...
2025-07-31 06:39:17 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-install-device-file-install-via-hook-hack (jul310600-372865)...
2025-07-31 06:39:19 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-set-efi-boot-variables (jul310600-372880) (44/173)...
2025-07-31 06:39:20 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:zeros (jul310600-372849) (45/173)...
2025-07-31 06:39:22 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_panic_link_snap (jul310600-372894) (46/173)...
2025-07-31 06:39:24 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-set-efi-boot-variables (jul310600-372880)...
2025-07-31 06:39:31 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:crash (jul310600-372880)...
2025-07-31 06:39:36 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetsaysmaas (jul310600-372870) (47/173)...
2025-07-31 06:39:44 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-install:snapd_panic_auto_connect (jul310600-372854) (48/173)...
2025-07-31 06:39:50 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:zeros (jul310600-372849)...
2025-07-31 06:39:56 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:snapd_panic_link_snap (jul310600-372849)...
2025-07-31 06:39:59 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-install:snapd_panic_auto_connect (jul310600-372854)...
2025-07-31 06:40:08 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/connected-after-reboot-revert (jul310600-372854)...
2025-07-31 06:40:42 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-degraded (jul310600-372884) (49/173)...
2025-07-31 06:41:26 WARNING: jul310600-372889 (google-nested:ubuntu-24.04-64:tests/nested/manual/) running late. Output unchanged.
2025-07-31 06:41:28 WARNING: jul310600-372695 (google-nested:ubuntu-24.04-64:tests/nested/manual/) running late. Output unchanged.
2025-07-31 06:41:29 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:nolink (jul310600-372859)...
2025-07-31 06:41:30 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_panic_link_snap (jul310600-372894)...
2025-07-31 06:41:34 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_reboot_link_snap (jul310600-372894)...
2025-07-31 06:41:36 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core-shim-update-revokes-old-keys (jul310600-372800) (50/173)...
2025-07-31 06:41:36 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-reinstall-partitions (jul310600-372859)...
2025-07-31 06:41:39 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_reboot_link_snap (jul310600-372836)...
2025-07-31 06:41:43 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/bad-try-kernel-no-reboot (jul310600-372836)...
2025-07-31 06:42:20 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:snapd_panic_link_snap (jul310600-372849) (51/173)...
2025-07-31 06:42:37 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:snapd_panic_link_snap (jul310600-372849)...
2025-07-31 06:42:38 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetsaysmaas (jul310600-372870)...
2025-07-31 06:42:41 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_reboot_auto_connect (jul310600-372849)...
2025-07-31 06:42:47 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core22-basic:tokens (jul310600-372870)...
2025-07-31 06:43:16 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/snapd-removes-vulnerable-snap-confine-revs:core (jul310600-372695)...
2025-07-31 06:43:50 Executing google-nested:ubuntu-24.04-64:tests/nested/core/connected-after-reboot-revert (jul310600-372854) (52/173)...
2025-07-31 06:43:57 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-degraded (jul310600-372884)...
2025-07-31 06:43:58 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-reinstall-partitions (jul310600-372859) (53/173)...
2025-07-31 06:43:58 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_reboot_link_snap (jul310600-372894) (54/173)...
2025-07-31 06:44:01 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:crash (jul310600-372880) (55/173)...
2025-07-31 06:44:04 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/kernel-revert-after-boot (jul310600-372884)...
2025-07-31 06:44:23 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-command-line-secure (jul310600-372844) (56/173)...
2025-07-31 06:44:40 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system-offline (jul310600-372875)...
2025-07-31 06:44:45 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_reboot_link_snap (jul310600-372894)...
2025-07-31 06:44:48 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:snapd_reboot_link_snap (jul310600-372894)...
2025-07-31 06:44:51 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:kernel_panic_remodel_boot_assets (jul310600-372875)...
2025-07-31 06:44:55 Executing google-nested:ubuntu-24.04-64:tests/nested/core/bad-try-kernel-no-reboot (jul310600-372836) (57/173)...
2025-07-31 06:44:59 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_reboot_auto_connect (jul310600-372849) (58/173)...
2025-07-31 06:45:45 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/bad-try-kernel-no-reboot (jul310600-372836)...
2025-07-31 06:45:50 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-install-device-file-install-via-hook-hack (jul310600-372865) (59/173)...
2025-07-31 06:45:52 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-basic (jul310600-372836)...
2025-07-31 06:45:56 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-install-device-file-install-via-hook-hack (jul310600-372865)...
2025-07-31 06:46:05 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core-recover-from-recovery:break_dbx (jul310600-372865)...
2025-07-31 06:46:06 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core-shim-update-revokes-old-keys (jul310600-372800)...
2025-07-31 06:46:09 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-reinstall-partitions (jul310600-372859)...
2025-07-31 06:46:12 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_reboot_auto_connect (jul310600-372859)...
2025-07-31 06:46:14 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-assets-secure:seed (jul310600-372800)...
2025-07-31 06:46:14 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-nofde-dbx (jul310600-372889)...
2025-07-31 06:46:31 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-command-line-secure (jul310600-372844)...
2025-07-31 06:46:39 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:partial (jul310600-372844)...
2025-07-31 06:46:41 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:partial (jul310600-372844) (60/173)...
2025-07-31 06:47:13 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:snapd_reboot_link_snap (jul310600-372894) (61/173)...
2025-07-31 06:47:13 Executing google-nested:ubuntu-24.04-64:tests/nested/core/kernel-revert-after-boot (jul310600-372884) (62/173)...
2025-07-31 06:47:18 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:crash (jul310600-372880)...
2025-07-31 06:47:25 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-factory-reset:fde (jul310600-372880)...
2025-07-31 06:47:27 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/snapd-removes-vulnerable-snap-confine-revs:core (jul310600-372695) (63/173)...
2025-07-31 06:47:38 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:kernel_reboot_auto_connect (jul310600-372849)...
2025-07-31 06:47:42 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_panic_link_snap (jul310600-372849)...
2025-07-31 06:47:49 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/snapd-removes-vulnerable-snap-confine-revs:core (jul310600-372695)...
2025-07-31 06:47:58 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:pre_installed_snaps (jul310600-372695)...
2025-07-31 06:48:04 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:snapd_reboot_link_snap (jul310600-372894)...
2025-07-31 06:48:08 Preparing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:bad_initrd (jul310600-372894)...
2025-07-31 06:48:23 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core22-basic:tokens (jul310600-372870) (64/173)...
2025-07-31 06:48:39 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_reboot_auto_connect (jul310600-372859) (65/173)...
2025-07-31 06:48:46 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core22-basic:tokens (jul310600-372870)...
2025-07-31 06:48:50 WARNING: jul310600-372854 (google-nested:ubuntu-24.04-64:tests/nested/core/connected-after-reboot-revert) running late. Current output:
-----
(... 54 lines above ...)
.
remote.wait-for: reboot completed
+ '[' 24 -eq 16 ']'
++ tests.nested boot-id
+ boot_id=996e6609-66a6-41d1-b069-75f76889490b
+ echo 'Wait for reboot after post-refresh hook failure'
Wait for reboot after post-refresh hook failure
+ remote.wait-for reboot 996e6609-66a6-41d1-b069-75f76889490b
remote.wait-for: waiting for reboot
...........
-----
.
2025-07-31 06:48:53 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-4k-sector-size:physical_only (jul310600-372870)...
2025-07-31 06:49:00 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-basic (jul310600-372836) (66/173)...
2025-07-31 06:49:30 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-basic (jul310600-372836)...
2025-07-31 06:49:37 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372836)...
2025-07-31 06:49:38 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372836)...
2025-07-31 06:50:09 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_panic_link_snap (jul310600-372849) (67/173)...
2025-07-31 06:50:21 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:gadget_panic_link_snap (jul310600-372849)...
2025-07-31 06:50:24 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372849)...
2025-07-31 06:50:25 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372849)...
2025-07-31 06:50:34 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-factory-reset:fde (jul310600-372880) (68/173)...
2025-07-31 06:50:37 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:kernel_panic_remodel_boot_assets (jul310600-372875) (69/173)...
2025-07-31 06:50:49 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:BOOTDIR_NOSEC (jul310600-372836)...
2025-07-31 06:50:59 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/connected-after-reboot-revert (jul310600-372854)...
2025-07-31 06:51:02 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-fault-inject-on-refresh:base_reboot_auto_connect (jul310600-372859)...
2025-07-31 06:51:07 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372859)...
2025-07-31 06:51:07 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372859)...
2025-07-31 06:51:09 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372854)...
2025-07-31 06:51:09 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372854)...
2025-07-31 06:51:26 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-nofde-dbx (jul310600-372889) (70/173)...
2025-07-31 06:51:27 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-nofde-dbx (jul310600-372889)...
2025-07-31 06:51:33 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-with-components (jul310600-372889)...
2025-07-31 06:51:34 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-early-config (jul310600-372849)...
2025-07-31 06:52:00 Executing google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:bad_initrd (jul310600-372894) (71/173)...
2025-07-31 06:52:01 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-assets-secure:seed (jul310600-372800) (72/173)...
2025-07-31 06:52:11 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core-recover-from-recovery:break_dbx (jul310600-372865) (73/173)...
2025-07-31 06:52:13 WARNING: jul310600-372884 (google-nested:ubuntu-24.04-64:tests/nested/core/kernel-revert-after-boot) running late. Current output:
-----
(... 41 lines above ...)
.Connection timed out during banner exchange
.
remote.wait-for: reboot completed
++ tests.nested boot-id
+ boot_id=8fd2c789-cfad-4b0e-b7bc-0d710c144152
+ echo 'Wait for second reboot after post-refresh hook failure'
Wait for second reboot after post-refresh hook failure
+ remote.wait-for reboot 8fd2c789-cfad-4b0e-b7bc-0d710c144152
remote.wait-for: waiting for reboot
...................
-----
.
2025-07-31 06:52:20 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:hook (jul310600-372859)...
2025-07-31 06:52:31 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-oldbasenewkernel (jul310600-372854)...
2025-07-31 06:52:34 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-oldbasenewkernel (jul310600-372854) (74/173)...
2025-07-31 06:53:05 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/kernel-revert-after-boot (jul310600-372884)...
2025-07-31 06:53:13 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372884)...
2025-07-31 06:53:14 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372884)...
2025-07-31 06:54:24 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:pre_installed_snaps (jul310600-372695) (75/173)...
2025-07-31 06:54:28 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2504 (jul310600-372884)...
2025-07-31 06:54:34 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-4k-sector-size:physical_only (jul310600-372870) (76/173)...
2025-07-31 06:54:50 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-assets-secure:seed (jul310600-372800)...
2025-07-31 06:54:55 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-4k-sector-size:physical_only (jul310600-372870)...
2025-07-31 06:55:00 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2504 (jul310600-372800)...
2025-07-31 06:55:02 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-custom-kernel-commandline (jul310600-372870)...
2025-07-31 06:55:14 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-kernel-failover:bad_initrd (jul310600-372894)...
2025-07-31 06:55:24 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372894)...
2025-07-31 06:55:24 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372894)...
2025-07-31 06:55:33 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:kernel_panic_remodel_boot_assets (jul310600-372875)...
2025-07-31 06:55:34 WARNING: jul310600-372880 (google-nested:ubuntu-24.04-64:tests/nested/core/core20-factory-reset:fde) running late. Current output:
-----
(... 105 lines above ...)
+ remote.wait-for reboot f9328ada-cfad-4f02-8a3d-310cce60ba98
remote.wait-for: waiting for reboot
..Connection timed out during banner exchange
.Permission denied, please try again.
.Permission denied, please try again.
.Permission denied, please try again.
.Permission denied, please try again.
.Connection timed out during banner exchange
.Connection timed out during banner exchange
.Connection timed out during banner exchange
-----
.
2025-07-31 06:55:41 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-fde-hooks-v1 (jul310600-372875)...
2025-07-31 06:56:08 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/core20-factory-reset:fde (jul310600-372880)...
2025-07-31 06:56:08 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:BOOTDIR_NOSEC (jul310600-372836) (77/173)...
2025-07-31 06:56:14 Restoring google-nested:ubuntu-24.04-64:tests/nested/core/ (jul310600-372880)...
2025-07-31 06:56:15 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372880)...
2025-07-31 06:56:28 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core-recover-from-recovery:break_dbx (jul310600-372865)...
2025-07-31 06:56:28 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:pre_installed_snaps (jul310600-372695)...
2025-07-31 06:56:35 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core-factory-reset-new-secboot:tpm (jul310600-372695)...
2025-07-31 06:56:36 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:none (jul310600-372894)...
2025-07-31 06:56:40 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/refresh-revert-fundamentals:gadget (jul310600-372865)...
2025-07-31 06:56:41 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/refresh-revert-fundamentals:gadget (jul310600-372865) (78/173)...
2025-07-31 06:56:41 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/refresh-revert-fundamentals:gadget (jul310600-372865)...
2025-07-31 06:56:41 WARNING: jul310600-372844 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:partial) running late. Current output:
-----
(... 2148 lines above ...)
+++ '[' 1 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-muinstaller-real_partial
++ BASE_NAME=ubuntu-core-24-custom-muinstaller-real_partial
++ echo ubuntu-core-24-custom-muinstaller-real_partial.img
+ image_name=ubuntu-core-24-custom-muinstaller-real_partial.img
+ touch /var/tmp/work-dir/images/ubuntu-core-24-custom-muinstaller-real_partial.img.configured
+ tests.nested create-vm core --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
'/var/tmp/work-dir/images/ubuntu-core-24-custom-muinstaller-real_partial.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
'/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.enrolled.fd' -> '/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.current.fd'
-----
.
2025-07-31 06:56:43 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-install-mode-shutdown-via-hook (jul310600-372865)...
2025-07-31 06:57:27 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-cloud-init-testkeys (jul310600-372880)...
2025-07-31 06:57:33 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-early-config (jul310600-372849) (79/173)...
2025-07-31 06:57:48 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:hook (jul310600-372859) (80/173)...
2025-07-31 06:57:57 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:BOOTDIR_NOSEC (jul310600-372836)...
2025-07-31 06:58:03 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-remodel (jul310600-372836)...
2025-07-31 06:58:37 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-with-components (jul310600-372889) (81/173)...
2025-07-31 06:58:52 Error executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-early-config (jul310600-372849) :
-----
+ check_core20_early_config
+ echo 'Precondition check of the gadget defaults'
Precondition check of the gadget defaults
+ remote.exec 'sudo snap get system service.rsyslog.disable'
+ MATCH true
+ remote.exec 'sudo snap get system watchdog.runtime-timeout'
+ MATCH 10m
+ remote.exec 'sudo snap get system system.power-key-action'
+ MATCH ignore
+ remote.exec 'sudo snap get system system.ctrl-alt-del-action'
+ MATCH none
+ MATCH true
+ remote.exec 'sudo snap get system system.disable-backlight-service'
+ remote.exec 'test -L /etc/systemd/system/rsyslog.service'
+ remote.exec 'cat /etc/systemd/logind.conf.d/00-snap-core.conf'
+ MATCH HandlePowerKey=ignore
+ remote.exec 'cat /etc/systemd/system.conf.d/10-snapd-watchdog.conf'
+ MATCH RuntimeWatchdogSec=600
+ remote.exec 'sudo journalctl'
+ NOMATCH 'Failed to set timeout to'
+ remote.exec 'test -L /etc/systemd/system/systemd-backlight@.service'
+ echo 'Test that defaults were applied early.'
Test that defaults were applied early.
+ remote.exec 'cat /var/snap/pc/common/debug.txt'
+ MATCH 'rsyslog symlink: /dev/null'
+ MATCH 'backlight symlink: /dev/null'
+ remote.exec 'cat /var/snap/pc/common/debug.txt'
+ remote.exec 'timedatectl show -p Timezone --value'
+ MATCH Europe/Malta
+ remote.exec 'readlink -f /etc/localtime'
+ MATCH Europe/Malta
+ remote.exec 'cat /var/snap/pc/common/debug.txt'
+ MATCH 'localtime symlink: /usr/share/zoneinfo/Europe/Malta'
+ remote.exec 'cat /var/lib/console-conf/complete'
+ MATCH 'console-conf has been disabled by the snapd system configuration'
+ MATCH 'hostname: foo'
+ remote.exec 'cat /var/snap/pc/common/debug.txt'
+ remote.exec 'cat /etc/hostname'
+ MATCH foo
+ remote.exec hostname
+ MATCH foo
+ not remote.exec 'sudo snap get system system.network.netplan.network.ethernets.all-en'
error: snap "core" has no "system.network.netplan.network.ethernets.all-en"
configuration option
+ not remote.exec 'sudo snap get system system.network.netplan.network.ethernets.all-eth'
error: snap "core" has no "system.network.netplan.network.ethernets.all-eth"
configuration option
+ MATCH br54
+ remote.exec 'sudo cat /etc/netplan/00-snapd-config.yaml'
+ remote.exec 'sudo netplan get bridges.br54.dhcp4'
+ MATCH true
+ MATCH true
+ remote.exec 'sudo snap get system system.network.netplan.network.bridges.br54.dhcp4'
+ remote.exec 'sudo netplan get ethernets.any.dhcp6'
+ MATCH true
+ remote.exec 'sudo snap set system system.network.netplan.network.bridges.br54.dhcp4=false'
+ remote.exec 'sudo netplan get bridges.br54.dhcp4'
+ MATCH false
+ remote.exec 'sudo snap get system system.network.netplan.network.bridges.br54.dhcp4'
+ MATCH false
+ remote.exec 'sudo rm -f /etc/netplan/90-snapd-config.yaml'
+ echo 'Check the ssh port file is correct'
Check the ssh port file is correct
+ remote.exec 'sudo cat /etc/ssh/sshd_config.d/listen.conf'
+ MATCH 'ListenAddress 0\.0\.0\.0:8023'
+ MATCH 'ListenAddress \[::\]:8023'
+ remote.exec 'sudo cat /etc/ssh/sshd_config.d/listen.conf'
+ remote.exec 'sudo cat /etc/ssh/sshd_config.d/listen.conf'
+ MATCH 'ListenAddress 192\.168\.99\.4:9922'
+ echo 'Transition to recover mode and check it again'
Transition to recover mode and check it again
++ remote.exec 'sudo snap recovery | grep -v Notes | grep -Po '\''^[0-9]+'\'''
+ recoverySystem=20250731
+ tests.nested transition 20250731 recover
Reboot into "20250731" "recover" mode.
Connection timed out during banner exchange
Connection timed out during banner exchange
Connection timed out during banner exchange
Warning: Permanently added '[localhost]:8023' (ED25519) to the list of known hosts.
Warning: Permanently added '[localhost]:8023' (ED25519) to the list of known hosts.
Warning: Permanently added '[localhost]:8023' (ED25519) to the list of known hosts.
Warning: Permanently added '[localhost]:8023' (ED25519) to the list of known hosts.
kex_exchange_identification: read: Connection reset by peer
-----
.
2025-07-31 06:58:55 Debug output for google-nested:ubuntu-24.04-64:tests/nested/manual/core20-early-config (jul310600-372849) : saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_core20-early-config.debug.log
2025-07-31 06:58:55 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-early-config (jul310600-372849)...
2025-07-31 06:59:06 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2id (jul310600-372849)...
2025-07-31 06:59:11 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-install-mode-shutdown-via-hook (jul310600-372865) (82/173)...
2025-07-31 06:59:56 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:hook (jul310600-372859)...
2025-07-31 07:00:03 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-with-components-offline (jul310600-372859)...
2025-07-31 07:00:39 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-fde-hooks-v1 (jul310600-372875) (83/173)...
2025-07-31 07:00:41 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-fde-hooks-v1 (jul310600-372875)...
2025-07-31 07:00:45 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/broken-model:hook (jul310600-372875)...
2025-07-31 07:00:45 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-custom-kernel-commandline (jul310600-372870) (84/173)...
2025-07-31 07:01:57 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:none (jul310600-372894) (85/173)...
2025-07-31 07:02:05 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:none (jul310600-372894)...
2025-07-31 07:02:11 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/update-snapd-seed-and-factory-reset:tpm (jul310600-372894)...
2025-07-31 07:02:25 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-install-mode-shutdown-via-hook (jul310600-372865)...
2025-07-31 07:02:33 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:plain (jul310600-372865)...
2025-07-31 07:02:34 WARNING: jul310600-372854 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-oldbasenewkernel) running late. Current output:
-----
(... 838 lines above ...)
'/var/tmp/work-dir/images/ubuntu-core-24-custom-muinstaller-oldbasenewkernel.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
'/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.enrolled.fd' -> '/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.current.fd'
error: no matching snaps installed
test-snapd-swtpm (edge) 0.1.0 from Test snaps (test-snaps-canonical) installed
retry: command test -S /var/snap/test-snapd-swtpm/current/swtpm-sock failed with code 1
retry: next attempt in 1.0 second(s) (attempt 1 of 10)
tests.systemd: unit service file already exist, it is going to be overwritten
Waiting the vm is ready to be used
active
active
-----
.
2025-07-31 07:02:34 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:plain (jul310600-372865) (86/173)...
2025-07-31 07:03:56 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core-factory-reset-new-secboot:tpm (jul310600-372695) (87/173)...
2025-07-31 07:04:02 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-cloud-init-testkeys (jul310600-372880) (88/173)...
2025-07-31 07:04:29 WARNING: jul310600-372884 (google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2504) running late. Current output:
-----
(... 873 lines above ...)
SNAPD_JSON_LOGGING=1
SNAP_LOG_TO_JOURNAL=1
status: disabled
+ remote.exec 'sudo mkdir -p /var/lib/snapd/seed'
+ remote.exec 'sudo mount -o bind /var/lib/snapd/install-seed /var/lib/snapd/seed'
+ remote.push /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
+ remote.exec 'sudo snap install --classic --dangerous muinstaller_0.1_amd64.snap'
2025-07-31T07:04:26Z INFO Waiting for automatic snapd restart...
-----
.
2025-07-31 07:05:00 WARNING: jul310600-372800 (google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2504) running late. Current output:
-----
(... 943 lines above ...)
DEBUG:  argv[4] = -device
DEBUG:  argv[5] = /dev/vda
DEBUG:  argv[6] = -rootfs-creator
DEBUG:  argv[7] = /home/user1/mk-classic-rootfs-wrapper.sh
DEBUG:  argv[8] = -recovery-key-out
DEBUG:  argv[9] = /tmp/rkey.out
DEBUG: umask restored to  022
DEBUG: working directory restored to /home/user1
DEBUG: -- snap startup {"stage":"snap-confine to snap-exec", "time":"1753945499.869473"}
2025/07/31 07:05:00.295026 logger.go:289: DEBUG: -- snap startup {"stage":"snap-exec to app", "time":"1753945500.295023"}
-----
.
2025-07-31 07:05:14 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-cloud-init-testkeys (jul310600-372880)...
2025-07-31 07:05:24 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-storage-safety:preferunencrypted (jul310600-372880)...
2025-07-31 07:05:57 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/broken-model:hook (jul310600-372875) (89/173)...
2025-07-31 07:06:41 WARNING: jul310600-372844 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:partial) running late. Current output:
-----
(... 593 lines above ...)
++ gojq .version -r --yaml-input pc-kernel/meta/snap.yaml
+ original_pc_kernel_version=6.8.0-72.72
+ sed -i 's#\(version: .*\)+.*#\1#' pc-kernel/meta/snap.yaml
+ refresh_rebooting_snap pc-kernel pc-kernel-from-store.snap ./pc-kernel
+ local snap_name=pc-kernel
+ local snap_orig_blob=pc-kernel-from-store.snap
+ local snap_new_dir=./pc-kernel
+ printf 'Test installing snap from file %s\n' pc-kernel
Test installing snap from file pc-kernel
+ fakestore make-refreshable --dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir --snap-orig-blob pc-kernel-from-store.snap --snap-blob ./pc-kernel pc-kernel
-----
.
2025-07-31 07:06:48 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/broken-model:hook (jul310600-372875)...
2025-07-31 07:06:52 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-preseed (jul310600-372875)...
2025-07-31 07:06:54 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-preseed (jul310600-372875) (90/173)...
2025-07-31 07:07:16 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-with-components-offline (jul310600-372859) (91/173)...
2025-07-31 07:07:24 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-with-components (jul310600-372889)...
2025-07-31 07:07:37 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:UBUNTUDIR (jul310600-372889)...
2025-07-31 07:08:04 WARNING: jul310600-372836 (google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-remodel) running late. Current output:
-----
(... 1395 lines above ...)
++++ read -r mysnap
++++ echo /tmp/extra-snaps/core24.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 6 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-hybrid-remodel
++ BASE_NAME=ubuntu-core-24-custom-hybrid-remodel
++ echo ubuntu-core-24-custom-hybrid-remodel.img
+ qemu-img convert -f qcow2 -O raw /var/tmp/work-dir/images/ubuntu-classic-24-custom-hybrid-remodel.img /var/tmp/work-dir/images/ubuntu-core-24-custom-hybrid-remodel.img
-----
.
2025-07-31 07:08:10 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-oldbasenewkernel (jul310600-372854)...
2025-07-31 07:08:14 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2504 (jul310600-372800) (92/173)...
2025-07-31 07:08:14 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2504 (jul310600-372800)...
2025-07-31 07:08:20 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2504 (jul310600-372884) (93/173)...
2025-07-31 07:08:21 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2504 (jul310600-372884)...
2025-07-31 07:08:48 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-custom-kernel-commandline (jul310600-372870)...
2025-07-31 07:08:52 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-simple:offline (jul310600-372854)...
2025-07-31 07:08:53 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-to-installed-kernel (jul310600-372800)...
2025-07-31 07:08:56 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-gadget-cloud-conf:signed (jul310600-372870)...
2025-07-31 07:09:03 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2id (jul310600-372849) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2id '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ '[' true = false ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : true
++ : ''
++ : false
++ : 512
++ : 512
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state setup-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
Name                     Version  Publisher             Notes  Summary
test-snapd-tools         1.0      test-snaps-canonical  -      Tools for testing the snapd application
test-snapd-tools-core24  1.0      cachio                -      test snap with basic tools used to test snapd
test-snapd-tools-core22  1.0      cachio                -
test-snapd-tools-core20  1.0      test-snaps-canonical  -
test-snapd-tools-core18  1.0      test-snaps-canonical  -
Unit fakestore.service could not be found.
Running as unit: fakestore.service; invocation ID: b502bf6b07424fc9ba77dbbd13bb4b0a
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/testrootorg-store.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir/asserts
+ export SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ snap download --basename=pc --channel=classic-25.10/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ snap download --basename=pc-kernel --channel=25.10/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ uc24_build_initramfs_kernel_snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap /var/tmp/work-dir/assets
+ local ORIG_SNAP=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
Parallel unsquashfs: Using 2 processors
9119 inodes (10342 blocks) to write

[======/                                                     ]  2241/19461  11%
[=============-                                              ]  4480/19461  23%
[===================\                                        ]  6478/19461  33%
[====================/                                       ]  6661/19461  34%
[========================\                                   ]  8181/19461  42%
[=================================================|          ] 16421/19461  84%
[===========================================================|] 19461/19461 100%

created 8517 files
created 1539 directories
created 602 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.14.0-22-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.14.0-22-generic --kerneldir pc-kernel/modules/6.14.0-22-generic --firmwaredir pc-kernel/firmware --output initrd.img
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_set_tran_desc
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmp9uavx_lkubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.14.0-22-generic
File: manifest-initramfs.yaml-6.14.0-22-generic
Size: 2975      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 571113      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 06:59:26.619374663 +0000
Modify: 2025-07-31 06:59:26.619374663 +0000
Change: 2025-07-31 06:59:26.619374663 +0000
Birth: 2025-07-31 06:59:26.619374663 +0000
+ initrd_f=initrd.img-6.14.0-22-generic
+ unmkinitramfs initrd.img-6.14.0-22-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.14.0-22-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.14.0-22-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.14.0-22-generic
Signing Unsigned original image
+ cp kernel.efi-6.14.0-22-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.14.0-22.22_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.14.0-22.22_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ mv /var/tmp/work-dir/assets/pc-kernel_6.14.0-22.22_amd64.snap pc-kernel.snap
+ '[' 25.10 = 25.04 ']'
+ model_version_string=2510
+ curl -q https://raw.githubusercontent.com/canonical/models/refs/heads/master/ubuntu-classic-2510-amd64-dangerous.json
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
Dload  Upload   Total   Spent    Left  Speed
0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100  2744  100  2744    0     0  22249      0 --:--:-- --:--:-- --:--:-- 22308
+ gojq 'del(.snaps[] | select(.name | test("^(pc|pc-kernel|core.*|snapd)$") | not))' classic.json
+ mv classic-tmp.json classic.json
+ gojq '."authority-id" = "developer1" | ."brand-id" = "developer1"' classic.json
+ mv classic-tmp.json classic.json
+ gendeveloper1 sign-model
+ cat
+ export HYBRID_SYSTEM_MK_ROOT_FS=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/prepare-rootfs.sh
+ HYBRID_SYSTEM_MK_ROOT_FS=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/prepare-rootfs.sh
+ [[ argon2id == \d\e\f\a\u\l\t ]]
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/setup_nested_hybrid_system.sh --model classic.model --store-dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir --gadget pc.snap --gadget-assertion pc.assert --kernel pc-kernel.snap --kernel-assertion pc-kernel.assert --passphrase 'ubuntu test' --extra-muinstaller-arg '-kdf-type argon2id'
+ main --model classic.model --store-dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir --gadget pc.snap --gadget-assertion pc.assert --kernel pc-kernel.snap --kernel-assertion pc-kernel.assert --passphrase 'ubuntu test' --extra-muinstaller-arg '-kdf-type argon2id'
+ local model_assertion=
+ local store_dir=
+ local gadget_snap=
+ local gadget_assertion=
+ local kernel_snap=
+ local kernel_assertion=
+ local label=classic
+ local disk=
+ local kern_mods_comp=
+ local passphrase=
+ local recovery_key_out=
+ extra_muinstaller_args=()
+ local extra_muinstaller_args
+ '[' 16 -gt 0 ']'
+ case "$1" in
+ model_assertion=classic.model
+ shift 2
+ '[' 14 -gt 0 ']'
+ case "$1" in
+ store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ shift 2
+ '[' 12 -gt 0 ']'
+ case "$1" in
+ gadget_snap=pc.snap
+ shift 2
+ '[' 10 -gt 0 ']'
+ case "$1" in
+ gadget_assertion=pc.assert
+ shift 2
+ '[' 8 -gt 0 ']'
+ case "$1" in
+ kernel_snap=pc-kernel.snap
+ shift 2
+ '[' 6 -gt 0 ']'
+ case "$1" in
+ kernel_assertion=pc-kernel.assert
+ shift 2
+ '[' 4 -gt 0 ']'
+ case "$1" in
+ passphrase='ubuntu test'
+ shift 2
+ '[' 2 -gt 0 ']'
+ case "$1" in
+ extra_muinstaller_args+=("${2}")
+ shift 2
+ '[' 0 -gt 0 ']'
+ '[' -z classic.model ']'
+ '[' -n pc-kernel.snap ']'
+ '[' -z pc-kernel.assert ']'
+ '[' -n pc-kernel.assert ']'
+ '[' -z pc-kernel.snap ']'
+ '[' -n pc.snap ']'
+ '[' -z pc.assert ']'
+ '[' -n pc.assert ']'
+ '[' -z pc.snap ']'
++ realpath classic.model
+ model_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model
+ '[' -n '' ']'
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir ']'
++ realpath /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ '[' -n pc.snap ']'
++ realpath pc.snap
+ gadget_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap
++ realpath pc.assert
+ gadget_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert
+ '[' -n pc-kernel.snap ']'
++ realpath pc-kernel.snap
+ kernel_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
++ realpath pc-kernel.assert
+ kernel_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert
+ '[' -n '' ']'
++ mktemp -d --tmpdir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid
+ cd /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.dAfRheKDuN
+ '[' -z '' ']'
+ disk=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.dAfRheKDuN/disk.img
+ truncate --size=6G /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.dAfRheKDuN/disk.img
+ '[' -z /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap ']'
+ '[' -z /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap ']'
+ run_muinstaller /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert classic /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.dAfRheKDuN/disk.img '' 'ubuntu test' '' '-kdf-type argon2id'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : true
++ : ''
++ : false
++ : 512
++ : 512
+ local model_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model
+ local store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ local gadget_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap
+ local gadget_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert
+ local kernel_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
+ local kernel_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert
+ local label=classic
+ local disk=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.dAfRheKDuN/disk.img
+ local kern_mods_comp=
+ local 'passphrase=ubuntu test'
+ local recovery_key_out=
+ shift 11
+ extra_muinstaller_args=('-kdf-type argon2id')
+ local extra_muinstaller_args
+ snap ack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert
+ snap ack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert
+ local key_name
++ nested_get_snakeoil_key
++ nested_ensure_ovmf
++ '[' -d /var/tmp/work-dir/assets/ovmf ']'
++ '[' -f /var/tmp/work-dir/assets/test-snapd-ovmf.snap ']'
++ snap download --channel=latest/edge test-snapd-ovmf --basename=test-snapd-ovmf --target-directory=/var/tmp/work-dir/assets
++ unsquashfs -d /var/tmp/work-dir/assets/ovmf /var/tmp/work-dir/assets/test-snapd-ovmf.snap
++ os.query is-arm
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.key DB.key
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.crt DB.pem
++ echo DB
+ key_name=DB
+ local snakeoil_key=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.dAfRheKDuN/DB.key
+ local snakeoil_cert=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.dAfRheKDuN/DB.pem
+ unsquashfs -d pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap
Parallel unsquashfs: Using 2 processors
14 inodes (38 blocks) to write

[=================================================================|] 52/52 100%

created 12 files
created 9 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ tests.nested secboot-sign gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.dAfRheKDuN/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.dAfRheKDuN/DB.pem
warning: data remaining[842624 vs 968696]: gaps between PE/COFF sections?
signature 1
signature 2
warning: data remaining[842624 vs 968696]: gaps between PE/COFF sections?
warning: data remaining[840696 vs 966768]: gaps between PE/COFF sections?
signature 1
warning: data remaining[840696 vs 966768]: gaps between PE/COFF sections?
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ snap pack --filename=pc.snap pc-gadget/
built: pc.snap
+ build_snapd_snap .
+ local TARGET
+ local snapd_snap_cache
+ TARGET=.
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ./
+ mv snapd_from_ci.snap snapd.snap
+ kmodsarg=
+ '[' -n '' ']'
+ snap prepare-image --classic --channel=edge --snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap --snap pc.snap --snap snapd.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model ./classic-seed
Fetching core24 (1151)
Fetching core22 (2111)
WARNING: "snapd", "pc-kernel", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
Copying "snapd.snap" (snapd)
Copying "/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap" (pc-kernel)
Copying "pc.snap" (pc)
+ mv ./classic-seed/system-seed/systems/20250731 ./classic-seed/system-seed/systems/classic
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir ']'
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state teardown-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
Failed to reset failed state of unit fakestore.service: Unit fakestore.service not loaded.
++ command -v snapcraft
+ '[' -z '' ']'
+ snap install snapcraft --candidate --classic
snapcraft (candidate) 8.10.2 from Canonical** installed
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/lxd-state prepare-snap
lxd-state: installing lxd snap
lxd (candidate) 6.4-25e10d4 from Canonical** installed
dpkg-query: no packages found matching lxd-client
lxd-state: initializing lxd
lxd-state: setting up proxy for lxc
To start your first container, try: lxc launch ubuntu:24.04
Or for a virtual machine: lxc launch ubuntu:24.04 --vm

+ cd /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller
+ snapcraft
Launching instance...
Creating new instance from remote
Creating new base instance from remote
Creating new instance from base instance
Starting instance
Initializing parts lifecycle
Installing build-packages
Installing build-snaps
Pulling muinstaller
Building muinstaller
:: + snapcraftctl build
:: Warning: use 'craftctl default' to execute the default step handler
:: + go mod download all
:: + go install -p 2 ./...
::
:: Users are encouraged to replace 'snapcraftctl' with 'craftctl' and use
:: 'CRAFT_*' environment variables in scriptlets when building snaps based
:: on core22. Please refer to the core22 migration guide for details.
:: + cp -a mk-classic-rootfs.sh /root/parts/muinstaller/install/bin
Staging muinstaller
Priming muinstaller
Extracting and updating metadata...
Copying snap assets...
Generating snap metadata...
Generated snap metadata
Reading snap metadata...
Running linters...
Running linter: classic
Running linter: library
Lint OK:
- classic: Snap confinement is set to classic.
Creating snap package...
Created snap package muinstaller_0.1_amd64.snap
+ local muinstaller_snap
++ find /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/ -maxdepth 1 -name '*.snap'
+ muinstaller_snap=/home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
+ tests.nested build-image classic
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
Dload  Upload   Total   Spent    Left  Speed
0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
 32  585M   32  192M    0     0   209M      0  0:00:02 --:--:--  0:00:02  209M
 62  585M   62  368M    0     0   192M      0  0:00:03  0:00:01  0:00:02  192M
100  585M  100  585M    0     0   204M      0  0:00:02  0:00:02 --:--:--  204M
Image doesn't need to be decompressed
'/var/tmp/work-dir/images/ubuntu-classic-24-custom-passphrase-support-on-hybrid_argon2id.img' -> '/var/tmp/work-dir/images/ubuntu-classic-24-custom-passphrase-support-on-hybrid_argon2id.img.pristine'
+ NESTED_PARAM_EXTRA='-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.dAfRheKDuN/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
+ tests.nested create-vm classic --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.dAfRheKDuN/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
Image resized.
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
Timed out waiting for vm ready. Aborting!
failed to wait for the vm becomes ready to receive connections
-----
.
2025-07-31 07:09:04 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/preseed-early-snap-run (jul310600-372884)...
2025-07-31 07:09:04 Debug output for google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2id (jul310600-372849) : saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_passphrase-support-on-hybrid.debug.log
2025-07-31 07:09:04 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2id (jul310600-372849)...
2025-07-31 07:09:32 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:pbkdf2 (jul310600-372849)...
2025-07-31 07:09:54 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/preseed-early-snap-run (jul310600-372884) (94/173)...
2025-07-31 07:10:38 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/preseed-early-snap-run (jul310600-372884)...
2025-07-31 07:10:42 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core-factory-reset-new-secboot:tpm (jul310600-372695)...
2025-07-31 07:10:45 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:encrypted (jul310600-372884)...
2025-07-31 07:10:47 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:encrypted (jul310600-372884) (95/173)...
2025-07-31 07:10:50 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:tested (jul310600-372695)...
2025-07-31 07:10:55 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-storage-safety:preferunencrypted (jul310600-372880) (96/173)...
2025-07-31 07:10:56 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-storage-safety:preferunencrypted (jul310600-372880)...
2025-07-31 07:11:05 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/install-volume-assignment (jul310600-372880)...
2025-07-31 07:11:33 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:partial (jul310600-372844)...
2025-07-31 07:11:36 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/update-snapd-seed-and-factory-reset:tpm (jul310600-372894) (97/173)...
2025-07-31 07:11:37 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-preseed (jul310600-372875)...
2025-07-31 07:11:42 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-factory-reset-install-device-hook (jul310600-372875)...
2025-07-31 07:11:58 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-simple:offline (jul310600-372854) (98/173)...
2025-07-31 07:12:12 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core-factory-reset-new-secboot:hook (jul310600-372844)...
2025-07-31 07:12:35 WARNING: jul310600-372865 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:plain) running late. Current output:
-----
(... 2072 lines above ...)
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 1 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-muinstaller-real_plain
++ BASE_NAME=ubuntu-core-24-custom-muinstaller-real_plain
++ echo ubuntu-core-24-custom-muinstaller-real_plain.img
+ qemu-img convert -f qcow2 -O raw /var/tmp/work-dir/images/ubuntu-classic-24-custom-muinstaller-real_plain.img /var/tmp/work-dir/images/ubuntu-core-24-custom-muinstaller-real_plain.img
-----
.
2025-07-31 07:12:49 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-simple:offline (jul310600-372854)...
2025-07-31 07:12:53 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/cmdline-option:signed (jul310600-372854)...
2025-07-31 07:13:37 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:UBUNTUDIR (jul310600-372889) (99/173)...
2025-07-31 07:13:40 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-remodel (jul310600-372836) (100/173)...
2025-07-31 07:13:54 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/install-volume-assignment (jul310600-372880) (101/173)...
2025-07-31 07:15:30 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-gadget-cloud-conf:signed (jul310600-372870) (102/173)...
2025-07-31 07:15:34 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-gadget-cloud-conf:signed (jul310600-372870)...
2025-07-31 07:15:42 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/minimal-smoke:secboot_disabled (jul310600-372870)...
2025-07-31 07:16:15 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-with-components-offline (jul310600-372859)...
2025-07-31 07:16:26 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_snap (jul310600-372859)...
2025-07-31 07:16:27 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_snap (jul310600-372859) (103/173)...
2025-07-31 07:16:34 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:UBUNTUDIR (jul310600-372889)...
2025-07-31 07:16:40 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-remodel (jul310600-372836)...
2025-07-31 07:16:44 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/cmdline-remove-append (jul310600-372889)...
2025-07-31 07:17:00 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:tested (jul310600-372695) (104/173)...
2025-07-31 07:17:31 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:both (jul310600-372836)...
2025-07-31 07:18:07 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/minimal-smoke:secboot_disabled (jul310600-372870) (105/173)...
2025-07-31 07:18:12 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-factory-reset-install-device-hook (jul310600-372875) (106/173)...
2025-07-31 07:18:20 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core-factory-reset-new-secboot:hook (jul310600-372844) (107/173)...
2025-07-31 07:18:42 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/install-volume-assignment (jul310600-372880)...
2025-07-31 07:18:50 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/minimal-smoke:secboot_enabled (jul310600-372880)...
2025-07-31 07:18:53 WARNING: jul310600-372800 (google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-to-installed-kernel) running late. Current output:
-----
(... 754 lines above ...)
active
active
active
active
active
active
active
active
active
SSH connection ready
-----
.
2025-07-31 07:19:32 WARNING: jul310600-372849 (google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:pbkdf2) running late. Current output:
-----
(... 612 lines above ...)
active
active
active
active
active
active
active
active
active
active
-----
.
2025-07-31 07:19:48 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:pbkdf2 (jul310600-372849) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:pbkdf2 '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ '[' true = false ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : true
++ : ''
++ : false
++ : 512
++ : 512
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state setup-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
Name                     Version  Publisher             Notes  Summary
test-snapd-tools         1.0      test-snaps-canonical  -      Tools for testing the snapd application
test-snapd-tools-core24  1.0      cachio                -      test snap with basic tools used to test snapd
test-snapd-tools-core22  1.0      cachio                -
test-snapd-tools-core20  1.0      test-snaps-canonical  -
test-snapd-tools-core18  1.0      test-snaps-canonical  -
Unit fakestore.service could not be found.
Running as unit: fakestore.service; invocation ID: 86e9f2d66ef2479bb7c1b9081c6d50df
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/testrootorg-store.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir/asserts
+ export SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ snap download --basename=pc --channel=classic-25.10/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ snap download --basename=pc-kernel --channel=25.10/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ uc24_build_initramfs_kernel_snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap /var/tmp/work-dir/assets
+ local ORIG_SNAP=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
Parallel unsquashfs: Using 2 processors
9119 inodes (10342 blocks) to write

[======|                                                     ]  2232/19461  11%
[=============-                                              ]  4474/19461  22%
[===================\                                        ]  6501/19461  33%
[====================/                                       ]  6662/19461  34%
[========================\                                   ]  8218/19461  42%
[====================================================|       ] 17396/19461  89%
[===========================================================|] 19461/19461 100%

created 8517 files
created 1539 directories
created 602 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.14.0-22-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.14.0-22-generic --kerneldir pc-kernel/modules/6.14.0-22-generic --firmwaredir pc-kernel/firmware --output initrd.img
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_set_tran_desc
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmp4jhz7t_mubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.14.0-22-generic
File: manifest-initramfs.yaml-6.14.0-22-generic
Size: 2975      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 571122      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:10:08.393896526 +0000
Modify: 2025-07-31 07:10:08.393896526 +0000
Change: 2025-07-31 07:10:08.393896526 +0000
Birth: 2025-07-31 07:10:08.393896526 +0000
+ initrd_f=initrd.img-6.14.0-22-generic
+ unmkinitramfs initrd.img-6.14.0-22-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.14.0-22-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.14.0-22-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.14.0-22-generic
Signing Unsigned original image
+ cp kernel.efi-6.14.0-22-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.14.0-22.22_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.14.0-22.22_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ mv /var/tmp/work-dir/assets/pc-kernel_6.14.0-22.22_amd64.snap pc-kernel.snap
+ '[' 25.10 = 25.04 ']'
+ model_version_string=2510
+ curl -q https://raw.githubusercontent.com/canonical/models/refs/heads/master/ubuntu-classic-2510-amd64-dangerous.json
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
Dload  Upload   Total   Spent    Left  Speed
0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100  2744  100  2744    0     0  15156      0 --:--:-- --:--:-- --:--:-- 15160
100  2744  100  2744    0     0  15149      0 --:--:-- --:--:-- --:--:-- 15076
+ gojq 'del(.snaps[] | select(.name | test("^(pc|pc-kernel|core.*|snapd)$") | not))' classic.json
+ mv classic-tmp.json classic.json
+ gojq '."authority-id" = "developer1" | ."brand-id" = "developer1"' classic.json
+ mv classic-tmp.json classic.json
+ gendeveloper1 sign-model
+ cat
+ export HYBRID_SYSTEM_MK_ROOT_FS=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/prepare-rootfs.sh
+ HYBRID_SYSTEM_MK_ROOT_FS=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/prepare-rootfs.sh
+ [[ pbkdf2 == \d\e\f\a\u\l\t ]]
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/setup_nested_hybrid_system.sh --model classic.model --store-dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir --gadget pc.snap --gadget-assertion pc.assert --kernel pc-kernel.snap --kernel-assertion pc-kernel.assert --passphrase 'ubuntu test' --extra-muinstaller-arg '-kdf-type pbkdf2'
+ main --model classic.model --store-dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir --gadget pc.snap --gadget-assertion pc.assert --kernel pc-kernel.snap --kernel-assertion pc-kernel.assert --passphrase 'ubuntu test' --extra-muinstaller-arg '-kdf-type pbkdf2'
+ local model_assertion=
+ local store_dir=
+ local gadget_snap=
+ local gadget_assertion=
+ local kernel_snap=
+ local kernel_assertion=
+ local label=classic
+ local disk=
+ local kern_mods_comp=
+ local passphrase=
+ local recovery_key_out=
+ extra_muinstaller_args=()
+ local extra_muinstaller_args
+ '[' 16 -gt 0 ']'
+ case "$1" in
+ model_assertion=classic.model
+ shift 2
+ '[' 14 -gt 0 ']'
+ case "$1" in
+ store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ shift 2
+ '[' 12 -gt 0 ']'
+ case "$1" in
+ gadget_snap=pc.snap
+ shift 2
+ '[' 10 -gt 0 ']'
+ case "$1" in
+ gadget_assertion=pc.assert
+ shift 2
+ '[' 8 -gt 0 ']'
+ case "$1" in
+ kernel_snap=pc-kernel.snap
+ shift 2
+ '[' 6 -gt 0 ']'
+ case "$1" in
+ kernel_assertion=pc-kernel.assert
+ shift 2
+ '[' 4 -gt 0 ']'
+ case "$1" in
+ passphrase='ubuntu test'
+ shift 2
+ '[' 2 -gt 0 ']'
+ case "$1" in
+ extra_muinstaller_args+=("${2}")
+ shift 2
+ '[' 0 -gt 0 ']'
+ '[' -z classic.model ']'
+ '[' -n pc-kernel.snap ']'
+ '[' -z pc-kernel.assert ']'
+ '[' -n pc-kernel.assert ']'
+ '[' -z pc-kernel.snap ']'
+ '[' -n pc.snap ']'
+ '[' -z pc.assert ']'
+ '[' -n pc.assert ']'
+ '[' -z pc.snap ']'
++ realpath classic.model
+ model_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model
+ '[' -n '' ']'
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir ']'
++ realpath /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ '[' -n pc.snap ']'
++ realpath pc.snap
+ gadget_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap
++ realpath pc.assert
+ gadget_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert
+ '[' -n pc-kernel.snap ']'
++ realpath pc-kernel.snap
+ kernel_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
++ realpath pc-kernel.assert
+ kernel_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert
+ '[' -n '' ']'
++ mktemp -d --tmpdir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid
+ cd /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.SWpgAf8pIk
+ '[' -z '' ']'
+ disk=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.SWpgAf8pIk/disk.img
+ truncate --size=6G /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.SWpgAf8pIk/disk.img
+ '[' -z /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap ']'
+ '[' -z /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap ']'
+ run_muinstaller /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert classic /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.SWpgAf8pIk/disk.img '' 'ubuntu test' '' '-kdf-type pbkdf2'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : true
++ : ''
++ : false
++ : 512
++ : 512
+ local model_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model
+ local store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ local gadget_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap
+ local gadget_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert
+ local kernel_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
+ local kernel_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert
+ local label=classic
+ local disk=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.SWpgAf8pIk/disk.img
+ local kern_mods_comp=
+ local 'passphrase=ubuntu test'
+ local recovery_key_out=
+ shift 11
+ extra_muinstaller_args=('-kdf-type pbkdf2')
+ local extra_muinstaller_args
+ snap ack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert
+ snap ack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert
+ local key_name
++ nested_get_snakeoil_key
++ nested_ensure_ovmf
++ '[' -d /var/tmp/work-dir/assets/ovmf ']'
++ '[' -f /var/tmp/work-dir/assets/test-snapd-ovmf.snap ']'
++ snap download --channel=latest/edge test-snapd-ovmf --basename=test-snapd-ovmf --target-directory=/var/tmp/work-dir/assets
++ unsquashfs -d /var/tmp/work-dir/assets/ovmf /var/tmp/work-dir/assets/test-snapd-ovmf.snap
++ os.query is-arm
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.key DB.key
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.crt DB.pem
++ echo DB
+ key_name=DB
+ local snakeoil_key=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.SWpgAf8pIk/DB.key
+ local snakeoil_cert=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.SWpgAf8pIk/DB.pem
+ unsquashfs -d pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap
Parallel unsquashfs: Using 2 processors
14 inodes (38 blocks) to write

[=================================================================|] 52/52 100%

created 12 files
created 9 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ tests.nested secboot-sign gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.SWpgAf8pIk/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.SWpgAf8pIk/DB.pem
warning: data remaining[842624 vs 968696]: gaps between PE/COFF sections?
signature 1
signature 2
warning: data remaining[842624 vs 968696]: gaps between PE/COFF sections?
warning: data remaining[840696 vs 966768]: gaps between PE/COFF sections?
signature 1
warning: data remaining[840696 vs 966768]: gaps between PE/COFF sections?
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ snap pack --filename=pc.snap pc-gadget/
built: pc.snap
+ build_snapd_snap .
+ local TARGET
+ local snapd_snap_cache
+ TARGET=.
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ./
+ mv snapd_from_ci.snap snapd.snap
+ kmodsarg=
+ '[' -n '' ']'
+ snap prepare-image --classic --channel=edge --snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap --snap pc.snap --snap snapd.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model ./classic-seed
Fetching core24 (1151)
Fetching core22 (2111)
WARNING: "snapd", "pc-kernel", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
Copying "snapd.snap" (snapd)
Copying "/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap" (pc-kernel)
Copying "pc.snap" (pc)
+ mv ./classic-seed/system-seed/systems/20250731 ./classic-seed/system-seed/systems/classic
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir ']'
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state teardown-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
Failed to reset failed state of unit fakestore.service: Unit fakestore.service not loaded.
++ command -v snapcraft
+ '[' -z '' ']'
+ snap install snapcraft --candidate --classic
snapcraft (candidate) 8.10.2 from Canonical** installed
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/lxd-state prepare-snap
lxd-state: installing lxd snap
lxd (candidate) 6.4-25e10d4 from Canonical** installed
dpkg-query: no packages found matching lxd-client
lxd-state: initializing lxd
lxd-state: setting up proxy for lxc
To start your first container, try: lxc launch ubuntu:24.04
Or for a virtual machine: lxc launch ubuntu:24.04 --vm

+ cd /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller
+ snapcraft
Launching instance...
Creating new instance from remote
Creating new base instance from remote
Creating new instance from base instance
Starting instance
Initializing parts lifecycle
Installing build-packages
Installing build-snaps
Pulling muinstaller
Building muinstaller
:: + snapcraftctl build
:: Warning: use 'craftctl default' to execute the default step handler
:: + go mod download all
:: + go install -p 2 ./...
::
:: Users are encouraged to replace 'snapcraftctl' with 'craftctl' and use
:: 'CRAFT_*' environment variables in scriptlets when building snaps based
:: on core22. Please refer to the core22 migration guide for details.
:: + cp -a mk-classic-rootfs.sh /root/parts/muinstaller/install/bin
Staging muinstaller
Priming muinstaller
Extracting and updating metadata...
Copying snap assets...
Generating snap metadata...
Generated snap metadata
Reading snap metadata...
Running linters...
Running linter: classic
Running linter: library
Lint OK:
- classic: Snap confinement is set to classic.
Creating snap package...
Created snap package muinstaller_0.1_amd64.snap
+ local muinstaller_snap
++ find /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/ -maxdepth 1 -name '*.snap'
+ muinstaller_snap=/home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
+ tests.nested build-image classic
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
Dload  Upload   Total   Spent    Left  Speed
0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
 21  585M   21  126M    0     0   146M      0  0:00:04 --:--:--  0:00:04  146M
 56  585M   56  327M    0     0   175M      0  0:00:03  0:00:01  0:00:02  175M
 93  585M   93  544M    0     0   189M      0  0:00:03  0:00:02  0:00:01  189M
100  585M  100  585M    0     0   193M      0  0:00:03  0:00:03 --:--:--  193M
Image doesn't need to be decompressed
'/var/tmp/work-dir/images/ubuntu-classic-24-custom-passphrase-support-on-hybrid_pbkdf2.img' -> '/var/tmp/work-dir/images/ubuntu-classic-24-custom-passphrase-support-on-hybrid_pbkdf2.img.pristine'
+ NESTED_PARAM_EXTRA='-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.SWpgAf8pIk/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
+ tests.nested create-vm classic --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.SWpgAf8pIk/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
Image resized.
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
Timed out waiting for vm ready. Aborting!
failed to wait for the vm becomes ready to receive connections
-----
.
2025-07-31 07:19:49 Debug output for google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:pbkdf2 (jul310600-372849) : saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_passphrase-support-on-hybrid.debug.log
2025-07-31 07:19:49 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:pbkdf2 (jul310600-372849)...
2025-07-31 07:19:51 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/update-snapd-seed-and-factory-reset:tpm (jul310600-372894)...
2025-07-31 07:20:00 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-create-recovery (jul310600-372894)...
2025-07-31 07:20:12 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_snap_and_comp (jul310600-372849)...
2025-07-31 07:20:13 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_snap_and_comp (jul310600-372849) (108/173)...
2025-07-31 07:20:45 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/cmdline-option:signed (jul310600-372854) (109/173)...
2025-07-31 07:20:47 WARNING: jul310600-372884 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:encrypted) running late. Current output:
-----
(... 2124 lines above ...)
++++ IFS=
++++ read -r mysnap
+++ '[' 1 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-muinstaller-real_encrypted
++ BASE_NAME=ubuntu-core-24-custom-muinstaller-real_encrypted
++ echo ubuntu-core-24-custom-muinstaller-real_encrypted.img
+ image_name=ubuntu-core-24-custom-muinstaller-real_encrypted.img
+ touch /var/tmp/work-dir/images/ubuntu-core-24-custom-muinstaller-real_encrypted.img.configured
+ tests.nested create-vm core --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
-----
.
2025-07-31 07:21:05 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:tested (jul310600-372695)...
2025-07-31 07:21:13 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-gadget-cloud-conf:secured (jul310600-372695)...
2025-07-31 07:21:21 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/minimal-smoke:secboot_enabled (jul310600-372880) (110/173)...
2025-07-31 07:21:40 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-factory-reset-install-device-hook (jul310600-372875)...
2025-07-31 07:21:48 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/kernel-modules-components:plain (jul310600-372875)...
2025-07-31 07:22:00 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/cmdline-option:signed (jul310600-372854)...
2025-07-31 07:22:11 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_all (jul310600-372854)...
2025-07-31 07:22:12 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_all (jul310600-372854) (111/173)...
2025-07-31 07:22:18 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/cmdline-remove-append (jul310600-372889) (112/173)...
2025-07-31 07:22:19 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/cmdline-remove-append (jul310600-372889)...
2025-07-31 07:22:26 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/cmdline-option:dangerous (jul310600-372889)...
2025-07-31 07:22:35 WARNING: jul310600-372865 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:plain) running late. Current output:
-----
(... 46 lines above ...)
++ BASE_NAME=ubuntu-core-24-custom-muinstaller-real_plain
++ echo ubuntu-core-24-custom-muinstaller-real_plain.img
+ image_name=ubuntu-core-24-custom-muinstaller-real_plain.img
+ touch /var/tmp/work-dir/images/ubuntu-core-24-custom-muinstaller-real_plain.img.configured
+ tests.nested create-vm core --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
'/var/tmp/work-dir/images/ubuntu-core-24-custom-muinstaller-real_plain.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
'/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.fd' -> '/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.current.fd'
tests.systemd: unit service file already exist, it is going to be overwritten
Waiting the vm is ready to be used
active
-----
.
2025-07-31 07:23:10 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-to-installed-kernel (jul310600-372800) (113/173)...
2025-07-31 07:23:16 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core-factory-reset-new-secboot:hook (jul310600-372844)...
2025-07-31 07:23:20 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-reboot:install (jul310600-372844)...
2025-07-31 07:23:41 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:both (jul310600-372836) (114/173)...
2025-07-31 07:25:15 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/minimal-smoke:secboot_disabled (jul310600-372870)...
2025-07-31 07:25:20 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/split-refresh (jul310600-372870)...
2025-07-31 07:25:22 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/split-refresh (jul310600-372870) (115/173)...
2025-07-31 07:25:59 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-create-recovery (jul310600-372894) (116/173)...
2025-07-31 07:26:02 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:both (jul310600-372836)...
2025-07-31 07:26:11 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core-dbx-revokes-old-keys (jul310600-372836)...
2025-07-31 07:26:27 WARNING: jul310600-372859 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_snap) running late. Current output:
-----
(... 769 lines above ...)
SNAPD_TRACE=1
SNAPD_JSON_LOGGING=1
SNAP_LOG_TO_JOURNAL=1
status: disabled
+ remote.exec sudo mkdir -p /var/lib/snapd/seed
+ remote.exec 'sudo mount -o bind /var/lib/snapd/install-seed /var/lib/snapd/seed'
+ remote.push /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
+ remote.exec 'sudo snap install --classic --dangerous muinstaller_0.1_amd64.snap'
-----
.
2025-07-31 07:27:36 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/kernel-modules-components:plain (jul310600-372875) (117/173)...
2025-07-31 07:28:02 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-gadget-cloud-conf:secured (jul310600-372695) (118/173)...
2025-07-31 07:28:06 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-gadget-cloud-conf:secured (jul310600-372695)...
2025-07-31 07:28:15 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/uc-grub-boot-chains (jul310600-372695)...
2025-07-31 07:28:44 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/cmdline-option:dangerous (jul310600-372889) (119/173)...
2025-07-31 07:30:13 WARNING: jul310600-372849 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_snap_and_comp) running late. Current output:
-----
(... 449 lines above ...)
active
active
active
active
active
active
active
active
active
active
-----
.
2025-07-31 07:30:20 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/minimal-smoke:secboot_enabled (jul310600-372880)...
2025-07-31 07:30:20 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_snap (jul310600-372859)...
2025-07-31 07:30:28 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-min-size (jul310600-372880)...
2025-07-31 07:30:47 WARNING: jul310600-372884 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:encrypted) running late. Current output:
-----
(... 133 lines above ...)
+ '[' -n '' ']'
+ tests.nested create-vm core --keep-firmware-state
'/var/tmp/work-dir/images/ubuntu-core-24-custom-muinstaller-real_encrypted.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
active
active
SSH connection ready
sudo: unable to resolve host localhost.localdomain: Name or service not known
-----
.
2025-07-31 07:30:50 Error executing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_snap_and_comp (jul310600-372849) :
-----
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : false
++ : 512
++ : 512
+ os.query is-noble
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ snap download --basename=pc --channel=24/beta pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ unsquashfs -d pc-gadget pc.snap
Parallel unsquashfs: Using 2 processors
19 inodes (43 blocks) to write

[=================================================================|] 62/62 100%

created 17 files
created 10 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ echo console=ttyS0
+ cat
+ echo 'Sign the shim binary'
Sign the shim binary
++ tests.nested download snakeoil-key
+ KEY_NAME=DB
+ SNAKEOIL_KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/DB.key
+ SNAKEOIL_CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/DB.pem
+ tests.nested secboot-sign gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/DB.pem
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
signature 1
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
Signing Unsigned original image
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ snap pack --filename=pc.snap pc-gadget/
built: pc.snap
+ snap download --basename=pc-kernel --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ unsquashfs -d tmp-pc-kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=======/                                                    ]  2494/19159  13%
[===============-                                            ]  5032/19159  26%
[===================\                                        ]  6346/19159  33%
[=========================\                                  ]  8237/19159  42%
[=====================================================|      ] 17291/19159  90%
[===========================================================|] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
+ cat
+ rm pc-kernel.snap
+ snap pack tmp-pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
+ mv pc-kernel_6.8.0-72.72_amd64.snap pc-kernel.snap
+ os.query is-ubuntu-ge 24.04
+ uc24_build_initramfs_kernel_snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/pc-kernel.snap /var/tmp/work-dir/assets
+ local ORIG_SNAP=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=======/                                                    ]  2484/19159  12%
[==================-                                         ]  5925/19159  30%
[===================\                                        ]  6346/19159  33%
[=========================\                                  ]  8261/19159  43%
[=====================================================|      ] 17429/19159  90%
[===========================================================|] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmp5h6g9k1qubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 594454      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:21:24.471611055 +0000
Modify: 2025-07-31 07:21:24.471611055 +0000
Change: 2025-07-31 07:21:24.471611055 +0000
Birth: 2025-07-31 07:21:24.471611055 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap pc-kernel.snap
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ build_snapd_snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core
+ local TARGET
+ local snapd_snap_cache
+ TARGET=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/
+ mv snapd_from_ci.snap snapd.snap
+ sed -i 's/$BASE/core24/' ./snap-with-comps/meta/snap.yaml
+ snap pack ./snap-with-comps --filename=snap-with-comps.snap
built: snap-with-comps.snap
+ snap pack ./comp1 --filename=snap-with-comps+comp1.comp
built: snap-with-comps+comp1.comp
+ SEED_DIR=core-seed
+ wget -q https://raw.githubusercontent.com/snapcore/models/master/ubuntu-core-24-amd64-dangerous.model -O my.model
+ snap prepare-image --channel=edge --snap ./pc-kernel.snap --snap ./pc.snap --snap ./snapd.snap --snap ./snap-with-comps.snap --comp ./snap-with-comps+comp1.comp my.model ./core-seed
WARNING: proceeding to download snaps ignoring validations, this default will change in the future. For now use --validation=enforce for validations to be taken into account, pass instead --validation=ignore to preserve current behavior going forward
Fetching core24 (1151)
WARNING: "snapd", "pc-kernel", "pc", "snap-with-comps" installed from local snaps disconnected from a store cannot be refreshed subsequently!
Copying "./snapd.snap" (snapd)
Copying "./pc-kernel.snap" (pc-kernel)
Copying "./pc.snap" (pc)
Copying "./snap-with-comps.snap" (snap-with-comps)
Copying "./snap-with-comps+comp1.comp" (snap-with-comps+comp1)
++ basename ./core-seed/system-seed/systems/20250731
+ LABEL=20250731
+ cp -a ./core-seed/system-seed/ /var/lib/snapd/seed
+ snap install snapcraft --candidate --classic
snapcraft (candidate) 8.10.2 from Canonical** installed
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/lxd-state prepare-snap
lxd-state: installing lxd snap
lxd (candidate) 6.4-25e10d4 from Canonical** installed
dpkg-query: no packages found matching lxd-client
lxd-state: initializing lxd
lxd-state: setting up proxy for lxc
To start your first container, try: lxc launch ubuntu:24.04
Or for a virtual machine: lxc launch ubuntu:24.04 --vm

+ cd /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller
+ snapcraft
Launching instance...
Creating new instance from remote
Creating new base instance from remote
Creating new instance from base instance
Starting instance
Initializing parts lifecycle
Installing build-packages
Installing build-snaps
Pulling muinstaller
Building muinstaller
:: + snapcraftctl build
:: Warning: use 'craftctl default' to execute the default step handler
:: + go mod download all
:: + go install -p 2 ./...
::
:: Users are encouraged to replace 'snapcraftctl' with 'craftctl' and use
:: 'CRAFT_*' environment variables in scriptlets when building snaps based
:: on core22. Please refer to the core22 migration guide for details.
:: + cp -a mk-classic-rootfs.sh /root/parts/muinstaller/install/bin
Staging muinstaller
Priming muinstaller
Extracting and updating metadata...
Copying snap assets...
Generating snap metadata...
Generated snap metadata
Reading snap metadata...
Running linters...
Running linter: classic
Running linter: library
Lint OK:
- classic: Snap confinement is set to classic.
Creating snap package...
Created snap package muinstaller_0.1_amd64.snap
++ find /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/ -maxdepth 1 -name '*.snap'
+ MUINSTALLER_SNAP=/home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
+ echo 'found /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap'
found /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
+ truncate --size=4G fake-disk.img
+ tests.nested build-image classic
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
Dload  Upload   Total   Spent    Left  Speed
0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  8  585M    8 50.5M    0     0   157M      0  0:00:03 --:--:--  0:00:03  157M
 43  585M   43  257M    0     0   194M      0  0:00:03  0:00:01  0:00:02  194M
 81  585M   81  474M    0     0   204M      0  0:00:02  0:00:02 --:--:--  204M
100  585M  100  585M    0     0   206M      0  0:00:02  0:00:02 --:--:--  206M
Image doesn't need to be decompressed
'/var/tmp/work-dir/images/ubuntu-classic-24-custom-muinstaller-core_install_optional_snap_and_comp.img' -> '/var/tmp/work-dir/images/ubuntu-classic-24-custom-muinstaller-core_install_optional_snap_and_comp.img.pristine'
++ pwd
+ NESTED_PARAM_EXTRA='-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/fake-disk.img,if=none,snapshot=off,format=raw,id=disk2     -device virtio-blk-pci,drive=disk2,serial=target'
+ tests.nested create-vm classic --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/fake-disk.img,if=none,snapshot=off,format=raw,id=disk2     -device virtio-blk-pci,drive=disk2,serial=target'
Image resized.
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
Timed out waiting for vm ready. Aborting!
failed to wait for the vm becomes ready to receive connections
-----
.
2025-07-31 07:30:50 Debug output for google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_snap_and_comp (jul310600-372849) : saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_muinstaller-core.debug.log
2025-07-31 07:30:50 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_snap_and_comp (jul310600-372849)...
2025-07-31 07:30:52 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-remodel (jul310600-372859)...
2025-07-31 07:31:06 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/cmdline-option:dangerous (jul310600-372889)...
2025-07-31 07:31:12 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2i (jul310600-372849)...
2025-07-31 07:31:15 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/split-refresh (jul310600-372870)...
2025-07-31 07:31:16 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/devmode-snap-seeded-dangerous (jul310600-372889)...
2025-07-31 07:31:23 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core-recover-from-recovery:clear_tpm (jul310600-372870)...
2025-07-31 07:31:35 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-create-recovery (jul310600-372894)...
2025-07-31 07:31:42 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-validation-sets-invalid (jul310600-372894)...
2025-07-31 07:32:12 WARNING: jul310600-372854 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_all) running late. Current output:
-----
(... 747 lines above ...)
+++ '[' 0 '!=' 0 ']'
+++ echo ubuntu-core-24-custom-muinstaller-core_install_optional_all
++ BASE_NAME=ubuntu-core-24-custom-muinstaller-core_install_optional_all
++ echo ubuntu-core-24-custom-muinstaller-core_install_optional_all.img
+ IMAGE_NAME=ubuntu-core-24-custom-muinstaller-core_install_optional_all.img
+ touch /var/tmp/work-dir/images/ubuntu-core-24-custom-muinstaller-core_install_optional_all.img.configured
+ tests.nested create-vm core --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/fake-disk.img,if=none,snapshot=off,format=raw,id=disk2     -device virtio-blk-pci,drive=disk2,serial=target'
'/var/tmp/work-dir/images/ubuntu-core-24-custom-muinstaller-core_install_optional_all.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
'/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.enrolled.fd' -> '/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.current.fd'
error: no matching snaps installed
-----
.
2025-07-31 07:32:24 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core-dbx-revokes-old-keys (jul310600-372836) (120/173)...
2025-07-31 07:32:27 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/kernel-modules-components:plain (jul310600-372875)...
2025-07-31 07:32:31 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:nogadget (jul310600-372875)...
2025-07-31 07:32:35 WARNING: jul310600-372865 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:plain) running late. Current output:
-----
(... 129 lines above ...)
Waiting the vm is ready to be used
active
active
active
active
active
active
active
SSH connection ready
sudo: unable to resolve host localhost.localdomain: Name or service not known
-----
.
2025-07-31 07:33:10 WARNING: jul310600-372800 (google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-to-installed-kernel) running late. Current output:
-----
(... 45 lines above ...)
++ tests.nested boot-id
+ boot_id=45d03203-5243-44c5-97d5-9e67825eabfb
++ remote.exec 'sudo snap remodel --no-wait third-model.assert'
+ change_id=5
+ remote.wait-for reboot 45d03203-5243-44c5-97d5-9e67825eabfb
remote.wait-for: waiting for reboot
.........Connection timed out during banner exchange
.Connection timed out during banner exchange
.Connection timed out during banner exchange
.
-----
.
2025-07-31 07:33:14 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-min-size (jul310600-372880) (121/173)...
2025-07-31 07:33:20 WARNING: jul310600-372844 (google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-reboot:install) running late. Current output:
-----
(... 1010 lines above ...)
created 7578 files
created 1388 directories
created 1669 symlinks
created 4 devices
created 0 fifos
created 0 sockets
created 3 hardlinks
+ gojq --yaml-input --yaml-output '.version = "v2"' squashfs-root/meta/snap.yaml
+ mv snap.yaml.new squashfs-root/meta/snap.yaml
+ snap pack --filename=./core24.snap ./squashfs-root
-----
.
2025-07-31 07:34:07 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/uc-grub-boot-chains (jul310600-372695) (122/173)...
2025-07-31 07:34:27 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-reboot:install (jul310600-372844) (123/173)...
2025-07-31 07:36:07 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core-dbx-revokes-old-keys (jul310600-372836)...
2025-07-31 07:36:20 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-reboot:recover (jul310600-372836)...
2025-07-31 07:36:55 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-remodel (jul310600-372859) (124/173)...
2025-07-31 07:37:01 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/devmode-snap-seeded-dangerous (jul310600-372889) (125/173)...
2025-07-31 07:37:04 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/devmode-snap-seeded-dangerous (jul310600-372889)...
2025-07-31 07:37:11 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-validation-sets-downgrade (jul310600-372889)...
2025-07-31 07:37:11 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core-recover-from-recovery:clear_tpm (jul310600-372870) (126/173)...
2025-07-31 07:38:00 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-validation-sets-invalid (jul310600-372894) (127/173)...
2025-07-31 07:38:03 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-validation-sets-invalid (jul310600-372894)...
2025-07-31 07:38:10 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-assets-secure:boot (jul310600-372894)...
2025-07-31 07:38:14 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core-recover-from-recovery:clear_tpm (jul310600-372870)...
2025-07-31 07:38:21 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-da-lockout:encrypted (jul310600-372870)...
2025-07-31 07:38:46 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:nogadget (jul310600-372875) (128/173)...
2025-07-31 07:39:55 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-min-size (jul310600-372880)...
2025-07-31 07:39:59 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/build-with-kernel-modules-components:encrypted (jul310600-372880)...
2025-07-31 07:40:07 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-reboot:install (jul310600-372844)...
2025-07-31 07:40:19 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2404 (jul310600-372844)...
2025-07-31 07:40:30 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/uc-grub-boot-chains (jul310600-372695)...
2025-07-31 07:40:42 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:secureboot (jul310600-372695)...
2025-07-31 07:40:47 WARNING: jul310600-372884 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:encrypted) running late. Current output:
-----
(... 514 lines above ...)
retry: command sh -c remote.exec "snap change 13 | grep -E 'Task set to wait until a system restart allows to continue'" failed with code 1
retry: next attempt in 1.0 second(s) (attempt 3 of 120)
2025-07-31T07:40:04Z INFO Task set to wait until a system restart allows to continue
+ remote.exec test -f /run/reboot-required
+ remote.exec cat /run/reboot-required.pkgs
+ MATCH snap:pc-kernel
+ remote.exec not test -f /run/systemd/shutdown/scheduled
+ remote.exec sudo reboot
sudo: unable to resolve host localhost.localdomain: Name or service not known
+ tests.nested wait-for reboot 43d2107b-a953-4870-9ffc-b6bfd1daac15
-----
.
2025-07-31 07:41:00 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2i (jul310600-372849) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2i '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ '[' true = false ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : true
++ : ''
++ : false
++ : 512
++ : 512
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state setup-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
Name                     Version  Publisher             Notes  Summary
test-snapd-tools         1.0      test-snaps-canonical  -      Tools for testing the snapd application
test-snapd-tools-core24  1.0      cachio                -      test snap with basic tools used to test snapd
test-snapd-tools-core22  1.0      cachio                -
test-snapd-tools-core20  1.0      test-snaps-canonical  -
test-snapd-tools-core18  1.0      test-snaps-canonical  -
Unit fakestore.service could not be found.
Running as unit: fakestore.service; invocation ID: 0bc0773612e14d458caab47053972629
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/testrootorg-store.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir/asserts
+ export SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ snap download --basename=pc --channel=classic-25.10/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ snap download --basename=pc-kernel --channel=25.10/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ uc24_build_initramfs_kernel_snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap /var/tmp/work-dir/assets
+ local ORIG_SNAP=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
Parallel unsquashfs: Using 2 processors
9119 inodes (10342 blocks) to write

[======|                                                     ]  2035/19461  10%
[=============-                                              ]  4415/19461  22%
[===================\                                        ]  6476/19461  33%
[====================/                                       ]  6656/19461  34%
[=======================\                                    ]  7894/19461  40%
[=================================================|          ] 16469/19461  84%
[===========================================================|] 19461/19461 100%

created 8517 files
created 1539 directories
created 602 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.14.0-22-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.14.0-22-generic --kerneldir pc-kernel/modules/6.14.0-22-generic --firmwaredir pc-kernel/firmware --output initrd.img
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_set_tran_desc
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmp3cfsjiarubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.14.0-22-generic
File: manifest-initramfs.yaml-6.14.0-22-generic
Size: 2975      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 606839      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:31:41.687546085 +0000
Modify: 2025-07-31 07:31:41.687546085 +0000
Change: 2025-07-31 07:31:41.687546085 +0000
Birth: 2025-07-31 07:31:41.687546085 +0000
+ initrd_f=initrd.img-6.14.0-22-generic
+ unmkinitramfs initrd.img-6.14.0-22-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.14.0-22-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.14.0-22-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.14.0-22-generic
Signing Unsigned original image
+ cp kernel.efi-6.14.0-22-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.14.0-22.22_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.14.0-22.22_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ mv /var/tmp/work-dir/assets/pc-kernel_6.14.0-22.22_amd64.snap pc-kernel.snap
+ '[' 25.10 = 25.04 ']'
+ model_version_string=2510
+ curl -q https://raw.githubusercontent.com/canonical/models/refs/heads/master/ubuntu-classic-2510-amd64-dangerous.json
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
Dload  Upload   Total   Spent    Left  Speed
0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100  2744  100  2744    0     0  22655      0 --:--:-- --:--:-- --:--:-- 22866
+ gojq 'del(.snaps[] | select(.name | test("^(pc|pc-kernel|core.*|snapd)$") | not))' classic.json
+ mv classic-tmp.json classic.json
+ gojq '."authority-id" = "developer1" | ."brand-id" = "developer1"' classic.json
+ mv classic-tmp.json classic.json
+ gendeveloper1 sign-model
+ cat
+ export HYBRID_SYSTEM_MK_ROOT_FS=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/prepare-rootfs.sh
+ HYBRID_SYSTEM_MK_ROOT_FS=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/prepare-rootfs.sh
+ [[ argon2i == \d\e\f\a\u\l\t ]]
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/setup_nested_hybrid_system.sh --model classic.model --store-dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir --gadget pc.snap --gadget-assertion pc.assert --kernel pc-kernel.snap --kernel-assertion pc-kernel.assert --passphrase 'ubuntu test' --extra-muinstaller-arg '-kdf-type argon2i'
+ main --model classic.model --store-dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir --gadget pc.snap --gadget-assertion pc.assert --kernel pc-kernel.snap --kernel-assertion pc-kernel.assert --passphrase 'ubuntu test' --extra-muinstaller-arg '-kdf-type argon2i'
+ local model_assertion=
+ local store_dir=
+ local gadget_snap=
+ local gadget_assertion=
+ local kernel_snap=
+ local kernel_assertion=
+ local label=classic
+ local disk=
+ local kern_mods_comp=
+ local passphrase=
+ local recovery_key_out=
+ extra_muinstaller_args=()
+ local extra_muinstaller_args
+ '[' 16 -gt 0 ']'
+ case "$1" in
+ model_assertion=classic.model
+ shift 2
+ '[' 14 -gt 0 ']'
+ case "$1" in
+ store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ shift 2
+ '[' 12 -gt 0 ']'
+ case "$1" in
+ gadget_snap=pc.snap
+ shift 2
+ '[' 10 -gt 0 ']'
+ case "$1" in
+ gadget_assertion=pc.assert
+ shift 2
+ '[' 8 -gt 0 ']'
+ case "$1" in
+ kernel_snap=pc-kernel.snap
+ shift 2
+ '[' 6 -gt 0 ']'
+ case "$1" in
+ kernel_assertion=pc-kernel.assert
+ shift 2
+ '[' 4 -gt 0 ']'
+ case "$1" in
+ passphrase='ubuntu test'
+ shift 2
+ '[' 2 -gt 0 ']'
+ case "$1" in
+ extra_muinstaller_args+=("${2}")
+ shift 2
+ '[' 0 -gt 0 ']'
+ '[' -z classic.model ']'
+ '[' -n pc-kernel.snap ']'
+ '[' -z pc-kernel.assert ']'
+ '[' -n pc-kernel.assert ']'
+ '[' -z pc-kernel.snap ']'
+ '[' -n pc.snap ']'
+ '[' -z pc.assert ']'
+ '[' -n pc.assert ']'
+ '[' -z pc.snap ']'
++ realpath classic.model
+ model_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model
+ '[' -n '' ']'
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir ']'
++ realpath /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ '[' -n pc.snap ']'
++ realpath pc.snap
+ gadget_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap
++ realpath pc.assert
+ gadget_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert
+ '[' -n pc-kernel.snap ']'
++ realpath pc-kernel.snap
+ kernel_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
++ realpath pc-kernel.assert
+ kernel_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert
+ '[' -n '' ']'
++ mktemp -d --tmpdir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid
+ cd /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.tNAU1XDBPj
+ '[' -z '' ']'
+ disk=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.tNAU1XDBPj/disk.img
+ truncate --size=6G /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.tNAU1XDBPj/disk.img
+ '[' -z /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap ']'
+ '[' -z /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap ']'
+ run_muinstaller /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert classic /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.tNAU1XDBPj/disk.img '' 'ubuntu test' '' '-kdf-type argon2i'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : true
++ : ''
++ : false
++ : 512
++ : 512
+ local model_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model
+ local store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ local gadget_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap
+ local gadget_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert
+ local kernel_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
+ local kernel_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert
+ local label=classic
+ local disk=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.tNAU1XDBPj/disk.img
+ local kern_mods_comp=
+ local 'passphrase=ubuntu test'
+ local recovery_key_out=
+ shift 11
+ extra_muinstaller_args=('-kdf-type argon2i')
+ local extra_muinstaller_args
+ snap ack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert
+ snap ack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert
+ local key_name
++ nested_get_snakeoil_key
++ nested_ensure_ovmf
++ '[' -d /var/tmp/work-dir/assets/ovmf ']'
++ '[' -f /var/tmp/work-dir/assets/test-snapd-ovmf.snap ']'
++ snap download --channel=latest/edge test-snapd-ovmf --basename=test-snapd-ovmf --target-directory=/var/tmp/work-dir/assets
++ unsquashfs -d /var/tmp/work-dir/assets/ovmf /var/tmp/work-dir/assets/test-snapd-ovmf.snap
++ os.query is-arm
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.key DB.key
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.crt DB.pem
++ echo DB
+ key_name=DB
+ local snakeoil_key=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.tNAU1XDBPj/DB.key
+ local snakeoil_cert=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.tNAU1XDBPj/DB.pem
+ unsquashfs -d pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap
Parallel unsquashfs: Using 2 processors
14 inodes (38 blocks) to write

[=================================================================|] 52/52 100%

created 12 files
created 9 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ tests.nested secboot-sign gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.tNAU1XDBPj/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.tNAU1XDBPj/DB.pem
warning: data remaining[842624 vs 968696]: gaps between PE/COFF sections?
signature 1
signature 2
warning: data remaining[842624 vs 968696]: gaps between PE/COFF sections?
warning: data remaining[840696 vs 966768]: gaps between PE/COFF sections?
signature 1
warning: data remaining[840696 vs 966768]: gaps between PE/COFF sections?
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ snap pack --filename=pc.snap pc-gadget/
built: pc.snap
+ build_snapd_snap .
+ local TARGET
+ local snapd_snap_cache
+ TARGET=.
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ./
+ mv snapd_from_ci.snap snapd.snap
+ kmodsarg=
+ '[' -n '' ']'
+ snap prepare-image --classic --channel=edge --snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap --snap pc.snap --snap snapd.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model ./classic-seed
Fetching core24 (1151)
Fetching core22 (2111)
WARNING: "snapd", "pc-kernel", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
Copying "snapd.snap" (snapd)
Copying "/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap" (pc-kernel)
Copying "pc.snap" (pc)
+ mv ./classic-seed/system-seed/systems/20250731 ./classic-seed/system-seed/systems/classic
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir ']'
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state teardown-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
Failed to reset failed state of unit fakestore.service: Unit fakestore.service not loaded.
++ command -v snapcraft
+ '[' -z '' ']'
+ snap install snapcraft --candidate --classic
snapcraft (candidate) 8.10.2 from Canonical** installed
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/lxd-state prepare-snap
lxd-state: installing lxd snap
lxd (candidate) 6.4-25e10d4 from Canonical** installed
dpkg-query: no packages found matching lxd-client
lxd-state: initializing lxd
lxd-state: setting up proxy for lxc
To start your first container, try: lxc launch ubuntu:24.04
Or for a virtual machine: lxc launch ubuntu:24.04 --vm

+ cd /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller
+ snapcraft
Launching instance...
Creating new instance from remote
Creating new base instance from remote
Creating new instance from base instance
Starting instance
Initializing parts lifecycle
Installing build-packages
Installing build-snaps
Pulling muinstaller
Building muinstaller
:: + snapcraftctl build
:: Warning: use 'craftctl default' to execute the default step handler
:: + go mod download all
:: + go install -p 2 ./...
::
:: Users are encouraged to replace 'snapcraftctl' with 'craftctl' and use
:: 'CRAFT_*' environment variables in scriptlets when building snaps based
:: on core22. Please refer to the core22 migration guide for details.
:: + cp -a mk-classic-rootfs.sh /root/parts/muinstaller/install/bin
Staging muinstaller
Priming muinstaller
Extracting and updating metadata...
Copying snap assets...
Generating snap metadata...
Generated snap metadata
Reading snap metadata...
Running linters...
Running linter: classic
Running linter: library
Lint OK:
- classic: Snap confinement is set to classic.
Creating snap package...
Created snap package muinstaller_0.1_amd64.snap
+ local muinstaller_snap
++ find /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/ -maxdepth 1 -name '*.snap'
+ muinstaller_snap=/home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
+ tests.nested build-image classic
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
Dload  Upload   Total   Spent    Left  Speed
0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
 30  585M   30  179M    0     0   229M      0  0:00:02 --:--:--  0:00:02  229M
 70  585M   70  414M    0     0   232M      0  0:00:02  0:00:01  0:00:01  232M
100  585M  100  585M    0     0   237M      0  0:00:02  0:00:02 --:--:--  237M
Image doesn't need to be decompressed
'/var/tmp/work-dir/images/ubuntu-classic-24-custom-passphrase-support-on-hybrid_argon2i.img' -> '/var/tmp/work-dir/images/ubuntu-classic-24-custom-passphrase-support-on-hybrid_argon2i.img.pristine'
+ NESTED_PARAM_EXTRA='-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.tNAU1XDBPj/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
+ tests.nested create-vm classic --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.tNAU1XDBPj/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
Image resized.
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
Timed out waiting for vm ready. Aborting!
failed to wait for the vm becomes ready to receive connections
-----
.
2025-07-31 07:41:01 Debug output for google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2i (jul310600-372849) : saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_passphrase-support-on-hybrid.debug.log
2025-07-31 07:41:01 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2i (jul310600-372849)...
2025-07-31 07:41:15 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:nogadget (jul310600-372875)...
2025-07-31 07:41:23 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-initramfs-time-moves-forward (jul310600-372875)...
2025-07-31 07:41:28 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/kernel-modules-components:encrypted (jul310600-372849)...
2025-07-31 07:42:12 WARNING: jul310600-372854 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_all) running late. Current output:
-----
(... 152 lines above ...)
+ MATCH pc-kernel
+ '[' true = true ']'
+ remote.exec 'sudo test -d /var/lib/snapd/device/fde'
+ remote.exec 'sudo test -e /var/lib/snapd/device/fde/marker'
+ remote.exec 'sudo test -e /var/lib/snapd/device/fde/marker'
+ remote.exec 'sudo blkid /dev/disk/by-label/ubuntu-data-enc'
+ MATCH crypto_LUKS
+ echo 'Ensure recovery keys are available'
Ensure recovery keys are available
+ remote.exec 'sudo snap recovery --show-keys'
-----
.
2025-07-31 07:42:35 WARNING: jul310600-372865 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:plain) running late. Current output:
-----
(... 511 lines above ...)
created 1387 directories
created 1669 symlinks
created 4 devices
created 0 fifos
created 0 sockets
created 3 hardlinks
+ echo modified
+ snap pack --filename=core24.snap ./core24
built: core24.snap
+ fakestore make-refreshable --dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir --snap-orig-blob core24.snap.orig --snap-blob ./core24 core24
-----
.
2025-07-31 07:43:10 WARNING: jul310600-372800 (google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-to-installed-kernel) running late. Current output:
-----
(... 37 lines above ...)
.Connection timed out during banner exchange
.Connection timed out during banner exchange
.kex_exchange_identification: read: Connection reset by peer
.
remote.wait-for: reboot completed
++ tests.nested boot-id
+ boot_id=47131785-376f-4210-94b9-14fee9813d0a
+ remote.wait-for reboot 47131785-376f-4210-94b9-14fee9813d0a
remote.wait-for: waiting for reboot
.................
-----
.
2025-07-31 07:43:20 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-validation-sets-downgrade (jul310600-372889) (129/173)...
2025-07-31 07:43:31 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_all (jul310600-372854)...
2025-07-31 07:43:51 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:encrypted (jul310600-372884)...
2025-07-31 07:44:02 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:plain (jul310600-372865)...
2025-07-31 07:44:07 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/build-with-kernel-modules-components:plain (jul310600-372854)...
2025-07-31 07:44:11 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-da-lockout:encrypted (jul310600-372870) (130/173)...
2025-07-31 07:44:15 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-assets-secure:boot (jul310600-372894) (131/173)...
2025-07-31 07:44:35 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system (jul310600-372865)...
2025-07-31 07:44:44 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-update-config:gadget_panic_command_line (jul310600-372884)...
2025-07-31 07:44:47 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-reboot:recover (jul310600-372836) (132/173)...
2025-07-31 07:44:58 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-da-lockout:encrypted (jul310600-372870)...
2025-07-31 07:45:06 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/broken-model:tpm (jul310600-372870)...
2025-07-31 07:46:28 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:secureboot (jul310600-372695) (133/173)...
2025-07-31 07:46:46 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/uc-update-assets-secure:boot (jul310600-372894)...
2025-07-31 07:46:55 WARNING: jul310600-372859 (google-nested:ubuntu-24.04-64:tests/nested/manual/core20-remodel) running late. Current output:
-----
(... 193 lines above ...)
+ remote.wait-for snap-command
remote.wait-for: waiting for snap command

remote.wait-for: snap command ready
+ remote.exec 'sudo snap wait system seed.loaded'
+ remote.exec sudo snap reboot --run
+ MATCH 'Reboot into "run" mode.'
+ remote.wait-for reboot 4b7c2bab-413a-4522-9065-de74d1a183e6
remote.wait-for: waiting for reboot
..kex_exchange_identification: read: Connection reset by peer
-----
.
2025-07-31 07:46:57 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:pre_installed_snaps_json (jul310600-372894)...
2025-07-31 07:47:01 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/build-with-kernel-modules-components:encrypted (jul310600-372880) (134/173)...
2025-07-31 07:47:06 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-validation-sets-downgrade (jul310600-372889)...
2025-07-31 07:47:11 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-remodel (jul310600-372859)...
2025-07-31 07:47:13 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2404 (jul310600-372889)...
2025-07-31 07:47:19 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:BOOTDIR (jul310600-372859)...
2025-07-31 07:48:05 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/remodel-to-installed-kernel (jul310600-372800)...
2025-07-31 07:48:18 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:seeded (jul310600-372800)...
2025-07-31 07:48:21 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:seeded (jul310600-372800) (135/173)...
2025-07-31 07:49:03 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-reboot:recover (jul310600-372836)...
2025-07-31 07:49:07 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/uc20-install-in-initrd:secureboot (jul310600-372695)...
2025-07-31 07:49:12 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-install-device-file-install-ubuntu-save-via-hook (jul310600-372836)...
2025-07-31 07:49:16 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core22-basic:files (jul310600-372695)...
2025-07-31 07:49:46 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-initramfs-time-moves-forward (jul310600-372875) (136/173)...
2025-07-31 07:49:47 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-initramfs-time-moves-forward (jul310600-372875)...
2025-07-31 07:49:55 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/preseed (jul310600-372875)...
2025-07-31 07:50:19 WARNING: jul310600-372844 (google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2404) running late. Current output:
-----
(... 540 lines above ...)
Copying snap assets...
Generating snap metadata...
Generated snap metadata
Reading snap metadata...
Running linters...
Running linter: classic
Running linter: library
Lint OK:
- classic: Snap confinement is set to classic.
Creating snap package...
-----
.
2025-07-31 07:51:03 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/build-with-kernel-modules-components:encrypted (jul310600-372880)...
2025-07-31 07:51:11 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:gadget_panic_remodel_boot_assets (jul310600-372880)...
2025-07-31 07:51:28 WARNING: jul310600-372849 (google-nested:ubuntu-24.04-64:tests/nested/manual/kernel-modules-components:encrypted) running late. Current output:
-----
(... 1036 lines above ...)
active
active
active
active
active
active
active
active
active
active
-----
.
2025-07-31 07:52:29 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/preseed (jul310600-372875) (137/173)...
2025-07-31 07:52:54 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/broken-model:tpm (jul310600-372870) (138/173)...
2025-07-31 07:53:16 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:BOOTDIR (jul310600-372859) (139/173)...
2025-07-31 07:53:23 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:pre_installed_snaps_json (jul310600-372894) (140/173)...
2025-07-31 07:53:43 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/preseed (jul310600-372875)...
2025-07-31 07:53:50 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/refresh-revert-fundamentals:snapd (jul310600-372875)...
2025-07-31 07:53:51 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/refresh-revert-fundamentals:snapd (jul310600-372875) (141/173)...
2025-07-31 07:53:51 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/refresh-revert-fundamentals:snapd (jul310600-372875)...
2025-07-31 07:53:53 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:kernel_reboot_remodel_boot_assets (jul310600-372875)...
2025-07-31 07:53:56 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/broken-model:tpm (jul310600-372870)...
2025-07-31 07:54:04 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetwithoutopinion (jul310600-372870)...
2025-07-31 07:54:07 WARNING: jul310600-372854 (google-nested:ubuntu-24.04-64:tests/nested/manual/build-with-kernel-modules-components:plain) running late. Current output:
-----
(... 979 lines above ...)
active
active
active
active
active
active
active
active
active
SSH connection ready
-----
.
2025-07-31 07:54:28 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-update-config:gadget_panic_command_line (jul310600-372884) (142/173)...
2025-07-31 07:54:35 WARNING: jul310600-372865 (google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system) running late. Current output:
-----
(... 753 lines above ...)
active
active
active
active
active
active
active
active
active
active
-----
.
2025-07-31 07:54:42 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/kernel-modules-components:encrypted (jul310600-372849) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/kernel-modules-components:encrypted '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/build_kernel_with_comps.sh mac80211_hwsim wifi-comp
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : false
++ : 512
++ : 512
+ build_kernel_with_comp mac80211_hwsim wifi-comp
+ mod_name=mac80211_hwsim
+ comp_name=wifi-comp
+ kernel_snap_file=
+ use_provided_kernel=true
+ '[' -z '' ']'
+ use_provided_kernel=false
+ '[' false = false ']'
+ nested_prepare_kernel
+ '[' true = true ']'
+ echo 'Repacking kernel snap'
Repacking kernel snap
+ local kernel_snap output_name snap_id version
+ output_name=pc-kernel.snap
+ snap_id=pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ '[' '!' -f /var/tmp/work-dir/assets/pc-kernel.snap ']'
+ nested_is_core_le 18
+ local VERSION=18
+ os.query is-ubuntu-le 18.04
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ snap download --basename=pc-kernel --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ local epochBumpTime
+ epochBumpTime=
+ '[' -n '' ']'
+ nested_is_core_24_system
+ os.query is-noble
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ uc24_build_initramfs_kernel_snap pc-kernel.snap /var/tmp/work-dir/assets ''
+ local ORIG_SNAP=pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=======/                                                    ]  2486/19159  12%
[===============-                                            ]  4932/19159  25%
[===================\                                        ]  6346/19159  33%
[=========================\                                  ]  8261/19159  43%
[=====================================================|      ] 17263/19159  90%
[===========================================================|] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmp_cid3ovaubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 606743      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:41:51.122976292 +0000
Modify: 2025-07-31 07:41:51.122976292 +0000
Change: 2025-07-31 07:41:51.122976292 +0000
Birth: 2025-07-31 07:41:51.122976292 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ rm -f pc-kernel.snap pc-kernel.assert
++ ls /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ kernel_snap=/var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ chmod 0600 /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets/pc-kernel.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc-kernel.snap /tmp/extra-snaps/pc-kernel.snap
+ '[' false = true ']'
++ tests.nested get extra-snaps-path
+ cp /tmp/extra-snaps/pc-kernel.snap pc-kernel.snap
+ kernel_snap_file=pc-kernel.snap
+ unsquashfs -d kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10367 blocks) to write

[=======|                                                    ]  2449/19160  12%
[================-                                           ]  5486/19160  28%
[===================\                                        ]  6350/19160  33%
[=========================\                                  ]  8127/19160  42%
[==================================================|         ] 16491/19160  86%
[==========================================================/ ] 19089/19160  99%
[===========================================================/] 19160/19160 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ grep name: kernel/meta/snap.yaml
++ awk '{ print $2 }'
+ kernel_name=pc-kernel
++ find kernel/modules/6.8.0-72-generic -maxdepth 0 -printf '%f\n'
+ kern_ver=6.8.0-72-generic
+ comp_ko_dir=wifi-comp/modules/6.8.0-72-generic/kmod/
+ mkdir -p wifi-comp/modules/6.8.0-72-generic/kmod/
+ mkdir -p wifi-comp/meta/
+ cat
++ printf %s mac80211_hwsim
++ sed -r 's/[-_]/[-_]/g'
+ glob_mod_name='mac80211[-_]hwsim'
++ find kernel -name 'mac80211[-_]hwsim.ko*'
+ module_path=kernel/modules/6.8.0-72-generic/kernel/drivers/net/wireless/virtual/mac80211_hwsim.ko.zst
+ cp kernel/modules/6.8.0-72-generic/kernel/drivers/net/wireless/virtual/mac80211_hwsim.ko.zst wifi-comp/modules/6.8.0-72-generic/kmod/
+ snap pack --filename=pc-kernel+wifi-comp.comp wifi-comp
built: pc-kernel+wifi-comp.comp
+ rm kernel/modules/6.8.0-72-generic/kernel/drivers/net/wireless/virtual/mac80211_hwsim.ko.zst
+ mkdir -p kernel/lib
+ ln -s ../modules kernel/lib/modules
+ depmod -b kernel/ 6.8.0-72-generic
+ rm pc-kernel.snap
+ gojq --arg COMP_NAME wifi-comp '.components = {$COMP_NAME:{"type":"kernel-modules"}}' --yaml-input kernel/meta/snap.yaml --yaml-output
+ mv kernel/meta/snap.yaml.new kernel/meta/snap.yaml
+ snap pack --filename=pc-kernel.snap kernel
built: pc-kernel.snap
+ '[' false = false ']'
+ cp pc-kernel.snap /var/tmp/work-dir/assets/pc-kernel.snap
+ rm -r kernel
++ tests.nested get extra-snaps-path
+ cp pc-kernel.snap /tmp/extra-snaps
+ tests.nested build-image core
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
+ local IMAGE_NAME
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/kernel-modules-components
+++ NAME=kernel-modules-components
+++ '[' -n encrypted ']'
+++ NAME=kernel-modules-components_encrypted
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 1 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-kernel-modules-components_encrypted
++ BASE_NAME=ubuntu-core-24-custom-kernel-modules-components_encrypted
++ echo ubuntu-core-24-custom-kernel-modules-components_encrypted.img
+ IMAGE_NAME=ubuntu-core-24-custom-kernel-modules-components_encrypted.img
+ mkdir -p /var/tmp/work-dir/images
+ '[' -f /var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted.img ']'
+ '[' -n '' ']'
+ local UBUNTU_IMAGE=/home/gopath/bin/ubuntu-image
+ os.query is-xenial
+ os.query is-arm
+ '[' true = true ']'
+ nested_prepare_snapd
+ '[' true = true ']'
+ echo 'Repacking snapd snap'
Repacking snapd snap
+ local snap_name output_name snap_id
+ nested_is_core_16_system
+ os.query is-xenial
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename '/var/tmp/work-dir/assets/snapd_*.snap'
+ snap_name='snapd_*.snap'
+ break
+ '[' '!' -f '/var/tmp/work-dir/assets/snapd_*.snap' ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ build_snapd_snap /var/tmp/work-dir/assets
+ local TARGET
+ local snapd_snap_cache
+ TARGET=/var/tmp/work-dir/assets
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap /var/tmp/work-dir/assets/
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename /var/tmp/work-dir/assets/snapd_from_ci.snap
+ snap_name=snapd_from_ci.snap
+ break
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/snapd_from_ci.snap /tmp/extra-snaps/
+ '[' false = true ']'
+ nested_prepare_kernel
+ '[' true = true ']'
+ echo 'Repacking kernel snap'
Repacking kernel snap
+ local kernel_snap output_name snap_id version
+ output_name=pc-kernel.snap
+ snap_id=pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ '[' '!' -f /var/tmp/work-dir/assets/pc-kernel.snap ']'
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc-kernel.snap /tmp/extra-snaps/pc-kernel.snap
+ '[' false = true ']'
+ nested_prepare_gadget
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ local snap_id version gadget_snap
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ snap_id=UqFziVZDHLSyO3TqSWgNBoAdHbLI4dAH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'pc_*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ echo 'Repacking pc snap'
Repacking pc snap
+ local key_name snakeoil_key snakeoil_cert
++ nested_get_snakeoil_key
++ nested_ensure_ovmf
++ '[' -d /var/tmp/work-dir/assets/ovmf ']'
++ '[' -f /var/tmp/work-dir/assets/test-snapd-ovmf.snap ']'
++ snap download --channel=latest/edge test-snapd-ovmf --basename=test-snapd-ovmf --target-directory=/var/tmp/work-dir/assets
++ unsquashfs -d /var/tmp/work-dir/assets/ovmf /var/tmp/work-dir/assets/test-snapd-ovmf.snap
++ os.query is-arm
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.key DB.key
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.crt DB.pem
++ echo DB
+ key_name=DB
+ snakeoil_key=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.key
+ snakeoil_cert=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.pem
+ snap download --basename=pc --channel=24/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ unsquashfs -d pc-gadget pc.snap
Parallel unsquashfs: Using 2 processors
19 inodes (43 blocks) to write

[=================================================================|] 62/62 100%

created 17 files
created 10 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ nested_secboot_sign_gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.pem
+ local GADGET_DIR=pc-gadget
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.pem
+ '[' -f pc-gadget/fb.efi ']'
+ nested_secboot_sign_file pc-gadget/fb.efi /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/fb.efi
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/fb.efi
+ local FILE=pc-gadget/fb.efi
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/fb.efi
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.pem --output pc-gadget/fb.efi pc-gadget/fb.efi
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
Signing Unsigned original image
+ nested_secboot_sign_file pc-gadget/shim.efi.signed /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/shim.efi.signed
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/shim.efi.signed
+ local FILE=pc-gadget/shim.efi.signed
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.pem --output pc-gadget/shim.efi.signed pc-gadget/shim.efi.signed
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ case "${NESTED_UBUNTU_SAVE:-}" in
+ cat
+ local GADGET_EXTRA_CMDLINE=
+ '[' false = true ']'
+ os.query is-arm
+ '[' -n '' ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ '[' false = true ']'
+ snap pack pc-gadget/ /var/tmp/work-dir/assets
built: /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
++ ls /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
+ gadget_snap=/var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap /tmp/extra-snaps/pc.snap
+ rm -f pc.snap pc.assert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/kernel-modules-components/DB.pem
+ '[' false = true ']'
+ nested_prepare_base
+ '[' true = true ']'
+ nested_is_core_16_system
+ os.query is-xenial
+ nested_is_core_18_system
+ os.query is-bionic
+ nested_is_core_20_system
+ os.query is-focal
+ nested_is_core_22_system
+ os.query is-jammy
+ nested_is_core_24_system
+ os.query is-noble
+ snap_name=core24
+ snap_id=dwTAh7MZZ01zyriOZErqd1JynQLiOGvM
+ output_name=core24.snap
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'core24*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ '[' '!' -f /var/tmp/work-dir/assets/core24.snap ']'
+ echo 'Repacking core24 snap'
Repacking core24 snap
+ snap download --channel=edge --basename=core24 core24
Fetching snap "core24"
Fetching assertions for "core24"
Install the snap with:
snap ack core24.assert
snap install core24.snap
+ repack_core_snap_with_tweaks core24.snap new-core24.snap
+ local CORESNAP=core24.snap
+ local TARGET=new-core24.snap
+ local UNPACK_DIR
++ mktemp -d /tmp/core-unpack.XXXXXXXX
+ UNPACK_DIR=/tmp/core-unpack.zNpFBf42
+ unsquashfs -no-progress -f -d /tmp/core-unpack.zNpFBf42 core24.snap
Parallel unsquashfs: Using 2 processors
9250 inodes (8496 blocks) to write


created 7574 files
created 1387 directories
created 1669 symlinks
created 4 devices
created 0 fifos
created 0 sockets
created 3 hardlinks
+ mkdir -p /tmp/core-unpack.zNpFBf42/etc/systemd/journald.conf.d
+ cat
+ mkdir -p /tmp/core-unpack.zNpFBf42/etc/systemd/system/snapd.service.d
+ cat
+ '[' false = true ']'
+ cp /home/gopath/src/github.com/snapcore/snapd/data/completion/bash/complete.sh /tmp/core-unpack.zNpFBf42/usr/lib/snapd/complete.sh
+ snap pack --filename=new-core24.snap /tmp/core-unpack.zNpFBf42
built: new-core24.snap
+ rm -rf /tmp/core-unpack.zNpFBf42
+ rm -f core24.snap core24.assert
+ mv new-core24.snap /var/tmp/work-dir/assets/core24.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/core24.snap /tmp/extra-snaps/core24.snap
+ '[' false = true ']'
+ local NESTED_MODEL
++ nested_get_model
++ '[' -n '' ']'
++ case "$SPREAD_SYSTEM" in
++ echo /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/nested-24-amd64.model
+ NESTED_MODEL=/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/nested-24-amd64.model
+ local EXTRA_SNAPS=
++ nested_get_extra_snaps
++ nested_get_extra_containers snap
++ local SUFFIX=snap
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.snap'
++ echo /tmp/extra-snaps/pc.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/pc-kernel.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/snapd_from_ci.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/core24.snap
++ IFS=
++ read -r mysnap
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap'
++ nested_get_extra_comps
++ nested_get_extra_containers comp
++ local SUFFIX=comp
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.comp'
+ '[' -n '' ']'
+ SNAPPY_FORCE_SAS_URL=
+ export SNAPPY_FORCE_SAS_URL
+ UBUNTU_IMAGE_SNAP_CMD=/usr/bin/snap
+ export UBUNTU_IMAGE_SNAP_CMD
+ '[' -n beta ']'
+ UBUNTU_IMAGE_CHANNEL_ARG='--channel beta'
+ declare -a UBUNTU_IMAGE_PRESEED_ARGS
+ '[' -n '' ']'
+ SNAPD_DEBUG=1
+ /home/gopath/bin/ubuntu-image snap --image-size 10G --validation=enforce /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/nested-24-amd64.model --channel beta '' --output-dir /var/tmp/work-dir/images --sector-size 512 --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap
+ tee /var/tmp/work-dir/logs/ubuntu-image.log
[0] prepare_image
WARNING: "snapd", "pc-kernel", "core24", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
[1] load_gadget_yaml
[2] set_artifact_names
[3] populate_rootfs_contents
[4] generate_disk_info
[5] calculate_rootfs_size
[6] populate_bootfs_contents
[7] populate_prepare_partitions
WARNING: No mkfs configuration found for this series: 16.04. Will fallback on the default one.
[8] make_disk
[9] generate_snap_manifest
Build successful
+ local IMAGE_BASE_NAME
++ nested_get_image_name_base core
++ local TYPE=core
++ local SOURCE=beta
++ local NAME=unset
++ local VERSION
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ '[' unset = unset ']'
+++ basename tests/nested/manual/kernel-modules-components
++ NAME=kernel-modules-components
++ '[' -n encrypted ']'
++ NAME=kernel-modules-components_encrypted
++ '[' true = true ']'
++ SOURCE=custom
+++ nested_get_extra_snaps
+++ nested_get_extra_containers snap
+++ wc -l
+++ local SUFFIX=snap
+++ local EXTRA_SNAPS_PATH
++++ nested_get_extra_snaps_path
++++ echo /tmp/extra-snaps
+++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
+++ '[' -d /tmp/extra-snaps ']'
+++ IFS=
+++ read -r mysnap
++++ find /tmp/extra-snaps -name '*.snap'
+++ echo /tmp/extra-snaps/pc.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/pc-kernel.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/snapd_from_ci.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/core24.snap
+++ IFS=
+++ read -r mysnap
++ '[' 4 '!=' 0 ']'
++ SOURCE=custom
++ echo ubuntu-core-24-custom-kernel-modules-components_encrypted
+ IMAGE_BASE_NAME=ubuntu-core-24-custom-kernel-modules-components_encrypted
+ find /var/tmp/work-dir/images/ -maxdepth 1 -name '*.img'
+ read -r imgname
++ basename /var/tmp/work-dir/images/pc.img .img
+ volname=pc
+ mv /var/tmp/work-dir/images/pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted-pc.img
+ read -r imgname
+ local BOOTVOLUME
+ BOOTVOLUME=pc
+ '[' -e pc-gadget/meta/gadget.yaml ']'
++ gojq --yaml-input --raw-output '.volumes | to_entries[] | .key as $p | .value.structure[] | select(.name == "ubuntu-boot") | $p' pc-gadget/meta/gadget.yaml
+ BOOTVOLUME=pc
+ '[' -z pc ']'
+ ln -s /var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted.img
+ unset SNAPPY_FORCE_SAS_URL
+ unset UBUNTU_IMAGE_SNAP_CMD
+ nested_configure_default_user
+ local IMAGE_NAME
+ local IMAGE_PATH
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/kernel-modules-components
+++ NAME=kernel-modules-components
+++ '[' -n encrypted ']'
+++ NAME=kernel-modules-components_encrypted
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ wc -l
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/snapd_from_ci.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/core24.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 4 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-kernel-modules-components_encrypted
++ BASE_NAME=ubuntu-core-24-custom-kernel-modules-components_encrypted
++ echo ubuntu-core-24-custom-kernel-modules-components_encrypted.img
+ IMAGE_NAME=ubuntu-core-24-custom-kernel-modules-components_encrypted.img
++ realpath /var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted.img
+ IMAGE_PATH=/var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted-pc.img
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ nested_configure_cloud_init_on_core20_vm /var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted-pc.img
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted-pc.img
+ nested_create_cloud_init_uc20_config /var/tmp/work-dir/assets/data.cfg
+ local CONFIG_PATH=/var/tmp/work-dir/assets/data.cfg
+ cat
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted-pc.img /var/tmp/work-dir/assets/data.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted-pc.img
+ local FILE=/var/tmp/work-dir/assets/data.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted-pc.img
+ devloop=/dev/loop1
+ ubuntuSeedDev=/dev/loop1p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop1p2
+ '[' -b /dev/loop1p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.z4qjA4m4fI
+ retry -n 5 --wait 2 mount /dev/loop1p2 /tmp/tmp.z4qjA4m4fI
+ mkdir -p /tmp/tmp.z4qjA4m4fI/data/etc/cloud/cloud.cfg.d/
+ cp -f /var/tmp/work-dir/assets/data.cfg /tmp/tmp.z4qjA4m4fI/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.z4qjA4m4fI
+ losetup -d /dev/loop1
+ cp -v /var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted-pc.img.pristine
'/var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted-pc.img.pristine'
+ exit
+ tests.nested create-vm core
'/var/tmp/work-dir/images/ubuntu-core-24-custom-kernel-modules-components_encrypted-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
'/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.enrolled.fd' -> '/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.current.fd'
error: no matching snaps installed
test-snapd-swtpm (edge) 0.1.0 from Test snaps (test-snaps-canonical) installed
retry: command test -S /var/snap/test-snapd-swtpm/current/swtpm-sock failed with code 1
retry: next attempt in 1.0 second(s) (attempt 1 of 10)
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
Timed out waiting for vm ready. Aborting!
failed to wait for the vm becomes ready to receive connections
-----
.
2025-07-31 07:54:43 Debug output for google-nested:ubuntu-24.04-64:tests/nested/manual/kernel-modules-components:encrypted (jul310600-372849) : saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_kernel-modules-components.debug.log
2025-07-31 07:54:43 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/kernel-modules-components:encrypted (jul310600-372849)...
2025-07-31 07:54:49 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-4k-sector-size:logical (jul310600-372849)...
2025-07-31 07:55:06 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core22-basic:files (jul310600-372695) (143/173)...
2025-07-31 07:55:15 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/build-with-kernel-modules-components:plain (jul310600-372854) (144/173)...
2025-07-31 07:55:27 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-update-config:gadget_panic_command_line (jul310600-372884)...
2025-07-31 07:55:27 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:pre_installed_snaps_json (jul310600-372894)...
2025-07-31 07:55:29 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core22-basic:files (jul310600-372695)...
2025-07-31 07:55:35 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:tested_and_default (jul310600-372884)...
2025-07-31 07:55:35 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetsaysnone (jul310600-372894)...
2025-07-31 07:55:37 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:untested (jul310600-372695)...
2025-07-31 07:56:09 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system (jul310600-372865) (145/173)...
2025-07-31 07:56:12 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-set-efi-boot-vars:BOOTDIR (jul310600-372859)...
2025-07-31 07:56:22 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:gadgetextra (jul310600-372859)...
2025-07-31 07:57:13 WARNING: jul310600-372889 (google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2404) running late. Current output:
-----
(... 960 lines above ...)
2025/07/31 07:56:44.430228 partition.go:98: DEBUG: create partitions on /dev/vda: /dev/vda1 : start=        2048, size=     1536000, type=C12A7328-F81F-11D2-BA4B-00A0C93EC93B, name="EFI System partition"
/dev/vda2 : start=     1538048, size=     1536000, type=0FC63DAF-8483-4772-8E79-3D69D8477DE4, name="ubuntu-boot"
/dev/vda3 : start=     3074048, size=       65536, type=0FC63DAF-8483-4772-8E79-3D69D8477DE4, name="ubuntu-save"
/dev/vda4 : start=     3139584, size=     9443295, type=0FC63DAF-8483-4772-8E79-3D69D8477DE4, name="ubuntu-data"
2025/07/31 07:56:45.002374 main.go:184: created 4 partitions
Change 6 created
2025/07/31 07:56:49.013452 main.go:377: DEBUG: making filesystem in "/dev/vda1"
2025/07/31 07:56:49.524072 main.go:377: DEBUG: making filesystem in "/dev/vda2"
2025/07/31 07:56:49.571879 main.go:377: DEBUG: making filesystem in "/dev/mapper/ubuntu-save"
2025/07/31 07:56:49.624864 main.go:377: DEBUG: making filesystem in "/dev/mapper/ubuntu-data"
-----
.
2025-07-31 07:57:33 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-install-device-file-install-ubuntu-save-via-hook (jul310600-372836) (146/173)...
2025-07-31 07:57:37 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-install-device-file-install-ubuntu-save-via-hook (jul310600-372836)...
2025-07-31 07:57:46 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-above-testkeys-boot:secured (jul310600-372836)...
2025-07-31 07:58:22 WARNING: jul310600-372800 (google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:seeded) running late. Current output:
-----
(... 1968 lines above ...)
snapd.gpio-chardev-setup.target is a disabled or a static unit not running, not starting it.
snapd.snap-repair.service is a disabled or a static unit not running, not starting it.
Processing triggers for dbus (1.14.10-4ubuntu4.1) ...
Processing triggers for man-db (2.12.0-4build2) ...
debconf: unable to initialize frontend: Dialog
debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype
-----
.
2025-07-31 07:58:52 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/build-with-kernel-modules-components:plain (jul310600-372854)...
2025-07-31 07:58:55 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:gadget_panic_remodel_boot_assets (jul310600-372880) (147/173)...
2025-07-31 07:58:57 Preparing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:passphrase_auth (jul310600-372854)...
2025-07-31 07:58:58 Executing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:passphrase_auth (jul310600-372854) (148/173)...
2025-07-31 08:00:19 WARNING: jul310600-372844 (google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2404) running late. Current output:
-----
(... 313 lines above ...)
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
+++ '[' 0 '!=' 0 ']'
+++ echo ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404
++ BASE_NAME=ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404
++ echo ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404.img
+ image_name=ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404.img
+ touch /var/tmp/work-dir/images/ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404.img.configured
+ tests.nested create-vm core --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
-----
.
2025-07-31 08:00:36 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:untested (jul310600-372695) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:untested '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ tests.nested build-image core
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
+ local IMAGE_NAME
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/recovery-system-offline
+++ NAME=recovery-system-offline
+++ '[' -n untested ']'
+++ NAME=recovery-system-offline_untested
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
+++ '[' 0 '!=' 0 ']'
+++ echo ubuntu-core-24-custom-recovery-system-offline_untested
++ BASE_NAME=ubuntu-core-24-custom-recovery-system-offline_untested
++ echo ubuntu-core-24-custom-recovery-system-offline_untested.img
+ IMAGE_NAME=ubuntu-core-24-custom-recovery-system-offline_untested.img
+ mkdir -p /var/tmp/work-dir/images
+ '[' -f /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested.img ']'
+ '[' -n '' ']'
+ local UBUNTU_IMAGE=/home/gopath/bin/ubuntu-image
+ os.query is-xenial
+ os.query is-arm
+ '[' true = true ']'
+ nested_prepare_snapd
+ '[' true = true ']'
+ echo 'Repacking snapd snap'
Repacking snapd snap
+ local snap_name output_name snap_id
+ nested_is_core_16_system
+ os.query is-xenial
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename '/var/tmp/work-dir/assets/snapd_*.snap'
+ snap_name='snapd_*.snap'
+ break
+ '[' '!' -f '/var/tmp/work-dir/assets/snapd_*.snap' ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ build_snapd_snap /var/tmp/work-dir/assets
+ local TARGET
+ local snapd_snap_cache
+ TARGET=/var/tmp/work-dir/assets
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap /var/tmp/work-dir/assets/
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename /var/tmp/work-dir/assets/snapd_from_ci.snap
+ snap_name=snapd_from_ci.snap
+ break
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/snapd_from_ci.snap /tmp/extra-snaps/
+ '[' false = true ']'
+ nested_prepare_kernel
+ '[' true = true ']'
+ echo 'Repacking kernel snap'
Repacking kernel snap
+ local kernel_snap output_name snap_id version
+ output_name=pc-kernel.snap
+ snap_id=pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ '[' '!' -f /var/tmp/work-dir/assets/pc-kernel.snap ']'
+ nested_is_core_le 18
+ local VERSION=18
+ os.query is-ubuntu-le 18.04
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ snap download --basename=pc-kernel --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ local epochBumpTime
+ epochBumpTime=
+ '[' -n '' ']'
+ nested_is_core_24_system
+ os.query is-noble
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ uc24_build_initramfs_kernel_snap pc-kernel.snap /var/tmp/work-dir/assets ''
+ local ORIG_SNAP=pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=======/                                                    ]  2474/19159  12%
[=================-                                          ]  5803/19159  30%
[===================\                                        ]  6344/19159  33%
[=========================\                                  ]  8156/19159  42%
[====================================================|       ] 17095/19159  89%
[===========================================================|] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmpcr9h8y54ubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 605327      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:55:54.251260631 +0000
Modify: 2025-07-31 07:55:54.251260631 +0000
Change: 2025-07-31 07:55:54.251260631 +0000
Birth: 2025-07-31 07:55:54.251260631 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ rm -f pc-kernel.snap pc-kernel.assert
++ ls /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ kernel_snap=/var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ chmod 0600 /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets/pc-kernel.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc-kernel.snap /tmp/extra-snaps/pc-kernel.snap
+ '[' false = true ']'
+ nested_prepare_gadget
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ local snap_id version gadget_snap
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ snap_id=UqFziVZDHLSyO3TqSWgNBoAdHbLI4dAH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'pc_*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ echo 'Repacking pc snap'
Repacking pc snap
+ local key_name snakeoil_key snakeoil_cert
++ nested_get_snakeoil_key
++ nested_ensure_ovmf
++ '[' -d /var/tmp/work-dir/assets/ovmf ']'
++ '[' -f /var/tmp/work-dir/assets/test-snapd-ovmf.snap ']'
++ snap download --channel=latest/edge test-snapd-ovmf --basename=test-snapd-ovmf --target-directory=/var/tmp/work-dir/assets
++ unsquashfs -d /var/tmp/work-dir/assets/ovmf /var/tmp/work-dir/assets/test-snapd-ovmf.snap
++ os.query is-arm
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.key DB.key
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.crt DB.pem
++ echo DB
+ key_name=DB
+ snakeoil_key=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.key
+ snakeoil_cert=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.pem
+ snap download --basename=pc --channel=24/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ unsquashfs -d pc-gadget pc.snap
Parallel unsquashfs: Using 2 processors
19 inodes (43 blocks) to write

[=================================================================|] 62/62 100%

created 17 files
created 10 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ nested_secboot_sign_gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.pem
+ local GADGET_DIR=pc-gadget
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.pem
+ '[' -f pc-gadget/fb.efi ']'
+ nested_secboot_sign_file pc-gadget/fb.efi /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/fb.efi
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/fb.efi
+ local FILE=pc-gadget/fb.efi
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/fb.efi
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.pem --output pc-gadget/fb.efi pc-gadget/fb.efi
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
Signing Unsigned original image
+ nested_secboot_sign_file pc-gadget/shim.efi.signed /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/shim.efi.signed
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/shim.efi.signed
+ local FILE=pc-gadget/shim.efi.signed
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.pem --output pc-gadget/shim.efi.signed pc-gadget/shim.efi.signed
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ case "${NESTED_UBUNTU_SAVE:-}" in
+ cat
+ local GADGET_EXTRA_CMDLINE=
+ '[' false = true ']'
+ os.query is-arm
+ '[' -n '' ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ '[' false = true ']'
+ snap pack pc-gadget/ /var/tmp/work-dir/assets
built: /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
++ ls /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
+ gadget_snap=/var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap /tmp/extra-snaps/pc.snap
+ rm -f pc.snap pc.assert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system-offline/DB.pem
+ '[' false = true ']'
+ nested_prepare_base
+ '[' true = true ']'
+ nested_is_core_16_system
+ os.query is-xenial
+ nested_is_core_18_system
+ os.query is-bionic
+ nested_is_core_20_system
+ os.query is-focal
+ nested_is_core_22_system
+ os.query is-jammy
+ nested_is_core_24_system
+ os.query is-noble
+ snap_name=core24
+ snap_id=dwTAh7MZZ01zyriOZErqd1JynQLiOGvM
+ output_name=core24.snap
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'core24*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ '[' '!' -f /var/tmp/work-dir/assets/core24.snap ']'
+ echo 'Repacking core24 snap'
Repacking core24 snap
+ snap download --channel=edge --basename=core24 core24
Fetching snap "core24"
Fetching assertions for "core24"
Install the snap with:
snap ack core24.assert
snap install core24.snap
+ repack_core_snap_with_tweaks core24.snap new-core24.snap
+ local CORESNAP=core24.snap
+ local TARGET=new-core24.snap
+ local UNPACK_DIR
++ mktemp -d /tmp/core-unpack.XXXXXXXX
+ UNPACK_DIR=/tmp/core-unpack.Zfjfmkyo
+ unsquashfs -no-progress -f -d /tmp/core-unpack.Zfjfmkyo core24.snap
Parallel unsquashfs: Using 2 processors
9250 inodes (8496 blocks) to write


created 7574 files
created 1387 directories
created 1669 symlinks
created 4 devices
created 0 fifos
created 0 sockets
created 3 hardlinks
+ mkdir -p /tmp/core-unpack.Zfjfmkyo/etc/systemd/journald.conf.d
+ cat
+ mkdir -p /tmp/core-unpack.Zfjfmkyo/etc/systemd/system/snapd.service.d
+ cat
+ '[' false = true ']'
+ cp /home/gopath/src/github.com/snapcore/snapd/data/completion/bash/complete.sh /tmp/core-unpack.Zfjfmkyo/usr/lib/snapd/complete.sh
+ snap pack --filename=new-core24.snap /tmp/core-unpack.Zfjfmkyo
built: new-core24.snap
+ rm -rf /tmp/core-unpack.Zfjfmkyo
+ rm -f core24.snap core24.assert
+ mv new-core24.snap /var/tmp/work-dir/assets/core24.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/core24.snap /tmp/extra-snaps/core24.snap
+ '[' false = true ']'
+ local NESTED_MODEL
++ nested_get_model
++ '[' -n '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/test-snapd-recovery-system-pc-{VERSION}.model' ']'
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ echo '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/test-snapd-recovery-system-pc-{VERSION}.model'
++ sed 's/{VERSION}/24/g'
++ return
+ NESTED_MODEL=/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/test-snapd-recovery-system-pc-24.model
+ local EXTRA_SNAPS=
++ nested_get_extra_snaps
++ nested_get_extra_containers snap
++ local SUFFIX=snap
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.snap'
++ echo /tmp/extra-snaps/pc.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/pc-kernel.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/snapd_from_ci.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/core24.snap
++ IFS=
++ read -r mysnap
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap'
++ nested_get_extra_comps
++ nested_get_extra_containers comp
++ local SUFFIX=comp
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.comp'
+ '[' -n '' ']'
+ SNAPPY_FORCE_SAS_URL=
+ export SNAPPY_FORCE_SAS_URL
+ UBUNTU_IMAGE_SNAP_CMD=/usr/bin/snap
+ export UBUNTU_IMAGE_SNAP_CMD
+ '[' -n beta ']'
+ UBUNTU_IMAGE_CHANNEL_ARG='--channel beta'
+ declare -a UBUNTU_IMAGE_PRESEED_ARGS
+ '[' -n '' ']'
+ SNAPD_DEBUG=1
+ tee /var/tmp/work-dir/logs/ubuntu-image.log
+ /home/gopath/bin/ubuntu-image snap --image-size 10G --validation=enforce /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/test-snapd-recovery-system-pc-24.model --channel beta '' --output-dir /var/tmp/work-dir/images --sector-size 512 --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap
[0] prepare_image
WARNING: "snapd", "pc-kernel", "core24", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
[1] load_gadget_yaml
[2] set_artifact_names
[3] populate_rootfs_contents
[4] generate_disk_info
[5] calculate_rootfs_size
[6] populate_bootfs_contents
[7] populate_prepare_partitions
WARNING: No mkfs configuration found for this series: 16.04. Will fallback on the default one.
[8] make_disk
[9] generate_snap_manifest
Build successful
+ local IMAGE_BASE_NAME
++ nested_get_image_name_base core
++ local TYPE=core
++ local SOURCE=beta
++ local NAME=unset
++ local VERSION
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ '[' unset = unset ']'
+++ basename tests/nested/manual/recovery-system-offline
++ NAME=recovery-system-offline
++ '[' -n untested ']'
++ NAME=recovery-system-offline_untested
++ '[' true = true ']'
++ SOURCE=custom
+++ nested_get_extra_snaps
+++ nested_get_extra_containers snap
+++ wc -l
+++ local SUFFIX=snap
+++ local EXTRA_SNAPS_PATH
++++ nested_get_extra_snaps_path
++++ echo /tmp/extra-snaps
+++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
+++ '[' -d /tmp/extra-snaps ']'
+++ IFS=
+++ read -r mysnap
++++ find /tmp/extra-snaps -name '*.snap'
+++ echo /tmp/extra-snaps/pc.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/pc-kernel.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/snapd_from_ci.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/core24.snap
+++ IFS=
+++ read -r mysnap
++ '[' 4 '!=' 0 ']'
++ SOURCE=custom
++ echo ubuntu-core-24-custom-recovery-system-offline_untested
+ IMAGE_BASE_NAME=ubuntu-core-24-custom-recovery-system-offline_untested
+ find /var/tmp/work-dir/images/ -maxdepth 1 -name '*.img'
+ read -r imgname
++ basename /var/tmp/work-dir/images/pc.img .img
+ volname=pc
+ mv /var/tmp/work-dir/images/pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested-pc.img
+ read -r imgname
+ local BOOTVOLUME
+ BOOTVOLUME=pc
+ '[' -e pc-gadget/meta/gadget.yaml ']'
++ gojq --yaml-input --raw-output '.volumes | to_entries[] | .key as $p | .value.structure[] | select(.name == "ubuntu-boot") | $p' pc-gadget/meta/gadget.yaml
+ BOOTVOLUME=pc
+ '[' -z pc ']'
+ ln -s /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested.img
+ unset SNAPPY_FORCE_SAS_URL
+ unset UBUNTU_IMAGE_SNAP_CMD
+ nested_configure_default_user
+ local IMAGE_NAME
+ local IMAGE_PATH
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/recovery-system-offline
+++ NAME=recovery-system-offline
+++ '[' -n untested ']'
+++ NAME=recovery-system-offline_untested
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ wc -l
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/snapd_from_ci.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/core24.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 4 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-recovery-system-offline_untested
++ BASE_NAME=ubuntu-core-24-custom-recovery-system-offline_untested
++ echo ubuntu-core-24-custom-recovery-system-offline_untested.img
+ IMAGE_NAME=ubuntu-core-24-custom-recovery-system-offline_untested.img
++ realpath /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested.img
+ IMAGE_PATH=/var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested-pc.img
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ nested_configure_cloud_init_on_core20_vm /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested-pc.img
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested-pc.img
+ nested_create_cloud_init_uc20_config /var/tmp/work-dir/assets/data.cfg
+ local CONFIG_PATH=/var/tmp/work-dir/assets/data.cfg
+ cat
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested-pc.img /var/tmp/work-dir/assets/data.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested-pc.img
+ local FILE=/var/tmp/work-dir/assets/data.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested-pc.img
+ devloop=/dev/loop1
+ ubuntuSeedDev=/dev/loop1p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop1p2
+ '[' -b /dev/loop1p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.dSErswuT0S
+ retry -n 5 --wait 2 mount /dev/loop1p2 /tmp/tmp.dSErswuT0S
+ mkdir -p /tmp/tmp.dSErswuT0S/data/etc/cloud/cloud.cfg.d/
+ cp -f /var/tmp/work-dir/assets/data.cfg /tmp/tmp.dSErswuT0S/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.dSErswuT0S
+ losetup -d /dev/loop1
+ cp -v /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested-pc.img.pristine
'/var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested-pc.img.pristine'
+ exit
+ tests.nested create-vm core
'/var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system-offline_untested-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
'/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.enrolled.fd' -> '/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.current.fd'
error: no matching snaps installed
test-snapd-swtpm (edge) 0.1.0 from Test snaps (test-snaps-canonical) installed
retry: command test -S /var/snap/test-snapd-swtpm/current/swtpm-sock failed with code 1
retry: next attempt in 1.0 second(s) (attempt 1 of 10)
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
active
active
active
active
active
active
-----
.
2025-07-31 08:00:37 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:untested (jul310600-372695) : serial output saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_recovery-system-offline.serial.log
2025-07-31 08:00:37 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:untested (jul310600-372695)...
##[error]2025-07-31 08:00:37 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:untested (jul310600-372695) : EOF
2025-07-31 08:00:37 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372695)...
##[error]2025-07-31 08:00:37 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372695) : EOF
2025-07-31 08:00:37 Fetching artifacts...
2025-07-31 08:00:37 Cannot copy contents EOF
2025-07-31 08:00:37 Restoring google-nested:ubuntu-24.04-64 (jul310600-372695)...
##[error]2025-07-31 08:00:37 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372695) : EOF
2025-07-31 08:00:37 Discarding google-nested:ubuntu-24.04-64 (jul310600-372695)...
2025-07-31 08:00:37 Error executing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:seeded (jul310600-372800) :
-----
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : false
++ : 512
++ : 512
+ echo 'Expose the needed assertions through the fakestore'
Expose the needed assertions through the fakestore
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/testrootorg-store.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir/asserts
+ export SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ SNAPPY_FORCE_SAS_URL=http://localhost:11028
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ snap download --basename=pc --channel=24/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ snap ack pc.assert
+ cp pc.snap pc.snap.orig
+ unsquashfs -d pc-gadget pc.snap
Parallel unsquashfs: Using 2 processors
19 inodes (43 blocks) to write

[=================================================================|] 62/62 100%

created 17 files
created 10 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ echo 'console=ttyS0 systemd.journald.forward_to_console=1'
+ '[' false = true ']'
+ '[' true '!=' true ']'
+ echo 'Sign the shim binary'
Sign the shim binary
++ tests.nested download snakeoil-key
+ KEY_NAME=DB
+ SNAKEOIL_KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/DB.key
+ SNAKEOIL_CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/DB.pem
+ tests.nested secboot-sign gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/DB.pem
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
signature 1
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
Signing Unsigned original image
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ snap pack --filename=pc.snap pc-gadget/
built: pc.snap
+ snap download --basename=pc-kernel-from-store --channel=24/edge pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel-from-store.assert
snap install pc-kernel-from-store.snap
+ snap ack pc-kernel-from-store.assert
+ kmods_arg=
+ os.query is-ubuntu-ge 24.04
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/build_kernel_with_comps.sh efi_pstore efi-pstore
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : false
++ : 512
++ : 512
+ build_kernel_with_comp efi_pstore efi-pstore
+ mod_name=efi_pstore
+ comp_name=efi-pstore
+ kernel_snap_file=
+ use_provided_kernel=true
+ '[' -z '' ']'
+ use_provided_kernel=false
+ '[' false = false ']'
+ nested_prepare_kernel
+ '[' true = true ']'
+ echo 'Repacking kernel snap'
Repacking kernel snap
+ local kernel_snap output_name snap_id version
+ output_name=pc-kernel.snap
+ snap_id=pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ '[' '!' -f /var/tmp/work-dir/assets/pc-kernel.snap ']'
+ nested_is_core_le 18
+ local VERSION=18
+ os.query is-ubuntu-le 18.04
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ snap download --basename=pc-kernel --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ local epochBumpTime
+ epochBumpTime=
+ '[' -n '' ']'
+ nested_is_core_24_system
+ os.query is-noble
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ uc24_build_initramfs_kernel_snap pc-kernel.snap /var/tmp/work-dir/assets ''
+ local ORIG_SNAP=pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[======/                                                     ]  2178/19159  11%
[=============-                                              ]  4524/19159  23%
[===================\                                        ]  6327/19159  33%
[=========================\                                  ]  8119/19159  42%
[================================================\           ] 15792/19159  82%
[===========================================================|] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmpeqcq2pbyubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 605007      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:49:15.261806595 +0000
Modify: 2025-07-31 07:49:15.261806595 +0000
Change: 2025-07-31 07:49:15.261806595 +0000
Birth: 2025-07-31 07:49:15.261806595 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ rm -f pc-kernel.snap pc-kernel.assert
++ ls /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ kernel_snap=/var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ chmod 0600 /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets/pc-kernel.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc-kernel.snap /tmp/extra-snaps/pc-kernel.snap
+ '[' false = true ']'
++ tests.nested get extra-snaps-path
+ cp /tmp/extra-snaps/pc-kernel.snap pc-kernel.snap
+ kernel_snap_file=pc-kernel.snap
+ unsquashfs -d kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10367 blocks) to write

[=======/                                                    ]  2471/19160  12%
[================-                                           ]  5218/19160  27%
[===================\                                        ]  6351/19160  33%
[=========================\                                  ]  8178/19160  42%
[===================================================|        ] 16844/19160  87%
[===========================================================/] 19160/19160 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ grep name: kernel/meta/snap.yaml
++ awk '{ print $2 }'
+ kernel_name=pc-kernel
++ find kernel/modules/6.8.0-72-generic -maxdepth 0 -printf '%f\n'
+ kern_ver=6.8.0-72-generic
+ comp_ko_dir=efi-pstore/modules/6.8.0-72-generic/kmod/
+ mkdir -p efi-pstore/modules/6.8.0-72-generic/kmod/
+ mkdir -p efi-pstore/meta/
+ cat
++ printf %s efi_pstore
++ sed -r 's/[-_]/[-_]/g'
+ glob_mod_name='efi[-_]pstore'
++ find kernel -name 'efi[-_]pstore.ko*'
+ module_path=kernel/modules/6.8.0-72-generic/kernel/drivers/firmware/efi/efi-pstore.ko.zst
+ cp kernel/modules/6.8.0-72-generic/kernel/drivers/firmware/efi/efi-pstore.ko.zst efi-pstore/modules/6.8.0-72-generic/kmod/
+ snap pack --filename=pc-kernel+efi-pstore.comp efi-pstore
built: pc-kernel+efi-pstore.comp
+ rm kernel/modules/6.8.0-72-generic/kernel/drivers/firmware/efi/efi-pstore.ko.zst
+ mkdir -p kernel/lib
+ ln -s ../modules kernel/lib/modules
+ depmod -b kernel/ 6.8.0-72-generic
+ rm pc-kernel.snap
+ gojq --arg COMP_NAME efi-pstore '.components = {$COMP_NAME:{"type":"kernel-modules"}}' --yaml-input kernel/meta/snap.yaml --yaml-output
+ mv kernel/meta/snap.yaml.new kernel/meta/snap.yaml
+ snap pack --filename=pc-kernel.snap kernel
built: pc-kernel.snap
+ '[' false = false ']'
+ cp pc-kernel.snap /var/tmp/work-dir/assets/pc-kernel.snap
+ rm -r kernel
+ kmods_arg='--kmods-comp pc-kernel+efi-pstore.comp'
+ uc24_build_initramfs_kernel_snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel.snap /var/tmp/work-dir/assets
+ local ORIG_SNAP=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=======/                                                    ]  2525/19159  13%
[==================-                                         ]  6042/19159  31%
[===================\                                        ]  6356/19159  33%
[====================-                                       ]  6519/19159  34%
[=============================-                              ]  9704/19159  50%
[=====================================================|      ] 17481/19159  91%
[===========================================================|] 19159/19159 100%

created 8753 files
created 1389 directories
created 39 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmpoifbs96lubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 605007      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:49:15.261806595 +0000
Modify: 2025-07-31 07:51:10.837149814 +0000
Change: 2025-07-31 07:51:10.837149814 +0000
Birth: 2025-07-31 07:49:15.261806595 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
cpio: kernel/x86/microcode/AuthenticAMD.bin not created: newer or same age version exists
cpio: kernel/x86/microcode/GenuineIntel.bin not created: newer or same age version exists
cpio: init not created: newer or same age version exists
cpio: dev/null not created: newer or same age version exists
cpio: etc/group not created: newer or same age version exists
cpio: etc/gshadow not created: newer or same age version exists
cpio: etc/initrd-release not created: newer or same age version exists
cpio: etc/machine-id not created: newer or same age version exists
cpio: etc/nsswitch.conf not created: newer or same age version exists
cpio: etc/os-release not created: newer or same age version exists
cpio: etc/passwd not created: newer or same age version exists
cpio: etc/plymouth/plymouthd.conf not created: newer or same age version exists
cpio: etc/shadow not created: newer or same age version exists
cpio: etc/sysctl.conf not created: newer or same age version exists
cpio: usr/bin/busctl not created: newer or same age version exists
cpio: usr/bin/busybox not created: newer or same age version exists
cpio: usr/bin/dash not created: newer or same age version exists
cpio: usr/bin/dbus-daemon not created: newer or same age version exists
cpio: usr/bin/hostnamectl not created: newer or same age version exists
cpio: usr/bin/journalctl not created: newer or same age version exists
cpio: usr/bin/kernel-install not created: newer or same age version exists
cpio: usr/bin/kmod not created: newer or same age version exists
cpio: usr/bin/localectl not created: newer or same age version exists
cpio: usr/bin/loginctl not created: newer or same age version exists
cpio: usr/bin/mount not created: newer or same age version exists
cpio: usr/bin/mountpoint not created: newer or same age version exists
cpio: usr/bin/networkctl not created: newer or same age version exists
cpio: usr/bin/partx not created: newer or same age version exists
cpio: usr/bin/plymouth not created: newer or same age version exists
cpio: usr/bin/systemctl not created: newer or same age version exists
cpio: usr/bin/systemd-ac-power not created: newer or same age version exists
cpio: usr/bin/systemd-analyze not created: newer or same age version exists
cpio: usr/bin/systemd-ask-password not created: newer or same age version exists
cpio: usr/bin/systemd-cat not created: newer or same age version exists
cpio: usr/bin/systemd-cgls not created: newer or same age version exists
cpio: usr/bin/systemd-cgtop not created: newer or same age version exists
cpio: usr/bin/systemd-creds not created: newer or same age version exists
cpio: usr/bin/systemd-cryptenroll not created: newer or same age version exists
cpio: usr/bin/systemd-cryptsetup not created: newer or same age version exists
cpio: usr/bin/systemd-delta not created: newer or same age version exists
cpio: usr/bin/systemd-detect-virt not created: newer or same age version exists
cpio: usr/bin/systemd-escape not created: newer or same age version exists
cpio: usr/bin/systemd-firstboot not created: newer or same age version exists
cpio: usr/bin/systemd-hwdb not created: newer or same age version exists
cpio: usr/bin/systemd-id128 not created: newer or same age version exists
cpio: usr/bin/systemd-inhibit not created: newer or same age version exists
cpio: usr/bin/systemd-machine-id-setup not created: newer or same age version exists
cpio: usr/bin/systemd-mount not created: newer or same age version exists
cpio: usr/bin/systemd-notify not created: newer or same age version exists
cpio: usr/bin/systemd-path not created: newer or same age version exists
cpio: usr/bin/systemd-repart not created: newer or same age version exists
cpio: usr/bin/systemd-run not created: newer or same age version exists
cpio: usr/bin/systemd-socket-activate not created: newer or same age version exists
cpio: usr/bin/systemd-stdio-bridge not created: newer or same age version exists
cpio: usr/bin/systemd-sysext not created: newer or same age version exists
cpio: usr/bin/systemd-sysusers not created: newer or same age version exists
cpio: usr/bin/systemd-tmpfiles not created: newer or same age version exists
cpio: usr/bin/systemd-tty-ask-password-agent not created: newer or same age version exists
cpio: usr/bin/tar not created: newer or same age version exists
cpio: usr/bin/timedatectl not created: newer or same age version exists
cpio: usr/bin/udevadm not created: newer or same age version exists
cpio: usr/bin/umount not created: newer or same age version exists
cpio: usr/bin/unsquashfs not created: newer or same age version exists
cpio: usr/bin/varlinkctl not created: newer or same age version exists
cpio: usr/lib/core/extra-paths not created: newer or same age version exists
cpio: usr/lib/firmware/i915/adlp_dmc.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/adlp_dmc_ver2_16.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/adlp_guc_69.0.3.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/adlp_guc_70.1.1.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/adlp_guc_70.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/adls_dmc_ver2_01.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/bxt_dmc_ver1_07.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/bxt_guc_70.1.1.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/bxt_huc_2.0.0.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/cml_guc_70.1.1.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/cml_huc_4.0.0.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/dg1_dmc_ver2_02.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/dg1_guc_70.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/dg1_huc.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/dg2_dmc_ver2_08.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/dg2_guc_70.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/dg2_huc_gsc.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/ehl_guc_70.1.1.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/ehl_huc_9.0.0.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/glk_dmc_ver1_04.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/glk_guc_70.1.1.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/glk_huc_4.0.0.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/icl_dmc_ver1_09.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/icl_guc_70.1.1.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/icl_huc_9.0.0.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/kbl_dmc_ver1_04.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/kbl_guc_70.1.1.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/kbl_huc_4.0.0.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/mtl_dmc.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/mtl_gsc_1.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/mtl_guc_70.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/mtl_huc_gsc.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/rkl_dmc_ver2_03.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/skl_dmc_ver1_27.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/skl_guc_70.1.1.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/skl_huc_2.0.0.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/tgl_dmc_ver2_12.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/tgl_guc_69.0.3.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/tgl_guc_70.1.1.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/tgl_guc_70.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/tgl_huc.bin.zst not created: newer or same age version exists
cpio: usr/lib/firmware/i915/tgl_huc_7.9.3.bin.zst not created: newer or same age version exists
cpio: usr/lib/modprobe.d/fbdev-blacklist.conf not created: newer or same age version exists
cpio: usr/lib/modprobe.d/systemd.conf not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/arch/x86/crypto/aesni-intel.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/arch/x86/crypto/sha256-ssse3.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/crypto/af_alg.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/crypto/algif_skcipher.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/crypto/cryptd.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/crypto/crypto_simd.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/crypto/echainiv.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/acpi/platform_profile.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/acpi/video.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/ata/ahci.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/ata/libahci.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/crypto/padlock-aes.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/firmware/dmi-sysfs.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/firmware/qemu_fw_cfg.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/gpu/drm/display/drm_display_helper.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/gpu/drm/drm_buddy.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/gpu/drm/drm_ttm_helper.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/gpu/drm/drm_vram_helper.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/gpu/drm/i915/i915.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/gpu/drm/tiny/bochs.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/gpu/drm/ttm/ttm.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/gpu/drm/virtio/virtio-gpu.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/amd-sfh-hid/amd_sfh.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-a4tech.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-accutouch.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-alps.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-apple.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-appleir.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-asus.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-aureal.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-axff.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-belkin.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-betopff.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-bigbenff.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-cherry.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-chicony.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-cmedia.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-corsair.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-cougar.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-cp2112.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-creative-sb0540.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-cypress.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-dr.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-elan.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-elecom.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-elo.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-emsff.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-evision.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-ezkey.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-ft260.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-gaff.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-gembird.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-generic.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-gfrm.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-glorious.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-google-hammer.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-google-stadiaff.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-gt683r.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-gyration.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-holtek-kbd.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-holtek-mouse.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-holtekff.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-hyperv.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-icade.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-ite.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-jabra.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-kensington.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-keytouch.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-kye.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-lcpower.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-led.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-lenovo.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-letsketch.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-lg-g15.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-logitech-dj.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-logitech-hidpp.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-logitech.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-macally.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-magicmouse.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-maltron.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-mcp2200.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-mcp2221.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-megaworld.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-mf.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-microsoft.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-monterey.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-multitouch.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-nintendo.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-nti.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-ntrig.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-nvidia-shield.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-ortek.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-penmount.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-petalynx.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-picolcd.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-pl.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-plantronics.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-playstation.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-primax.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-prodikeys.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-pxrc.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-razer.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-redragon.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-retrode.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-rmi.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-roccat-arvo.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-roccat-common.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-roccat-isku.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-roccat-kone.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-roccat-koneplus.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-roccat-konepure.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-roccat-kovaplus.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-roccat-lua.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-roccat-pyra.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-roccat-ryos.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-roccat-savu.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-roccat.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-saitek.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-samsung.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-semitek.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-sensor-custom.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-sensor-hub.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-sigmamicro.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-sjoy.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-sony.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-speedlink.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-steam.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-steelseries.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-sunplus.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-thrustmaster.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-tivo.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-tmff.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-topre.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-topseed.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-twinhan.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-u2fzero.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-uclogic.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-udraw-ps3.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-viewsonic.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-vivaldi-common.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-vivaldi.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-vrc2.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-waltop.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-wiimote.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-xiaomi.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-xinmo.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-zpff.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid-zydacron.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/hid.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/i2c-hid/i2c-hid-acpi.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/i2c-hid/i2c-hid-of.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/i2c-hid/i2c-hid.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/intel-ish-hid/intel-ish-ipc.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/intel-ish-hid/intel-ishtp-hid.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/intel-ish-hid/intel-ishtp-loader.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/intel-ish-hid/intel-ishtp.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/surface-hid/surface_hid.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/surface-hid/surface_hid_core.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/surface-hid/surface_kbd.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/uhid.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/usbhid/usbhid.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/usbhid/usbkbd.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/usbhid/usbmouse.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hid/wacom.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/hv/hv_vmbus.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/i2c/algos/i2c-algo-bit.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/iio/industrialio.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/input/ff-memless.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/input/rmi4/rmi_core.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/input/sparse-keymap.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/leds/led-class-multicolor.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/leds/trigger/ledtrig-audio.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/md/dm-bufio.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/md/dm-crypt.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/md/dm-verity.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/media/cec/core/cec.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/media/common/videobuf2/videobuf2-common.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/media/common/videobuf2/videobuf2-memops.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/media/common/videobuf2/videobuf2-v4l2.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/media/common/videobuf2/videobuf2-vmalloc.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/media/mc/mc.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/media/rc/rc-core.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/media/v4l2-core/videodev.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/message/fusion/mptbase.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/message/fusion/mptscsih.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/message/fusion/mptspi.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/misc/enclosure.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/mmc/core/mmc_block.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/mmc/host/cqhci.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/mmc/host/sdhci-acpi.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/mmc/host/sdhci-pci.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/mmc/host/sdhci.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/net/ethernet/broadcom/genet/genet.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/net/mdio/mdio-bcm-unimac.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/nvme/common/nvme-auth.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/nvme/host/nvme-core.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/nvme/host/nvme.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/pci/controller/vmd.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/platform/surface/aggregator/surface_aggregator.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/platform/x86/asus-wmi.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/platform/x86/wmi.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/power/supply/mt6360_charger.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/regulator/fixed.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/regulator/gpio-regulator.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/scsi/hv_storvsc.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/scsi/megaraid/megaraid_sas.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/scsi/mpt3sas/mpt3sas.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/scsi/raid_class.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/scsi/scsi_transport_fc.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/scsi/scsi_transport_sas.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/scsi/scsi_transport_spi.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/scsi/ses.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/usb/common/ulpi.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/usb/dwc3/dwc3.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/usb/gadget/udc/udc-core.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/usb/host/xhci-pci-renesas.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/usb/host/xhci-pci.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/usb/host/xhci-plat-hcd.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/usb/phy/phy-generic.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/usb/storage/usb-storage.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/video/backlight/lcd.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/virtio/virtio_dma_buf.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/drivers/virtio/virtio_input.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/fs/autofs/autofs4.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/fs/nls/nls_iso8859-1.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/fs/overlayfs/overlay.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/lib/crc-itu-t.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/sound/core/snd-rawmidi.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/sound/core/snd-seq-device.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/sound/core/snd.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/kernel/sound/soundcore.ko.zst not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/modules.builtin not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/modules.builtin.modinfo not created: newer or same age version exists
cpio: usr/lib/modules/6.8.0-72-generic/modules.order not created: newer or same age version exists
cpio: usr/lib/recovery-chooser-trigger-switch-root not created: newer or same age version exists
cpio: usr/lib/snapd/info not created: newer or same age version exists
cpio: usr/lib/snapd/snap-bootstrap not created: newer or same age version exists
cpio: usr/lib/sysctl.d/50-pid-max.conf not created: newer or same age version exists
cpio: usr/lib/systemd/bootchart.conf.d/ubuntu-core.conf not created: newer or same age version exists
cpio: usr/lib/systemd/journald.conf.d/default.conf not created: newer or same age version exists
cpio: usr/lib/systemd/network/73-usb-net-by-mac.link not created: newer or same age version exists
cpio: usr/lib/systemd/network/99-default.link not created: newer or same age version exists
cpio: usr/lib/systemd/system-generators/systemd-cryptsetup-generator not created: newer or same age version exists
cpio: usr/lib/systemd/system-generators/systemd-debug-generator not created: newer or same age version exists
cpio: usr/lib/systemd/system-generators/systemd-fstab-generator not created: newer or same age version exists
cpio: usr/lib/systemd/system-generators/systemd-getty-generator not created: newer or same age version exists
cpio: usr/lib/systemd/system-generators/systemd-hibernate-resume-generator not created: newer or same age version exists
cpio: usr/lib/systemd/system-generators/systemd-integritysetup-generator not created: newer or same age version exists
cpio: usr/lib/systemd/system-generators/systemd-rc-local-generator not created: newer or same age version exists
cpio: usr/lib/systemd/system-generators/systemd-run-generator not created: newer or same age version exists
cpio: usr/lib/systemd/system-generators/systemd-system-update-generator not created: newer or same age version exists
cpio: usr/lib/systemd/system-generators/systemd-sysv-generator not created: newer or same age version exists
cpio: usr/lib/systemd/system-generators/systemd-veritysetup-generator not created: newer or same age version exists
cpio: usr/lib/systemd/system-preset/90-systemd.preset not created: newer or same age version exists
cpio: usr/lib/systemd/system/basic.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/basic.target.wants/snapd.recovery-chooser-trigger.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/blockdev@.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/bluetooth.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/boot-complete.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/console-getty.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/container-getty@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/cryptsetup-pre.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/cryptsetup.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/dbus.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/dbus.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/debug-shell.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/debug-shell.service.d/core-override.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/dev-hugepages.mount not created: newer or same age version exists
cpio: usr/lib/systemd/system/dev-mqueue.mount not created: newer or same age version exists
cpio: usr/lib/systemd/system/emergency-reboot.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/emergency.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/emergency.service.d/core-override.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/emergency.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/emergency.target.wants/emergency-reboot.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/exit.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/factory-reset.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/final.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/first-boot-complete.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/getty-pre.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/getty-static.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/getty.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/getty@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/graphical.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/halt.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/hibernate.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/hybrid-sleep.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-cleanup.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-fs.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-parse-etc.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-root-device.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-root-device.target.requires/snap-initramfs-mounts.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-root-device.target.wants/populate-writable.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-root-fs.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-root-fs.target.wants/sysroot-writable.mount not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-root-fs.target.wants/sysroot.mount not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-switch-root.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-switch-root.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-switch-root.target.wants/plymouth-switch-root.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-switch-root.target.wants/recovery-chooser-trigger-switchroot.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-switch-root.target.wants/snapd.recovery-chooser-trigger.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-switch-root.target.wants/systemd-bootchart-quit.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-udevadm-cleanup-db.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-udevadm-cleanup-db.service.d/override.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd-usr-fs.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/initrd.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/integritysetup-pre.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/integritysetup.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/kexec.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/kmod-static-nodes.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/ldconfig.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/local-fs-pre.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/local-fs.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/machine.slice not created: newer or same age version exists
cpio: usr/lib/systemd/system/modprobe@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/multi-user.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/network-online.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/network-pre.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/network.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/nss-lookup.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/nss-user-lookup.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/paths.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/plymouth-for-classic.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/plymouth-for-core.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/plymouth-start.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/plymouth-start.service.d/core-override.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/plymouth-switch-root.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/populate-writable.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/poweroff.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/printer.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/proc-sys-fs-binfmt_misc.mount not created: newer or same age version exists
cpio: usr/lib/systemd/system/quotaon.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/rc-local.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/rc-local.service.d/debian.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/reboot.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/recovery-chooser-trigger-switchroot.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/remote-cryptsetup.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/remote-fs-pre.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/remote-fs.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/remote-veritysetup.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/rescue.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/rescue.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/rpcbind.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/serial-getty@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/shutdown.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/sigpwr.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/sleep.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/slices.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/smartcard.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/snap-initramfs-mounts.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/snapd.recovery-chooser-trigger.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/snapd.recovery-chooser-trigger.service.d/survive-switch-root.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/sockets.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/soft-reboot.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/sound.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/storage-target-mode.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/suspend-then-hibernate.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/suspend.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/swap.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/sys-fs-fuse-connections.mount not created: newer or same age version exists
cpio: usr/lib/systemd/system/sys-kernel-config.mount not created: newer or same age version exists
cpio: usr/lib/systemd/system/sys-kernel-debug.mount not created: newer or same age version exists
cpio: usr/lib/systemd/system/sys-kernel-tracing.mount not created: newer or same age version exists
cpio: usr/lib/systemd/system/sysinit.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/sysinit.target.wants/plymouth-for-classic.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/sysinit.target.wants/plymouth-for-core.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/sysinit.target.wants/plymouth-start.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/sysinit.target.wants/systemd-bootchart.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/syslog.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/sysroot-writable.mount not created: newer or same age version exists
cpio: usr/lib/systemd/system/system-systemd\x2dcryptsetup.slice not created: newer or same age version exists
cpio: usr/lib/systemd/system/system-systemd\x2dveritysetup.slice not created: newer or same age version exists
cpio: usr/lib/systemd/system/system-update-cleanup.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/system-update-pre.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/system-update.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-backlight@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-battery-check.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-binfmt.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-boot-check-no-failures.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-bootchart-quit.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-bootchart.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-bsod.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-confext.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-exit.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-firstboot.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-fsck-root.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-fsck@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-fsckd.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-fsckd.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-growfs-root.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-growfs@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-halt.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-hibernate-resume.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-hibernate.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-hostnamed.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-hwdb-update.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-hybrid-sleep.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-initctl.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-initctl.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-journal-catalog-update.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-journal-flush.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-journald-audit.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-journald-dev-log.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-journald-varlink@.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-journald.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-journald.service.d/nice.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-journald.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-journald@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-journald@.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-kexec.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-localed.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-localed.service.d/x11-keyboard.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-logind.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-logind.service.d/dbus.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-machine-id-commit.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-modules-load.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-network-generator.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-networkd-wait-online.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-networkd-wait-online@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-networkd.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-networkd.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-pcrextend.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-pcrextend@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-pcrfs-root.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-pcrfs@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-pcrlock-file-system.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-pcrlock-firmware-code.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-pcrlock-firmware-config.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-pcrlock-machine-id.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-pcrlock-make-policy.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-pcrlock-secureboot-authority.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-pcrlock-secureboot-policy.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-pcrmachine.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-poweroff.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-pstore.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-quotacheck.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-random-seed.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-reboot.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-remount-fs.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-repart.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-rfkill.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-rfkill.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-soft-reboot.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-storagetm.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-suspend-then-hibernate.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-suspend.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-sysctl.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-sysext.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-sysext.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-sysext@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-sysupdate-reboot.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-sysupdate-reboot.timer not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-sysupdate.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-sysupdate.timer not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-sysusers.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-time-wait-sync.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-timedated.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-tmpfiles-clean.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-tmpfiles-clean.timer not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-tmpfiles-setup-dev-early.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-tmpfiles-setup-dev.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-tmpfiles-setup.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-udev-settle.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-udev-trigger.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-udevd-control.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-udevd-kernel.socket not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-udevd.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-udevd.service.d/syscall-architecture.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-update-done.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-update-utmp-runlevel.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-update-utmp.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-user-sessions.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/systemd-volatile-root.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/time-set.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/time-sync.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/timers.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/umount.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/usb-gadget.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/user-.slice.d/10-defaults.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/user-runtime-dir@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/user.slice not created: newer or same age version exists
cpio: usr/lib/systemd/system/user@.service not created: newer or same age version exists
cpio: usr/lib/systemd/system/user@.service.d/10-login-barrier.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/user@.service.d/timeout.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/user@0.service.d/10-login-barrier.conf not created: newer or same age version exists
cpio: usr/lib/systemd/system/veritysetup-pre.target not created: newer or same age version exists
cpio: usr/lib/systemd/system/veritysetup.target not created: newer or same age version exists
cpio: usr/lib/systemd/systemd not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-backlight not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-battery-check not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-binfmt not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-boot-check-no-failures not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-bootchart not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-bsod not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-cgroups-agent not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-executor not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-fsck not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-fsckd not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-growfs not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-hibernate-resume not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-hostnamed not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-initctl not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-integritysetup not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-journald not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-localed not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-logind not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-makefs not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-measure not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-modules-load not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-network-generator not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-networkd not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-networkd-wait-online not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-pcrextend not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-pcrlock not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-pstore not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-quotacheck not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-random-seed not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-remount-fs not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-reply-password not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-rfkill not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-shutdown not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-sleep not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-socket-proxyd not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-storagetm not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-sulogin-shell not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-sysctl not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-sysupdate not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-sysv-install not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-time-wait-sync not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-timedated not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-update-done not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-update-utmp not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-user-runtime-dir not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-user-sessions not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-veritysetup not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-volatile-root not created: newer or same age version exists
cpio: usr/lib/systemd/systemd-xdg-autostart-condition not created: newer or same age version exists
cpio: usr/lib/sysusers.d/debian-udev.conf not created: newer or same age version exists
cpio: usr/lib/the-modeenv not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/credstore.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/debian.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/home.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/journal-nocow.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/legacy.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/provision.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/static-nodes-permissions.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/systemd-network.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/systemd-nologin.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/systemd-pstore.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/systemd-tmp.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/systemd.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/tmp.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/var.conf not created: newer or same age version exists
cpio: usr/lib/tmpfiles.d/x11.conf not created: newer or same age version exists
cpio: usr/lib/udev/ata_id not created: newer or same age version exists
cpio: usr/lib/udev/cdrom_id not created: newer or same age version exists
cpio: usr/lib/udev/dmi_memory_id not created: newer or same age version exists
cpio: usr/lib/udev/fido_id not created: newer or same age version exists
cpio: usr/lib/udev/iocost not created: newer or same age version exists
cpio: usr/lib/udev/mtd_probe not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/40-vm-hotadd.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/50-firmware.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/50-udev-default.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/55-dm.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/56-persist-device-mapper.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-autosuspend.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-block.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-cdrom_id.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-dmi-id.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-drm.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-evdev.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-fido-id.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-infiniband.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-input-id.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-persistent-alsa.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-persistent-input.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-persistent-storage-dm.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-persistent-storage-mtd.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-persistent-storage-tape.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-persistent-storage.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-persistent-v4l.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-sensor.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/60-serial.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/61-persistent-storage-android.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/64-btrfs.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/70-camera.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/70-joystick.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/70-memory.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/70-mouse.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/70-power-switch.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/70-touchpad.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/70-uaccess.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/71-power-switch-proliant.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/71-seat.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/73-seat-late.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/73-special-net-names.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/75-net-description.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/75-probe_mtd.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/78-graphics-card.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/78-sound-card.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/80-debian-compat.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/80-drivers.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/80-net-setup-link.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/81-net-dhcp.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/90-iocost.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/90-ubuntu-core-partitions.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/95-dm-notify.rules not created: newer or same age version exists
cpio: usr/lib/udev/rules.d/99-systemd.rules not created: newer or same age version exists
cpio: usr/lib/udev/scsi_id not created: newer or same age version exists
cpio: usr/lib/udev/v4l_id not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libacl.so.1.1.2302 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libapparmor.so.1.17.1 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libargon2.so.1 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libaudit.so.1.0.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libblkid.so.1.1.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libbrotlicommon.so.1.1.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libbrotlidec.so.1.1.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libbz2.so.1.0.4 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libc.so not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libc.so.6 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libcap-ng.so.0.0.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libcap.so.2.66 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libcom_err.so.2.1 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libcrypt.so.1.1.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libcrypto.so.3 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libcryptsetup.so.12.10.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libdbus-1.so.3.32.4 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libdevmapper.so.1.02.1 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libdrm.so.2.4.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libe2p.so.2.3 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libevdev.so.2.3.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libexpat.so.1.9.1 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libext2fs.so.2.4 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libfdisk.so.1.1.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libfreetype.so.6.20.1 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libgcc_s.so.1 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libgcrypt.so.20.4.3 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libgpg-error.so.0.34.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libjson-c.so.5.3.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libkmod.so.2.4.1 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/liblz4.so.1.9.4 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/liblzma.so.5.4.5 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/liblzo2.so.2.0.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libm.so not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libm.so.6 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libmount.so.1.1.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libnss_compat.so.2 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libnss_files.so.2 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libpam.so.0.85.1 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libpcre2-8.so.0.11.2 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libply-splash-core.so.5.0.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libply-splash-graphics.so.5.0.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libply.so.5.0.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libpng16.so.16.43.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libpopt.so.0.0.2 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libreadline.so.8.2 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libseccomp.so.2.5.5 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libselinux.so.1 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libsmartcols.so.1.1.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libsystemd.so.0.38.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libtinfo.so.6.4 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libudev.so.1.7.8 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libuuid.so.1.3.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libxkbcommon.so.0.0.0 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libz.so.1.3 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/libzstd.so.1.5.5 not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/plymouth/label-freetype.so not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/plymouth/renderers/drm.so not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/plymouth/renderers/frame-buffer.so not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/plymouth/script.so not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/plymouth/two-step.so not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/systemd/libsystemd-core-255.so not created: newer or same age version exists
cpio: usr/lib/x86_64-linux-gnu/systemd/libsystemd-shared-255.so not created: newer or same age version exists
cpio: usr/libexec/core/get-arg not created: newer or same age version exists
cpio: usr/libexec/core/get-mode not created: newer or same age version exists
cpio: usr/sbin/cryptsetup not created: newer or same age version exists
cpio: usr/sbin/dmsetup not created: newer or same age version exists
cpio: usr/sbin/e2fsck not created: newer or same age version exists
cpio: usr/sbin/fsck not created: newer or same age version exists
cpio: usr/sbin/fsck.fat not created: newer or same age version exists
cpio: usr/sbin/mke2fs not created: newer or same age version exists
cpio: usr/sbin/mkfs.fat not created: newer or same age version exists
cpio: usr/sbin/plymouthd not created: newer or same age version exists
cpio: usr/sbin/sfdisk not created: newer or same age version exists
cpio: usr/sbin/sulogin not created: newer or same age version exists
cpio: usr/share/dbus-1/system-services/org.freedesktop.systemd1.service not created: newer or same age version exists
cpio: usr/share/dbus-1/system.conf not created: newer or same age version exists
cpio: usr/share/dbus-1/system.d/org.freedesktop.systemd1.conf not created: newer or same age version exists
cpio: usr/share/fonts/Plymouth.ttf not created: newer or same age version exists
cpio: usr/share/libdrm/amdgpu.ids not created: newer or same age version exists
cpio: usr/share/plymouth/classic.defaults not created: newer or same age version exists
cpio: usr/share/plymouth/core.defaults not created: newer or same age version exists
cpio: usr/share/plymouth/themes/bgrt/bgrt.plymouth not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0001.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0002.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0003.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0004.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0005.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0006.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0007.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0008.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0009.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0010.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0011.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0012.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0013.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0014.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0015.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0016.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0017.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0018.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0019.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0020.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0021.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0022.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0023.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0024.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0025.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0026.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0027.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0028.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0029.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0030.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0031.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0032.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0033.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0034.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0035.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/animation-0036.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/bgrt-fallback.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/bullet.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/capslock.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/entry.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/keyboard.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/keymap-render.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/lock.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/spinner.plymouth not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0001.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0002.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0003.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0004.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0005.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0006.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0007.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0008.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0009.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0010.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0011.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0012.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0013.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0014.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0015.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0016.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0017.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0018.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0019.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0020.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0021.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0022.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0023.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0024.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0025.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0026.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0027.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0028.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0029.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber-0030.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/throbber.svg not created: newer or same age version exists
cpio: usr/share/plymouth/themes/spinner/watermark.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-1.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-10.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-11.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-12.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-13.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-14.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-15.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-16.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-17.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-18.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-19.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-2.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-20.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-21.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-22.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-23.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-24.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-25.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-26.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-27.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-28.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-29.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-3.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-30.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-4.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-5.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-6.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-7.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-8.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/throbber-9.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/ubuntu-core.plymouth not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/ubuntu-core.png not created: newer or same age version exists
cpio: usr/share/plymouth/themes/ubuntu-core/ubuntu-core.script not created: newer or same age version exists
cpio: usr/share/polkit-1/rules.d/systemd-networkd.rules not created: newer or same age version exists
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap pc-kernel-repacked.snap
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ gendeveloper1 sign-model
+ truncate --size=6G disk.img
+ '[' false = true ']'
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/setup_nested_hybrid_system.sh --model classic.model --store-dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir --gadget pc.snap --gadget-assertion pc.assert --kernel pc-kernel-repacked.snap --kernel-assertion pc-kernel-from-store.assert --kmods-comp pc-kernel+efi-pstore.comp --disk disk.img
+ main --model classic.model --store-dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir --gadget pc.snap --gadget-assertion pc.assert --kernel pc-kernel-repacked.snap --kernel-assertion pc-kernel-from-store.assert --kmods-comp pc-kernel+efi-pstore.comp --disk disk.img
+ local model_assertion=
+ local store_dir=
+ local gadget_snap=
+ local gadget_assertion=
+ local kernel_snap=
+ local kernel_assertion=
+ local label=classic
+ local disk=
+ local kern_mods_comp=
+ local passphrase=
+ local recovery_key_out=
+ extra_muinstaller_args=()
+ local extra_muinstaller_args
+ '[' 16 -gt 0 ']'
+ case "$1" in
+ model_assertion=classic.model
+ shift 2
+ '[' 14 -gt 0 ']'
+ case "$1" in
+ store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir
+ shift 2
+ '[' 12 -gt 0 ']'
+ case "$1" in
+ gadget_snap=pc.snap
+ shift 2
+ '[' 10 -gt 0 ']'
+ case "$1" in
+ gadget_assertion=pc.assert
+ shift 2
+ '[' 8 -gt 0 ']'
+ case "$1" in
+ kernel_snap=pc-kernel-repacked.snap
+ shift 2
+ '[' 6 -gt 0 ']'
+ case "$1" in
+ kernel_assertion=pc-kernel-from-store.assert
+ shift 2
+ '[' 4 -gt 0 ']'
+ case "$1" in
+ kern_mods_comp=pc-kernel+efi-pstore.comp
+ shift 2
+ '[' 2 -gt 0 ']'
+ case "$1" in
+ disk=disk.img
+ shift 2
+ '[' 0 -gt 0 ']'
+ '[' -z classic.model ']'
+ '[' -n pc-kernel-repacked.snap ']'
+ '[' -z pc-kernel-from-store.assert ']'
+ '[' -n pc-kernel-from-store.assert ']'
+ '[' -z pc-kernel-repacked.snap ']'
+ '[' -n pc.snap ']'
+ '[' -z pc.assert ']'
+ '[' -n pc.assert ']'
+ '[' -z pc.snap ']'
++ realpath classic.model
+ model_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/classic.model
+ '[' -n disk.img ']'
++ realpath disk.img
+ disk=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/disk.img
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir ']'
++ realpath /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir
+ store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir
+ '[' -n pc.snap ']'
++ realpath pc.snap
+ gadget_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc.snap
++ realpath pc.assert
+ gadget_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc.assert
+ '[' -n pc-kernel-repacked.snap ']'
++ realpath pc-kernel-repacked.snap
+ kernel_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel-repacked.snap
++ realpath pc-kernel-from-store.assert
+ kernel_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel-from-store.assert
+ '[' -n pc-kernel+efi-pstore.comp ']'
++ realpath pc-kernel+efi-pstore.comp
+ kern_mods_comp=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel+efi-pstore.comp
++ mktemp -d --tmpdir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real
+ cd /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49
+ '[' -z /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/disk.img ']'
+ '[' -z /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc.snap ']'
+ '[' -z /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel-repacked.snap ']'
+ run_muinstaller /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/classic.model /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc.assert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel-repacked.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel-from-store.assert classic /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/disk.img /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel+efi-pstore.comp '' ''
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : false
++ : 512
++ : 512
+ local model_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/classic.model
+ local store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir
+ local gadget_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc.snap
+ local gadget_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc.assert
+ local kernel_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel-repacked.snap
+ local kernel_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel-from-store.assert
+ local label=classic
+ local disk=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/disk.img
+ local kern_mods_comp=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel+efi-pstore.comp
+ local passphrase=
+ local recovery_key_out=
+ shift 11
+ extra_muinstaller_args=()
+ local extra_muinstaller_args
+ snap ack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel-from-store.assert
+ snap ack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc.assert
+ local key_name
++ nested_get_snakeoil_key
++ nested_ensure_ovmf
++ '[' -d /var/tmp/work-dir/assets/ovmf ']'
++ return
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.key DB.key
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.crt DB.pem
++ echo DB
+ key_name=DB
+ local snakeoil_key=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.key
+ local snakeoil_cert=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.pem
+ unsquashfs -d pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc.snap
Parallel unsquashfs: Using 2 processors
20 inodes (44 blocks) to write

[=================================================================|] 64/64 100%

created 18 files
created 10 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ tests.nested secboot-sign gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.pem
warning: data remaining[73768 vs 87992]: gaps between PE/COFF sections?
signature 1
warning: data remaining[73768 vs 87992]: gaps between PE/COFF sections?
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
Signing Unsigned original image
warning: data remaining[832552 vs 958624]: gaps between PE/COFF sections?
signature 1
warning: data remaining[832552 vs 958624]: gaps between PE/COFF sections?
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ snap pack --filename=pc.snap pc-gadget/
built: pc.snap
+ build_snapd_snap .
+ local TARGET
+ local snapd_snap_cache
+ TARGET=.
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ./
+ mv snapd_from_ci.snap snapd.snap
+ kmodsarg=
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel+efi-pstore.comp ']'
+ kmodsarg='--comp /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel+efi-pstore.comp'
+ snap prepare-image --classic --channel=edge --snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel-repacked.snap --comp /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel+efi-pstore.comp --snap pc.snap --snap snapd.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/classic.model ./classic-seed
Fetching core24 (1151)
WARNING: "snapd", "pc-kernel", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
Copying "snapd.snap" (snapd)
Copying "/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel-repacked.snap" (pc-kernel)
Copying "/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/pc-kernel+efi-pstore.comp" (pc-kernel+efi-pstore)
Copying "pc.snap" (pc)
+ mv ./classic-seed/system-seed/systems/20250731 ./classic-seed/system-seed/systems/classic
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir ']'
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state teardown-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/fake-store-blobdir
Failed to reset failed state of unit fakestore.service: Unit fakestore.service not loaded.
++ command -v snapcraft
+ '[' -z '' ']'
+ snap install snapcraft --candidate --classic
snapcraft (candidate) 8.10.2 from Canonical** installed
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/lxd-state prepare-snap
lxd-state: installing lxd snap
lxd (candidate) 6.4-25e10d4 from Canonical** installed
dpkg-query: no packages found matching lxd-client
lxd-state: initializing lxd
lxd-state: setting up proxy for lxc
To start your first container, try: lxc launch ubuntu:24.04
Or for a virtual machine: lxc launch ubuntu:24.04 --vm

+ cd /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller
+ snapcraft
Launching instance...
Creating new instance from remote
Creating new base instance from remote
Creating new instance from base instance
Starting instance
Initializing parts lifecycle
Installing build-packages
Installing build-snaps
Pulling muinstaller
Building muinstaller
:: + snapcraftctl build
:: Warning: use 'craftctl default' to execute the default step handler
:: + go mod download all
:: + go install -p 2 ./...
::
:: Users are encouraged to replace 'snapcraftctl' with 'craftctl' and use
:: 'CRAFT_*' environment variables in scriptlets when building snaps based
:: on core22. Please refer to the core22 migration guide for details.
:: + cp -a mk-classic-rootfs.sh /root/parts/muinstaller/install/bin
Staging muinstaller
Priming muinstaller
Extracting and updating metadata...
Copying snap assets...
Generating snap metadata...
Generated snap metadata
Reading snap metadata...
Running linters...
Running linter: classic
Running linter: library
Lint OK:
- classic: Snap confinement is set to classic.
Creating snap package...
Created snap package muinstaller_0.1_amd64.snap
+ local muinstaller_snap
++ find /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/ -maxdepth 1 -name '*.snap'
+ muinstaller_snap=/home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
+ tests.nested build-image classic
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
Dload  Upload   Total   Spent    Left  Speed
0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  8  585M    8 47.2M    0     0   148M      0  0:00:03 --:--:--  0:00:03  148M
 50  585M   50  296M    0     0   224M      0  0:00:02  0:00:01  0:00:01  224M
 91  585M   91  535M    0     0   230M      0  0:00:02  0:00:02 --:--:--  231M
100  585M  100  585M    0     0   230M      0  0:00:02  0:00:02 --:--:--  230M
Image doesn't need to be decompressed
'/var/tmp/work-dir/images/ubuntu-classic-24-custom-muinstaller-real_seeded.img' -> '/var/tmp/work-dir/images/ubuntu-classic-24-custom-muinstaller-real_seeded.img.pristine'
+ NESTED_PARAM_EXTRA='-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
+ tests.nested create-vm classic --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
Image resized.
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
grep: /var/tmp/work-dir/logs/serial.log: No such file or directory
/home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh: line 84: test: : integer expression expected
grep: /var/tmp/work-dir/logs/serial.log: No such file or directory
/home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh: line 85: test: : integer expression expected
active
active
active
active
SSH connection ready
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
PATH=/writable/test-tools:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
[Service]
Environment=SNAPD_DEBUG=1 SNAPPY_TESTING=1 SNAPD_TRACE=1 SNAPD_JSON_LOGGING=1
SNAPD_DEBUG=1
SNAPD_TRACE=1
SNAPD_JSON_LOGGING=1
SNAP_LOG_TO_JOURNAL=1
+ for s in BOOT/BOOTX64.EFI ubuntu/shimx64.efi
+ remote.exec 'sudo cp -a /boot/efi/EFI/BOOT/BOOTX64.EFI /tmp'
++ basename BOOT/BOOTX64.EFI
+ remote.exec 'sudo chmod 755 /tmp/BOOTX64.EFI'
++ basename BOOT/BOOTX64.EFI
+ remote.pull /tmp/BOOTX64.EFI .
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename BOOT/BOOTX64.EFI
+ nested_secboot_sign_file BOOTX64.EFI /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=BOOTX64.EFI
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature BOOTX64.EFI
+ local FILE=BOOTX64.EFI
+ sbverify --list BOOTX64.EFI
+ grep '^signature [0-9]*$'
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove BOOTX64.EFI
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
+ sbverify --list BOOTX64.EFI
+ grep '^signature [0-9]*$'
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.pem --output BOOTX64.EFI BOOTX64.EFI
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
++ basename BOOT/BOOTX64.EFI
+ remote.push BOOTX64.EFI
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename BOOT/BOOTX64.EFI
+ remote.exec 'sudo mv BOOTX64.EFI /boot/efi/EFI/BOOT/BOOTX64.EFI'
mv: failed to preserve ownership for '/boot/efi/EFI/BOOT/BOOTX64.EFI': Operation not permitted
+ for s in BOOT/BOOTX64.EFI ubuntu/shimx64.efi
+ remote.exec 'sudo cp -a /boot/efi/EFI/ubuntu/shimx64.efi /tmp'
++ basename ubuntu/shimx64.efi
+ remote.exec 'sudo chmod 755 /tmp/shimx64.efi'
++ basename ubuntu/shimx64.efi
+ remote.pull /tmp/shimx64.efi .
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename ubuntu/shimx64.efi
+ nested_secboot_sign_file shimx64.efi /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=shimx64.efi
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature shimx64.efi
+ local FILE=shimx64.efi
+ grep '^signature [0-9]*$'
+ sbverify --list shimx64.efi
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove shimx64.efi
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
+ sbverify --list shimx64.efi
+ grep '^signature [0-9]*$'
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-real/tmp.saNAhioQ49/DB.pem --output shimx64.efi shimx64.efi
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
++ basename ubuntu/shimx64.efi
+ remote.push shimx64.efi
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename ubuntu/shimx64.efi
+ remote.exec 'sudo mv shimx64.efi /boot/efi/EFI/ubuntu/shimx64.efi'
mv: failed to preserve ownership for '/boot/efi/EFI/ubuntu/shimx64.efi': Operation not permitted
+ remote.exec 'sudo sh -c '\''echo SNAPD_DEBUG=1 >> /etc/environment'\'''
+ remote.push /home/gopath/snapd_1337.2.70_amd64.deb
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
+ remote.exec 'sudo mv snapd_*.deb /var/lib/snapd/'
+ remote.exec 'sudo apt install -y /var/lib/snapd/snapd_*.deb'

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Reading state information...
Suggested packages:
zenity | kdialog
The following packages will be upgraded:
snapd
1 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Need to get 0 B/34.2 MB of archives.
After this operation, 11.4 MB of additional disk space will be used.
Get:1 /var/lib/snapd/snapd_1337.2.70_amd64.deb snapd amd64 1337.2.70 [34.2 MB]
debconf: unable to initialize frontend: Dialog
debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype
dpkg-preconfigure: unable to re-open stdin:
(Reading database ... 
(Reading database ... 5%
(Reading database ... 10%
(Reading database ... 15%
(Reading database ... 20%
(Reading database ... 25%
(Reading database ... 30%
(Reading database ... 35%
(Reading database ... 40%
(Reading database ... 45%
(Reading database ... 50%
(Reading database ... 55%
(Reading database ... 60%
(Reading database ... 65%
(Reading database ... 70%
(Reading database ... 75%
(Reading database ... 80%
(Reading database ... 85%
(Reading database ... 90%
(Reading database ... 95%
(Reading database ... 100%
(Reading database ... 74795 files and directories currently installed.)
Preparing to unpack .../snapd_1337.2.70_amd64.deb ...
Unpacking snapd (1337.2.70) over (2.67.1+24.04) ...
Setting up snapd (1337.2.70) ...
Installing new version of config file /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
snapd.failure.service is a disabled or a static unit not running, not starting it.
snapd.gpio-chardev-setup.target is a disabled or a static unit not running, not starting it.
snapd.snap-repair.service is a disabled or a static unit not running, not starting it.
Processing triggers for dbus (1.14.10-4ubuntu4.1) ...
Processing triggers for man-db (2.12.0-4build2) ...
debconf: unable to initialize frontend: Dialog
debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
+ sshpass -p ubuntu scp -r -P 8022 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no ./classic-seed/system-seed/ 'user1@localhost:~/install-seed'
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
+ remote.exec 'sudo mv /home/user1/install-seed /var/lib/snapd/'
+ tests.nested vm stop
+ sync
++ nested_get_image_name classic
++ local BASE_NAME
+++ nested_get_image_name_base classic
+++ local TYPE=classic
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/muinstaller-real
+++ NAME=muinstaller-real
+++ '[' -n seeded ']'
+++ NAME=muinstaller-real_seeded
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 1 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-classic-24-custom-muinstaller-real_seeded
++ BASE_NAME=ubuntu-classic-24-custom-muinstaller-real_seeded
++ echo ubuntu-classic-24-custom-muinstaller-real_seeded.img
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/muinstaller-real
+++ NAME=muinstaller-real
+++ '[' -n seeded ']'
+++ NAME=muinstaller-real_seeded
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 1 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-muinstaller-real_seeded
++ BASE_NAME=ubuntu-core-24-custom-muinstaller-real_seeded
++ echo ubuntu-core-24-custom-muinstaller-real_seeded.img
+ qemu-img convert -f qcow2 -O raw /var/tmp/work-dir/images/ubuntu-classic-24-custom-muinstaller-real_seeded.img /var/tmp/work-dir/images/ubuntu-core-24-custom-muinstaller-real_seeded.img
-----
.
2025-07-31 08:00:38 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:seeded (jul310600-372800) : serial output saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_muinstaller-real.serial.log
2025-07-31 08:00:38 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:seeded (jul310600-372800)...
##[error]2025-07-31 08:00:38 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:seeded (jul310600-372800) : EOF
2025-07-31 08:00:38 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372800)...
##[error]2025-07-31 08:00:38 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372800) : EOF
2025-07-31 08:00:38 Fetching artifacts...
2025-07-31 08:00:38 Cannot copy contents EOF
2025-07-31 08:00:38 Restoring google-nested:ubuntu-24.04-64 (jul310600-372800)...
##[error]2025-07-31 08:00:38 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372800) : EOF
2025-07-31 08:00:38 Discarding google-nested:ubuntu-24.04-64 (jul310600-372800)...
2025-07-31 08:00:38 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-4k-sector-size:logical (jul310600-372849) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/core20-4k-sector-size:logical '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ tests.nested build-image core
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
+ local IMAGE_NAME
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/core20-4k-sector-size
+++ NAME=core20-4k-sector-size
+++ '[' -n logical ']'
+++ NAME=core20-4k-sector-size_logical
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
+++ '[' 0 '!=' 0 ']'
+++ echo ubuntu-core-24-custom-core20-4k-sector-size_logical
++ BASE_NAME=ubuntu-core-24-custom-core20-4k-sector-size_logical
++ echo ubuntu-core-24-custom-core20-4k-sector-size_logical.img
+ IMAGE_NAME=ubuntu-core-24-custom-core20-4k-sector-size_logical.img
+ mkdir -p /var/tmp/work-dir/images
+ '[' -f /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical.img ']'
+ '[' -n '' ']'
+ local UBUNTU_IMAGE=/home/gopath/bin/ubuntu-image
+ os.query is-xenial
+ os.query is-arm
+ '[' true = true ']'
+ nested_prepare_snapd
+ '[' true = true ']'
+ echo 'Repacking snapd snap'
Repacking snapd snap
+ local snap_name output_name snap_id
+ nested_is_core_16_system
+ os.query is-xenial
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename '/var/tmp/work-dir/assets/snapd_*.snap'
+ snap_name='snapd_*.snap'
+ break
+ '[' '!' -f '/var/tmp/work-dir/assets/snapd_*.snap' ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ build_snapd_snap /var/tmp/work-dir/assets
+ local TARGET
+ local snapd_snap_cache
+ TARGET=/var/tmp/work-dir/assets
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap /var/tmp/work-dir/assets/
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename /var/tmp/work-dir/assets/snapd_from_ci.snap
+ snap_name=snapd_from_ci.snap
+ break
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/snapd_from_ci.snap /tmp/extra-snaps/
+ '[' false = true ']'
+ nested_prepare_kernel
+ '[' true = true ']'
+ echo 'Repacking kernel snap'
Repacking kernel snap
+ local kernel_snap output_name snap_id version
+ output_name=pc-kernel.snap
+ snap_id=pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ '[' '!' -f /var/tmp/work-dir/assets/pc-kernel.snap ']'
+ nested_is_core_le 18
+ local VERSION=18
+ os.query is-ubuntu-le 18.04
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ snap download --basename=pc-kernel --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ local epochBumpTime
+ epochBumpTime=
+ '[' -n '' ']'
+ nested_is_core_24_system
+ os.query is-noble
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ uc24_build_initramfs_kernel_snap pc-kernel.snap /var/tmp/work-dir/assets ''
+ local ORIG_SNAP=pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=======/                                                    ]  2499/19159  13%
[==================/                                         ]  6003/19159  31%
[===================\                                        ]  6346/19159  33%
[=========================\                                  ]  8296/19159  43%
[=====================================================|      ] 17429/19159  90%
[===========================================================|] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmpo73u2ksyubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 606730      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:55:12.723838345 +0000
Modify: 2025-07-31 07:55:12.723838345 +0000
Change: 2025-07-31 07:55:12.723838345 +0000
Birth: 2025-07-31 07:55:12.723838345 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ rm -f pc-kernel.snap pc-kernel.assert
++ ls /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ kernel_snap=/var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ chmod 0600 /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets/pc-kernel.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc-kernel.snap /tmp/extra-snaps/pc-kernel.snap
+ '[' false = true ']'
+ nested_prepare_gadget
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ local snap_id version gadget_snap
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ snap_id=UqFziVZDHLSyO3TqSWgNBoAdHbLI4dAH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'pc_*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ echo 'Repacking pc snap'
Repacking pc snap
+ local key_name snakeoil_key snakeoil_cert
++ nested_get_snakeoil_key
++ nested_ensure_ovmf
++ '[' -d /var/tmp/work-dir/assets/ovmf ']'
++ '[' -f /var/tmp/work-dir/assets/test-snapd-ovmf.snap ']'
++ snap download --channel=latest/edge test-snapd-ovmf --basename=test-snapd-ovmf --target-directory=/var/tmp/work-dir/assets
++ unsquashfs -d /var/tmp/work-dir/assets/ovmf /var/tmp/work-dir/assets/test-snapd-ovmf.snap
++ os.query is-arm
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.key DB.key
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.crt DB.pem
++ echo DB
+ key_name=DB
+ snakeoil_key=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.key
+ snakeoil_cert=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.pem
+ snap download --basename=pc --channel=24/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ unsquashfs -d pc-gadget pc.snap
Parallel unsquashfs: Using 2 processors
19 inodes (43 blocks) to write

[=================================================================|] 62/62 100%

created 17 files
created 10 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ nested_secboot_sign_gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.pem
+ local GADGET_DIR=pc-gadget
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.pem
+ '[' -f pc-gadget/fb.efi ']'
+ nested_secboot_sign_file pc-gadget/fb.efi /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/fb.efi
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/fb.efi
+ local FILE=pc-gadget/fb.efi
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/fb.efi
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.pem --output pc-gadget/fb.efi pc-gadget/fb.efi
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
Signing Unsigned original image
+ nested_secboot_sign_file pc-gadget/shim.efi.signed /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/shim.efi.signed
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/shim.efi.signed
+ local FILE=pc-gadget/shim.efi.signed
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.pem --output pc-gadget/shim.efi.signed pc-gadget/shim.efi.signed
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ case "${NESTED_UBUNTU_SAVE:-}" in
+ cat
+ local GADGET_EXTRA_CMDLINE=
+ '[' false = true ']'
+ os.query is-arm
+ '[' -n '' ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ '[' false = true ']'
+ snap pack pc-gadget/ /var/tmp/work-dir/assets
built: /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
++ ls /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
+ gadget_snap=/var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap /tmp/extra-snaps/pc.snap
+ rm -f pc.snap pc.assert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-4k-sector-size/DB.pem
+ '[' false = true ']'
+ nested_prepare_base
+ '[' true = true ']'
+ nested_is_core_16_system
+ os.query is-xenial
+ nested_is_core_18_system
+ os.query is-bionic
+ nested_is_core_20_system
+ os.query is-focal
+ nested_is_core_22_system
+ os.query is-jammy
+ nested_is_core_24_system
+ os.query is-noble
+ snap_name=core24
+ snap_id=dwTAh7MZZ01zyriOZErqd1JynQLiOGvM
+ output_name=core24.snap
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'core24*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ '[' '!' -f /var/tmp/work-dir/assets/core24.snap ']'
+ echo 'Repacking core24 snap'
Repacking core24 snap
+ snap download --channel=edge --basename=core24 core24
Fetching snap "core24"
Fetching assertions for "core24"
Install the snap with:
snap ack core24.assert
snap install core24.snap
+ repack_core_snap_with_tweaks core24.snap new-core24.snap
+ local CORESNAP=core24.snap
+ local TARGET=new-core24.snap
+ local UNPACK_DIR
++ mktemp -d /tmp/core-unpack.XXXXXXXX
+ UNPACK_DIR=/tmp/core-unpack.frySXU4V
+ unsquashfs -no-progress -f -d /tmp/core-unpack.frySXU4V core24.snap
Parallel unsquashfs: Using 2 processors
9250 inodes (8496 blocks) to write


created 7574 files
created 1387 directories
created 1669 symlinks
created 4 devices
created 0 fifos
created 0 sockets
created 3 hardlinks
+ mkdir -p /tmp/core-unpack.frySXU4V/etc/systemd/journald.conf.d
+ cat
+ mkdir -p /tmp/core-unpack.frySXU4V/etc/systemd/system/snapd.service.d
+ cat
+ '[' false = true ']'
+ cp /home/gopath/src/github.com/snapcore/snapd/data/completion/bash/complete.sh /tmp/core-unpack.frySXU4V/usr/lib/snapd/complete.sh
+ snap pack --filename=new-core24.snap /tmp/core-unpack.frySXU4V
built: new-core24.snap
+ rm -rf /tmp/core-unpack.frySXU4V
+ rm -f core24.snap core24.assert
+ mv new-core24.snap /var/tmp/work-dir/assets/core24.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/core24.snap /tmp/extra-snaps/core24.snap
+ '[' false = true ']'
+ local NESTED_MODEL
++ nested_get_model
++ '[' -n '' ']'
++ case "$SPREAD_SYSTEM" in
++ echo /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/nested-24-amd64.model
+ NESTED_MODEL=/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/nested-24-amd64.model
+ local EXTRA_SNAPS=
++ nested_get_extra_snaps
++ nested_get_extra_containers snap
++ local SUFFIX=snap
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.snap'
++ echo /tmp/extra-snaps/pc.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/pc-kernel.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/snapd_from_ci.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/core24.snap
++ IFS=
++ read -r mysnap
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap'
++ nested_get_extra_comps
++ nested_get_extra_containers comp
++ local SUFFIX=comp
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.comp'
+ '[' -n '' ']'
+ SNAPPY_FORCE_SAS_URL=
+ export SNAPPY_FORCE_SAS_URL
+ UBUNTU_IMAGE_SNAP_CMD=/usr/bin/snap
+ export UBUNTU_IMAGE_SNAP_CMD
+ '[' -n beta ']'
+ UBUNTU_IMAGE_CHANNEL_ARG='--channel beta'
+ declare -a UBUNTU_IMAGE_PRESEED_ARGS
+ '[' -n '' ']'
+ SNAPD_DEBUG=1
+ /home/gopath/bin/ubuntu-image snap --image-size 10G --validation=enforce /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/nested-24-amd64.model --channel beta '' --output-dir /var/tmp/work-dir/images --sector-size 4096 --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap
+ tee /var/tmp/work-dir/logs/ubuntu-image.log
[0] prepare_image
WARNING: "snapd", "pc-kernel", "core24", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
[1] load_gadget_yaml
[2] set_artifact_names
[3] populate_rootfs_contents
[4] generate_disk_info
[5] calculate_rootfs_size
[6] populate_bootfs_contents
[7] populate_prepare_partitions
WARNING: No mkfs configuration found for this series: 16.04. Will fallback on the default one.
[8] make_disk
[9] generate_snap_manifest
Build successful
+ local IMAGE_BASE_NAME
++ nested_get_image_name_base core
++ local TYPE=core
++ local SOURCE=beta
++ local NAME=unset
++ local VERSION
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ '[' unset = unset ']'
+++ basename tests/nested/manual/core20-4k-sector-size
++ NAME=core20-4k-sector-size
++ '[' -n logical ']'
++ NAME=core20-4k-sector-size_logical
++ '[' true = true ']'
++ SOURCE=custom
+++ nested_get_extra_snaps
+++ nested_get_extra_containers snap
+++ wc -l
+++ local SUFFIX=snap
+++ local EXTRA_SNAPS_PATH
++++ nested_get_extra_snaps_path
++++ echo /tmp/extra-snaps
+++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
+++ '[' -d /tmp/extra-snaps ']'
+++ IFS=
+++ read -r mysnap
++++ find /tmp/extra-snaps -name '*.snap'
+++ echo /tmp/extra-snaps/pc.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/pc-kernel.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/snapd_from_ci.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/core24.snap
+++ IFS=
+++ read -r mysnap
++ '[' 4 '!=' 0 ']'
++ SOURCE=custom
++ echo ubuntu-core-24-custom-core20-4k-sector-size_logical
+ IMAGE_BASE_NAME=ubuntu-core-24-custom-core20-4k-sector-size_logical
+ find /var/tmp/work-dir/images/ -maxdepth 1 -name '*.img'
+ read -r imgname
++ basename /var/tmp/work-dir/images/pc.img .img
+ volname=pc
+ mv /var/tmp/work-dir/images/pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical-pc.img
+ read -r imgname
+ local BOOTVOLUME
+ BOOTVOLUME=pc
+ '[' -e pc-gadget/meta/gadget.yaml ']'
++ gojq --yaml-input --raw-output '.volumes | to_entries[] | .key as $p | .value.structure[] | select(.name == "ubuntu-boot") | $p' pc-gadget/meta/gadget.yaml
+ BOOTVOLUME=pc
+ '[' -z pc ']'
+ ln -s /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical.img
+ unset SNAPPY_FORCE_SAS_URL
+ unset UBUNTU_IMAGE_SNAP_CMD
+ nested_configure_default_user
+ local IMAGE_NAME
+ local IMAGE_PATH
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/core20-4k-sector-size
+++ NAME=core20-4k-sector-size
+++ '[' -n logical ']'
+++ NAME=core20-4k-sector-size_logical
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ wc -l
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/snapd_from_ci.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/core24.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 4 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-core20-4k-sector-size_logical
++ BASE_NAME=ubuntu-core-24-custom-core20-4k-sector-size_logical
++ echo ubuntu-core-24-custom-core20-4k-sector-size_logical.img
+ IMAGE_NAME=ubuntu-core-24-custom-core20-4k-sector-size_logical.img
++ realpath /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical.img
+ IMAGE_PATH=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical-pc.img
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ nested_configure_cloud_init_on_core20_vm /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical-pc.img
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical-pc.img
+ nested_create_cloud_init_uc20_config /var/tmp/work-dir/assets/data.cfg
+ local CONFIG_PATH=/var/tmp/work-dir/assets/data.cfg
+ cat
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical-pc.img /var/tmp/work-dir/assets/data.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical-pc.img
+ local FILE=/var/tmp/work-dir/assets/data.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 4096 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical-pc.img
+ devloop=/dev/loop1
+ ubuntuSeedDev=/dev/loop1p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop1p2
+ '[' -b /dev/loop1p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.0E7dy3kKtM
+ retry -n 5 --wait 2 mount /dev/loop1p2 /tmp/tmp.0E7dy3kKtM
+ mkdir -p /tmp/tmp.0E7dy3kKtM/data/etc/cloud/cloud.cfg.d/
+ cp -f /var/tmp/work-dir/assets/data.cfg /tmp/tmp.0E7dy3kKtM/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.0E7dy3kKtM
+ losetup -d /dev/loop1
+ cp -v /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical-pc.img.pristine
'/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical-pc.img.pristine'
+ exit
+ tests.nested create-vm core
'/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-4k-sector-size_logical-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
'/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.enrolled.fd' -> '/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.current.fd'
error: no matching snaps installed
test-snapd-swtpm (edge) 0.1.0 from Test snaps (test-snaps-canonical) installed
retry: command test -S /var/snap/test-snapd-swtpm/current/swtpm-sock failed with code 1
retry: next attempt in 1.0 second(s) (attempt 1 of 10)
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
active
-----
.
2025-07-31 08:00:39 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/core20-4k-sector-size:logical (jul310600-372849) : serial output saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_core20-4k-sector-size.serial.log
2025-07-31 08:00:39 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-4k-sector-size:logical (jul310600-372849)...
##[error]2025-07-31 08:00:39 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-4k-sector-size:logical (jul310600-372849) : EOF
2025-07-31 08:00:39 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372849)...
##[error]2025-07-31 08:00:39 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372849) : EOF
2025-07-31 08:00:39 Fetching artifacts...
2025-07-31 08:00:39 Cannot copy contents EOF
2025-07-31 08:00:39 Restoring google-nested:ubuntu-24.04-64 (jul310600-372849)...
##[error]2025-07-31 08:00:39 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372849) : EOF
2025-07-31 08:00:39 Discarding google-nested:ubuntu-24.04-64 (jul310600-372849)...
2025-07-31 08:00:39 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2404 (jul310600-372844) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2404 '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ '[' true = false ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : false
++ : 512
++ : 512
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state setup-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir
Name                     Version  Publisher             Notes  Summary
test-snapd-tools         1.0      test-snaps-canonical  -      Tools for testing the snapd application
test-snapd-tools-core24  1.0      cachio                -      test snap with basic tools used to test snapd
test-snapd-tools-core22  1.0      cachio                -
test-snapd-tools-core20  1.0      test-snaps-canonical  -
test-snapd-tools-core18  1.0      test-snaps-canonical  -
Unit fakestore.service could not be found.
Running as unit: fakestore.service; invocation ID: d4d132ba9e024ae6b3a860c6d107526f
+ echo 'Expose the needed assertions through the fakestore'
Expose the needed assertions through the fakestore
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/testrootorg-store.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir/asserts
+ export SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ snap download --basename=pc --channel=classic-24.04/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ snap download --basename=pc-kernel-from-store --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel-from-store.assert
snap install pc-kernel-from-store.snap
+ snap ack pc-kernel-from-store.assert
+ uc24_build_initramfs_kernel_snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc-kernel-from-store.snap /var/tmp/work-dir/assets
+ local ORIG_SNAP=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc-kernel-from-store.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc-kernel-from-store.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[===/                                                        ]  1294/19159   6%
[=========-                                                  ]  2989/19159  15%
[===================\                                        ]  6263/19159  32%
[===================|                                        ]  6362/19159  33%
[====================\                                       ]  6521/19159  34%
[================================|                           ] 10463/19159  54%
[======================================================/     ] 17772/19159  92%
[===========================================================/] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmpyj9t2jh4ubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 598003      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:42:01.108827732 +0000
Modify: 2025-07-31 07:42:01.108827732 +0000
Change: 2025-07-31 07:42:01.108827732 +0000
Birth: 2025-07-31 07:42:01.108827732 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap pc-kernel-repacked.snap
+ '[' 24.04 = 25.04 ']'
+ model_version_string=2404
+ curl -q https://raw.githubusercontent.com/canonical/models/refs/heads/master/ubuntu-classic-2404-amd64-dangerous.json
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
Dload  Upload   Total   Spent    Left  Speed
0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100  2371  100  2371    0     0  13078      0 --:--:-- --:--:-- --:--:-- 13099
+ gojq 'del(.snaps[] | select(.name | test("^(pc|pc-kernel|core.*|snapd)$") | not))' classic.json
+ mv classic-tmp.json classic.json
+ gojq '."authority-id" = "developer1" | ."brand-id" = "developer1"' classic.json
+ mv classic-tmp.json classic.json
+ cat
+ export HYBRID_SYSTEM_MK_ROOT_FS=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/prepare-rootfs.sh
+ HYBRID_SYSTEM_MK_ROOT_FS=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/prepare-rootfs.sh
+ gendeveloper1 sign-model
++ pwd
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/setup_nested_hybrid_system.sh --model classic.model --store-dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir --gadget pc.snap --gadget-assertion pc.assert --kernel pc-kernel-repacked.snap --kernel-assertion pc-kernel-from-store.assert --recovery-key-out /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/rkey-pre-install.out
+ main --model classic.model --store-dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir --gadget pc.snap --gadget-assertion pc.assert --kernel pc-kernel-repacked.snap --kernel-assertion pc-kernel-from-store.assert --recovery-key-out /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/rkey-pre-install.out
+ local model_assertion=
+ local store_dir=
+ local gadget_snap=
+ local gadget_assertion=
+ local kernel_snap=
+ local kernel_assertion=
+ local label=classic
+ local disk=
+ local kern_mods_comp=
+ local passphrase=
+ local recovery_key_out=
+ extra_muinstaller_args=()
+ local extra_muinstaller_args
+ '[' 14 -gt 0 ']'
+ case "$1" in
+ model_assertion=classic.model
+ shift 2
+ '[' 12 -gt 0 ']'
+ case "$1" in
+ store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir
+ shift 2
+ '[' 10 -gt 0 ']'
+ case "$1" in
+ gadget_snap=pc.snap
+ shift 2
+ '[' 8 -gt 0 ']'
+ case "$1" in
+ gadget_assertion=pc.assert
+ shift 2
+ '[' 6 -gt 0 ']'
+ case "$1" in
+ kernel_snap=pc-kernel-repacked.snap
+ shift 2
+ '[' 4 -gt 0 ']'
+ case "$1" in
+ kernel_assertion=pc-kernel-from-store.assert
+ shift 2
+ '[' 2 -gt 0 ']'
+ case "$1" in
+ recovery_key_out=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/rkey-pre-install.out
+ shift 2
+ '[' 0 -gt 0 ']'
+ '[' -z classic.model ']'
+ '[' -n pc-kernel-repacked.snap ']'
+ '[' -z pc-kernel-from-store.assert ']'
+ '[' -n pc-kernel-from-store.assert ']'
+ '[' -z pc-kernel-repacked.snap ']'
+ '[' -n pc.snap ']'
+ '[' -z pc.assert ']'
+ '[' -n pc.assert ']'
+ '[' -z pc.snap ']'
++ realpath classic.model
+ model_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/classic.model
+ '[' -n '' ']'
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir ']'
++ realpath /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir
+ store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir
+ '[' -n pc.snap ']'
++ realpath pc.snap
+ gadget_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc.snap
++ realpath pc.assert
+ gadget_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc.assert
+ '[' -n pc-kernel-repacked.snap ']'
++ realpath pc-kernel-repacked.snap
+ kernel_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc-kernel-repacked.snap
++ realpath pc-kernel-from-store.assert
+ kernel_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc-kernel-from-store.assert
+ '[' -n '' ']'
++ mktemp -d --tmpdir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys
+ cd /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq
+ '[' -z '' ']'
+ disk=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/disk.img
+ truncate --size=6G /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/disk.img
+ '[' -z /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc.snap ']'
+ '[' -z /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc-kernel-repacked.snap ']'
+ run_muinstaller /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/classic.model /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc.assert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc-kernel-repacked.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc-kernel-from-store.assert classic /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/disk.img '' '' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/rkey-pre-install.out
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : false
++ : 512
++ : 512
+ local model_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/classic.model
+ local store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir
+ local gadget_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc.snap
+ local gadget_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc.assert
+ local kernel_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc-kernel-repacked.snap
+ local kernel_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc-kernel-from-store.assert
+ local label=classic
+ local disk=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/disk.img
+ local kern_mods_comp=
+ local passphrase=
+ local recovery_key_out=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/rkey-pre-install.out
+ shift 11
+ extra_muinstaller_args=()
+ local extra_muinstaller_args
+ snap ack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc-kernel-from-store.assert
+ snap ack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc.assert
+ local key_name
++ nested_get_snakeoil_key
++ nested_ensure_ovmf
++ '[' -d /var/tmp/work-dir/assets/ovmf ']'
++ '[' -f /var/tmp/work-dir/assets/test-snapd-ovmf.snap ']'
++ snap download --channel=latest/edge test-snapd-ovmf --basename=test-snapd-ovmf --target-directory=/var/tmp/work-dir/assets
++ unsquashfs -d /var/tmp/work-dir/assets/ovmf /var/tmp/work-dir/assets/test-snapd-ovmf.snap
++ os.query is-arm
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.key DB.key
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.crt DB.pem
++ echo DB
+ key_name=DB
+ local snakeoil_key=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.key
+ local snakeoil_cert=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.pem
+ unsquashfs -d pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc.snap
Parallel unsquashfs: Using 2 processors
14 inodes (37 blocks) to write

[=================================================================|] 51/51 100%

created 12 files
created 9 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ tests.nested secboot-sign gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.pem
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ snap pack --filename=pc.snap pc-gadget/
built: pc.snap
+ build_snapd_snap .
+ local TARGET
+ local snapd_snap_cache
+ TARGET=.
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ./
+ mv snapd_from_ci.snap snapd.snap
+ kmodsarg=
+ '[' -n '' ']'
+ snap prepare-image --classic --channel=edge --snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc-kernel-repacked.snap --snap pc.snap --snap snapd.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/classic.model ./classic-seed
Fetching core22 (2111)
WARNING: "snapd", "pc-kernel", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
Copying "snapd.snap" (snapd)
Copying "/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/pc-kernel-repacked.snap" (pc-kernel)
Copying "pc.snap" (pc)
+ mv ./classic-seed/system-seed/systems/20250731 ./classic-seed/system-seed/systems/classic
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir ']'
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state teardown-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/fake-store-blobdir
Failed to reset failed state of unit fakestore.service: Unit fakestore.service not loaded.
++ command -v snapcraft
+ '[' -z '' ']'
+ snap install snapcraft --candidate --classic
snapcraft (candidate) 8.10.2 from Canonical** installed
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/lxd-state prepare-snap
lxd-state: installing lxd snap
lxd (candidate) 6.4-25e10d4 from Canonical** installed
dpkg-query: no packages found matching lxd-client
lxd-state: initializing lxd
lxd-state: setting up proxy for lxc
To start your first container, try: lxc launch ubuntu:24.04
Or for a virtual machine: lxc launch ubuntu:24.04 --vm

+ cd /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller
+ snapcraft
Launching instance...
Creating new instance from remote
Creating new base instance from remote
Creating new instance from base instance
Starting instance
Initializing parts lifecycle
Installing build-packages
Installing build-snaps
Pulling muinstaller
Building muinstaller
:: + snapcraftctl build
:: Warning: use 'craftctl default' to execute the default step handler
:: + go mod download all
:: + go install -p 2 ./...
::
:: Users are encouraged to replace 'snapcraftctl' with 'craftctl' and use
:: 'CRAFT_*' environment variables in scriptlets when building snaps based
:: on core22. Please refer to the core22 migration guide for details.
:: + cp -a mk-classic-rootfs.sh /root/parts/muinstaller/install/bin
Staging muinstaller
Priming muinstaller
Extracting and updating metadata...
Copying snap assets...
Generating snap metadata...
Generated snap metadata
Reading snap metadata...
Running linters...
Running linter: classic
Running linter: library
Lint OK:
- classic: Snap confinement is set to classic.
Creating snap package...
Created snap package muinstaller_0.1_amd64.snap
+ local muinstaller_snap
++ find /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/ -maxdepth 1 -name '*.snap'
+ muinstaller_snap=/home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
+ tests.nested build-image classic
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
Dload  Upload   Total   Spent    Left  Speed
0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  4  585M    4 24.5M    0     0   120M      0  0:00:04 --:--:--  0:00:04  120M
 47  585M   47  275M    0     0   229M      0  0:00:02  0:00:01  0:00:01  229M
 89  585M   89  525M    0     0   238M      0  0:00:02  0:00:02 --:--:--  238M
100  585M  100  585M    0     0   233M      0  0:00:02  0:00:02 --:--:--  232M
Image doesn't need to be decompressed
'/var/tmp/work-dir/images/ubuntu-classic-24-custom-hybrid-fde-recovery-keys_2404.img' -> '/var/tmp/work-dir/images/ubuntu-classic-24-custom-hybrid-fde-recovery-keys_2404.img.pristine'
+ NESTED_PARAM_EXTRA='-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
+ tests.nested create-vm classic --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
Image resized.
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
grep: /var/tmp/work-dir/logs/serial.log: No such file or directory
/home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh: line 84: test: : integer expression expected
grep: /var/tmp/work-dir/logs/serial.log: No such file or directory
/home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh: line 85: test: : integer expression expected
active
active
SSH connection ready
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
PATH=/writable/test-tools:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
[Service]
Environment=SNAPD_DEBUG=1 SNAPPY_TESTING=1 SNAPD_TRACE=1 SNAPD_JSON_LOGGING=1
SNAPD_DEBUG=1
SNAPD_TRACE=1
SNAPD_JSON_LOGGING=1
SNAP_LOG_TO_JOURNAL=1
+ for s in BOOT/BOOTX64.EFI ubuntu/shimx64.efi
+ remote.exec 'sudo cp -a /boot/efi/EFI/BOOT/BOOTX64.EFI /tmp'
++ basename BOOT/BOOTX64.EFI
+ remote.exec 'sudo chmod 755 /tmp/BOOTX64.EFI'
++ basename BOOT/BOOTX64.EFI
+ remote.pull /tmp/BOOTX64.EFI .
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename BOOT/BOOTX64.EFI
+ nested_secboot_sign_file BOOTX64.EFI /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=BOOTX64.EFI
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature BOOTX64.EFI
+ local FILE=BOOTX64.EFI
+ sbverify --list BOOTX64.EFI
+ grep '^signature [0-9]*$'
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove BOOTX64.EFI
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
+ sbverify --list BOOTX64.EFI
+ grep '^signature [0-9]*$'
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.pem --output BOOTX64.EFI BOOTX64.EFI
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
++ basename BOOT/BOOTX64.EFI
+ remote.push BOOTX64.EFI
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename BOOT/BOOTX64.EFI
+ remote.exec 'sudo mv BOOTX64.EFI /boot/efi/EFI/BOOT/BOOTX64.EFI'
mv: failed to preserve ownership for '/boot/efi/EFI/BOOT/BOOTX64.EFI': Operation not permitted
+ for s in BOOT/BOOTX64.EFI ubuntu/shimx64.efi
+ remote.exec 'sudo cp -a /boot/efi/EFI/ubuntu/shimx64.efi /tmp'
++ basename ubuntu/shimx64.efi
+ remote.exec 'sudo chmod 755 /tmp/shimx64.efi'
++ basename ubuntu/shimx64.efi
+ remote.pull /tmp/shimx64.efi .
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename ubuntu/shimx64.efi
+ nested_secboot_sign_file shimx64.efi /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=shimx64.efi
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature shimx64.efi
+ local FILE=shimx64.efi
+ sbverify --list shimx64.efi
+ grep '^signature [0-9]*$'
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove shimx64.efi
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
+ sbverify --list shimx64.efi
+ grep '^signature [0-9]*$'
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/DB.pem --output shimx64.efi shimx64.efi
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
++ basename ubuntu/shimx64.efi
+ remote.push shimx64.efi
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename ubuntu/shimx64.efi
+ remote.exec 'sudo mv shimx64.efi /boot/efi/EFI/ubuntu/shimx64.efi'
mv: failed to preserve ownership for '/boot/efi/EFI/ubuntu/shimx64.efi': Operation not permitted
+ remote.exec 'sudo sh -c '\''echo SNAPD_DEBUG=1 >> /etc/environment'\'''
+ remote.push /home/gopath/snapd_1337.2.70_amd64.deb
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
+ remote.exec 'sudo mv snapd_*.deb /var/lib/snapd/'
+ remote.exec 'sudo apt install -y /var/lib/snapd/snapd_*.deb'

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Reading state information...
Suggested packages:
zenity | kdialog
The following packages will be upgraded:
snapd
1 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Need to get 0 B/34.2 MB of archives.
After this operation, 11.4 MB of additional disk space will be used.
Get:1 /var/lib/snapd/snapd_1337.2.70_amd64.deb snapd amd64 1337.2.70 [34.2 MB]
debconf: unable to initialize frontend: Dialog
debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype
dpkg-preconfigure: unable to re-open stdin:
(Reading database ... 
(Reading database ... 5%
(Reading database ... 10%
(Reading database ... 15%
(Reading database ... 20%
(Reading database ... 25%
(Reading database ... 30%
(Reading database ... 35%
(Reading database ... 40%
(Reading database ... 45%
(Reading database ... 50%
(Reading database ... 55%
(Reading database ... 60%
(Reading database ... 65%
(Reading database ... 70%
(Reading database ... 75%
(Reading database ... 80%
(Reading database ... 85%
(Reading database ... 90%
(Reading database ... 95%
(Reading database ... 100%
(Reading database ... 74795 files and directories currently installed.)
Preparing to unpack .../snapd_1337.2.70_amd64.deb ...
Unpacking snapd (1337.2.70) over (2.67.1+24.04) ...
Setting up snapd (1337.2.70) ...
Installing new version of config file /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
snapd.failure.service is a disabled or a static unit not running, not starting it.
snapd.gpio-chardev-setup.target is a disabled or a static unit not running, not starting it.
snapd.snap-repair.service is a disabled or a static unit not running, not starting it.
Processing triggers for dbus (1.14.10-4ubuntu4.1) ...
Processing triggers for man-db (2.12.0-4build2) ...
debconf: unable to initialize frontend: Dialog
debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
+ sshpass -p ubuntu scp -r -P 8022 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no ./classic-seed/system-seed/ 'user1@localhost:~/install-seed'
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
+ remote.exec 'sudo mv /home/user1/install-seed /var/lib/snapd/'
+ tests.nested vm stop
+ sync
++ nested_get_image_name classic
++ local BASE_NAME
+++ nested_get_image_name_base classic
+++ local TYPE=classic
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/hybrid-fde-recovery-keys
+++ NAME=hybrid-fde-recovery-keys
+++ '[' -n 2404 ']'
+++ NAME=hybrid-fde-recovery-keys_2404
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
+++ '[' 0 '!=' 0 ']'
+++ echo ubuntu-classic-24-custom-hybrid-fde-recovery-keys_2404
++ BASE_NAME=ubuntu-classic-24-custom-hybrid-fde-recovery-keys_2404
++ echo ubuntu-classic-24-custom-hybrid-fde-recovery-keys_2404.img
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/hybrid-fde-recovery-keys
+++ NAME=hybrid-fde-recovery-keys
+++ '[' -n 2404 ']'
+++ NAME=hybrid-fde-recovery-keys_2404
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
+++ '[' 0 '!=' 0 ']'
+++ echo ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404
++ BASE_NAME=ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404
++ echo ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404.img
+ qemu-img convert -f qcow2 -O raw /var/tmp/work-dir/images/ubuntu-classic-24-custom-hybrid-fde-recovery-keys_2404.img /var/tmp/work-dir/images/ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404.img
+ local image_name
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/hybrid-fde-recovery-keys
+++ NAME=hybrid-fde-recovery-keys
+++ '[' -n 2404 ']'
+++ NAME=hybrid-fde-recovery-keys_2404
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
+++ '[' 0 '!=' 0 ']'
+++ echo ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404
++ BASE_NAME=ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404
++ echo ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404.img
+ image_name=ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404.img
+ touch /var/tmp/work-dir/images/ubuntu-core-24-custom-hybrid-fde-recovery-keys_2404.img.configured
+ tests.nested create-vm core --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/hybrid-fde-recovery-keys/tmp.Tp4E42gvzq/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
-----
.
2025-07-31 08:00:39 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:gadgetextra (jul310600-372859) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:gadgetextra '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ '[' true = false ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ build_snapd_snap .
+ local TARGET
+ local snapd_snap_cache
+ TARGET=.
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ./
+ echo 'Repack the snapd snap with a marker file'
Repack the snapd snap with a marker file
+ unsquashfs -d snapd-snap snapd_from_ci.snap
Parallel unsquashfs: Using 2 processors
543 inodes (1692 blocks) to write

[=================/                                            ]  656/2235  29%
[=========================-                                    ]  924/2235  41%
[============================\                                 ] 1045/2235  46%
[===============================|                              ] 1156/2235  51%
[==================================/                           ] 1265/2235  56%
[=====================================-                        ] 1382/2235  61%
[========================================\                     ] 1488/2235  66%
[===========================================|                  ] 1592/2235  71%
[==============================================/               ] 1702/2235  76%
[=================================================-            ] 1825/2235  81%
[==========================================================\   ] 2139/2235  95%
[=============================================================\] 2235/2235 100%

created 525 files
created 70 directories
created 18 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
+ echo 'Leave a marker file that triggers boot config assets to be injected'
Leave a marker file that triggers boot config assets to be injected
+ echo bootassetstesting
+ snap pack snapd-snap --filename=snapd-boot-config-update.snap
built: snapd-boot-config-update.snap
+ rm -rf snapd-snap
+ '[' gadget-extra '!=' no-gadget ']'
+ echo 'Grab and prepare the gadget snap'
Grab and prepare the gadget snap
++ tests.nested show version
+ version=24
+ snap download --basename=pc --channel=24/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ unsquashfs -d pc-gadget pc.snap
Parallel unsquashfs: Using 2 processors
19 inodes (43 blocks) to write

[=================================================================|] 62/62 100%

created 17 files
created 10 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ echo 'Sign the shim binary'
Sign the shim binary
++ tests.nested download snakeoil-key
+ KEY_NAME=DB
+ SNAKEOIL_KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-boot-config-update/DB.key
+ SNAKEOIL_CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-boot-config-update/DB.pem
+ tests.nested secboot-sign gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-boot-config-update/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-boot-config-update/DB.pem
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
signature 1
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
Signing Unsigned original image
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ case "$VARIANT" in
+ echo 'snapd.debug=1 hello from test'
++ tests.nested get extra-snaps-path
+ snap pack pc-gadget/ /tmp/extra-snaps
built: /tmp/extra-snaps/pc_24-0.2_amd64.snap
+ tests.nested build-image core
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
+ local IMAGE_NAME
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/core20-boot-config-update
+++ NAME=core20-boot-config-update
+++ '[' -n gadgetextra ']'
+++ NAME=core20-boot-config-update_gadgetextra
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 1 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-core20-boot-config-update_gadgetextra
++ BASE_NAME=ubuntu-core-24-custom-core20-boot-config-update_gadgetextra
++ echo ubuntu-core-24-custom-core20-boot-config-update_gadgetextra.img
+ IMAGE_NAME=ubuntu-core-24-custom-core20-boot-config-update_gadgetextra.img
+ mkdir -p /var/tmp/work-dir/images
+ '[' -f /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra.img ']'
+ '[' -n '' ']'
+ local UBUNTU_IMAGE=/home/gopath/bin/ubuntu-image
+ os.query is-xenial
+ os.query is-arm
+ '[' true = true ']'
+ nested_prepare_snapd
+ '[' true = true ']'
+ echo 'Repacking snapd snap'
Repacking snapd snap
+ local snap_name output_name snap_id
+ nested_is_core_16_system
+ os.query is-xenial
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename '/var/tmp/work-dir/assets/snapd_*.snap'
+ snap_name='snapd_*.snap'
+ break
+ '[' '!' -f '/var/tmp/work-dir/assets/snapd_*.snap' ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ build_snapd_snap /var/tmp/work-dir/assets
+ local TARGET
+ local snapd_snap_cache
+ TARGET=/var/tmp/work-dir/assets
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap /var/tmp/work-dir/assets/
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename /var/tmp/work-dir/assets/snapd_from_ci.snap
+ snap_name=snapd_from_ci.snap
+ break
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/snapd_from_ci.snap /tmp/extra-snaps/
+ '[' false = true ']'
+ nested_prepare_kernel
+ '[' true = true ']'
+ echo 'Repacking kernel snap'
Repacking kernel snap
+ local kernel_snap output_name snap_id version
+ output_name=pc-kernel.snap
+ snap_id=pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ '[' '!' -f /var/tmp/work-dir/assets/pc-kernel.snap ']'
+ nested_is_core_le 18
+ local VERSION=18
+ os.query is-ubuntu-le 18.04
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ snap download --basename=pc-kernel --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ local epochBumpTime
+ epochBumpTime=
+ '[' -n '' ']'
+ nested_is_core_24_system
+ os.query is-noble
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ uc24_build_initramfs_kernel_snap pc-kernel.snap /var/tmp/work-dir/assets ''
+ local ORIG_SNAP=pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=======/                                                    ]  2516/19159  13%
[==================/                                         ]  5998/19159  31%
[===================\                                        ]  6351/19159  33%
[==========================\                                 ]  8469/19159  44%
[=====================================================|      ] 17429/19159  90%
[===========================================================|] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmpe3_41h87ubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 605090      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:57:21.210839509 +0000
Modify: 2025-07-31 07:57:21.210839509 +0000
Change: 2025-07-31 07:57:21.210839509 +0000
Birth: 2025-07-31 07:57:21.210839509 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-boot-config-update '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ rm -f pc-kernel.snap pc-kernel.assert
++ ls /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ kernel_snap=/var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ chmod 0600 /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets/pc-kernel.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc-kernel.snap /tmp/extra-snaps/pc-kernel.snap
+ '[' false = true ']'
+ nested_prepare_gadget
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ local snap_id version gadget_snap
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ snap_id=UqFziVZDHLSyO3TqSWgNBoAdHbLI4dAH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'pc_*.snap'
+ existing_snap=/tmp/extra-snaps/pc_24-0.2_amd64.snap
+ '[' -n /tmp/extra-snaps/pc_24-0.2_amd64.snap ']'
+ echo 'Using generated pc gadget snap /tmp/extra-snaps/pc_24-0.2_amd64.snap'
Using generated pc gadget snap /tmp/extra-snaps/pc_24-0.2_amd64.snap
+ '[' false = true ']'
+ return
+ nested_prepare_base
+ '[' true = true ']'
+ nested_is_core_16_system
+ os.query is-xenial
+ nested_is_core_18_system
+ os.query is-bionic
+ nested_is_core_20_system
+ os.query is-focal
+ nested_is_core_22_system
+ os.query is-jammy
+ nested_is_core_24_system
+ os.query is-noble
+ snap_name=core24
+ snap_id=dwTAh7MZZ01zyriOZErqd1JynQLiOGvM
+ output_name=core24.snap
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'core24*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ '[' '!' -f /var/tmp/work-dir/assets/core24.snap ']'
+ echo 'Repacking core24 snap'
Repacking core24 snap
+ snap download --channel=edge --basename=core24 core24
Fetching snap "core24"
Fetching assertions for "core24"
Install the snap with:
snap ack core24.assert
snap install core24.snap
+ repack_core_snap_with_tweaks core24.snap new-core24.snap
+ local CORESNAP=core24.snap
+ local TARGET=new-core24.snap
+ local UNPACK_DIR
++ mktemp -d /tmp/core-unpack.XXXXXXXX
+ UNPACK_DIR=/tmp/core-unpack.nC1M8Ovx
+ unsquashfs -no-progress -f -d /tmp/core-unpack.nC1M8Ovx core24.snap
Parallel unsquashfs: Using 2 processors
9250 inodes (8496 blocks) to write


created 7574 files
created 1387 directories
created 1669 symlinks
created 4 devices
created 0 fifos
created 0 sockets
created 3 hardlinks
+ mkdir -p /tmp/core-unpack.nC1M8Ovx/etc/systemd/journald.conf.d
+ cat
+ mkdir -p /tmp/core-unpack.nC1M8Ovx/etc/systemd/system/snapd.service.d
+ cat
+ '[' false = true ']'
+ cp /home/gopath/src/github.com/snapcore/snapd/data/completion/bash/complete.sh /tmp/core-unpack.nC1M8Ovx/usr/lib/snapd/complete.sh
+ snap pack --filename=new-core24.snap /tmp/core-unpack.nC1M8Ovx
built: new-core24.snap
+ rm -rf /tmp/core-unpack.nC1M8Ovx
+ rm -f core24.snap core24.assert
+ mv new-core24.snap /var/tmp/work-dir/assets/core24.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/core24.snap /tmp/extra-snaps/core24.snap
+ '[' false = true ']'
+ local NESTED_MODEL
++ nested_get_model
++ '[' -n '' ']'
++ case "$SPREAD_SYSTEM" in
++ echo /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/nested-24-amd64.model
+ NESTED_MODEL=/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/nested-24-amd64.model
+ local EXTRA_SNAPS=
++ nested_get_extra_snaps
++ nested_get_extra_containers snap
++ local SUFFIX=snap
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.snap'
++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/pc-kernel.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/snapd_from_ci.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/core24.snap
++ IFS=
++ read -r mysnap
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap'
++ nested_get_extra_comps
++ nested_get_extra_containers comp
++ local SUFFIX=comp
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.comp'
+ '[' -n '' ']'
+ SNAPPY_FORCE_SAS_URL=
+ export SNAPPY_FORCE_SAS_URL
+ UBUNTU_IMAGE_SNAP_CMD=/usr/bin/snap
+ export UBUNTU_IMAGE_SNAP_CMD
+ '[' -n beta ']'
+ UBUNTU_IMAGE_CHANNEL_ARG='--channel beta'
+ declare -a UBUNTU_IMAGE_PRESEED_ARGS
+ '[' -n '' ']'
+ SNAPD_DEBUG=1
+ tee /var/tmp/work-dir/logs/ubuntu-image.log
+ /home/gopath/bin/ubuntu-image snap --image-size 10G --validation=enforce /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/nested-24-amd64.model --channel beta '' --output-dir /var/tmp/work-dir/images --sector-size 512 --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap
[0] prepare_image
WARNING: "snapd", "pc-kernel", "core24", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
[1] load_gadget_yaml
[2] set_artifact_names
[3] populate_rootfs_contents
[4] generate_disk_info
[5] calculate_rootfs_size
[6] populate_bootfs_contents
[7] populate_prepare_partitions
WARNING: No mkfs configuration found for this series: 16.04. Will fallback on the default one.
[8] make_disk
[9] generate_snap_manifest
Build successful
+ local IMAGE_BASE_NAME
++ nested_get_image_name_base core
++ local TYPE=core
++ local SOURCE=beta
++ local NAME=unset
++ local VERSION
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ '[' unset = unset ']'
+++ basename tests/nested/manual/core20-boot-config-update
++ NAME=core20-boot-config-update
++ '[' -n gadgetextra ']'
++ NAME=core20-boot-config-update_gadgetextra
++ '[' true = true ']'
++ SOURCE=custom
+++ nested_get_extra_snaps
+++ nested_get_extra_containers snap
+++ wc -l
+++ local SUFFIX=snap
+++ local EXTRA_SNAPS_PATH
++++ nested_get_extra_snaps_path
++++ echo /tmp/extra-snaps
+++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
+++ '[' -d /tmp/extra-snaps ']'
+++ IFS=
+++ read -r mysnap
++++ find /tmp/extra-snaps -name '*.snap'
+++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/pc-kernel.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/snapd_from_ci.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/core24.snap
+++ IFS=
+++ read -r mysnap
++ '[' 4 '!=' 0 ']'
++ SOURCE=custom
++ echo ubuntu-core-24-custom-core20-boot-config-update_gadgetextra
+ IMAGE_BASE_NAME=ubuntu-core-24-custom-core20-boot-config-update_gadgetextra
+ find /var/tmp/work-dir/images/ -maxdepth 1 -name '*.img'
+ read -r imgname
++ basename /var/tmp/work-dir/images/pc.img .img
+ volname=pc
+ mv /var/tmp/work-dir/images/pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra-pc.img
+ read -r imgname
+ local BOOTVOLUME
+ BOOTVOLUME=pc
+ '[' -e pc-gadget/meta/gadget.yaml ']'
++ gojq --yaml-input --raw-output '.volumes | to_entries[] | .key as $p | .value.structure[] | select(.name == "ubuntu-boot") | $p' pc-gadget/meta/gadget.yaml
+ BOOTVOLUME=pc
+ '[' -z pc ']'
+ ln -s /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra.img
+ unset SNAPPY_FORCE_SAS_URL
+ unset UBUNTU_IMAGE_SNAP_CMD
+ nested_configure_default_user
+ local IMAGE_NAME
+ local IMAGE_PATH
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/core20-boot-config-update
+++ NAME=core20-boot-config-update
+++ '[' -n gadgetextra ']'
+++ NAME=core20-boot-config-update_gadgetextra
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ wc -l
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/snapd_from_ci.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/core24.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 4 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-core20-boot-config-update_gadgetextra
++ BASE_NAME=ubuntu-core-24-custom-core20-boot-config-update_gadgetextra
++ echo ubuntu-core-24-custom-core20-boot-config-update_gadgetextra.img
+ IMAGE_NAME=ubuntu-core-24-custom-core20-boot-config-update_gadgetextra.img
++ realpath /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra.img
+ IMAGE_PATH=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra-pc.img
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ nested_configure_cloud_init_on_core20_vm /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra-pc.img
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra-pc.img
+ nested_create_cloud_init_uc20_config /var/tmp/work-dir/assets/data.cfg
+ local CONFIG_PATH=/var/tmp/work-dir/assets/data.cfg
+ cat
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra-pc.img /var/tmp/work-dir/assets/data.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra-pc.img
+ local FILE=/var/tmp/work-dir/assets/data.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra-pc.img
+ devloop=/dev/loop1
+ ubuntuSeedDev=/dev/loop1p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop1p2
+ '[' -b /dev/loop1p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.36PeNDeyAg
+ retry -n 5 --wait 2 mount /dev/loop1p2 /tmp/tmp.36PeNDeyAg
+ mkdir -p /tmp/tmp.36PeNDeyAg/data/etc/cloud/cloud.cfg.d/
+ cp -f /var/tmp/work-dir/assets/data.cfg /tmp/tmp.36PeNDeyAg/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.36PeNDeyAg
+ losetup -d /dev/loop1
+ cp -v /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra-pc.img.pristine
'/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra-pc.img.pristine'
+ exit
+ tests.nested create-vm core
'/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-boot-config-update_gadgetextra-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
'/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.enrolled.fd' -> '/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.current.fd'
error: no matching snaps installed
test-snapd-swtpm (edge) 0.1.0 from Test snaps (test-snaps-canonical) installed
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
active
active
active
-----
.
2025-07-31 08:00:40 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:gadgetextra (jul310600-372859) : serial output saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_core20-boot-config-update.serial.log
2025-07-31 08:00:40 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:gadgetextra (jul310600-372859)...
##[error]2025-07-31 08:00:40 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:gadgetextra (jul310600-372859) : EOF
2025-07-31 08:00:40 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372859)...
##[error]2025-07-31 08:00:40 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372859) : EOF
2025-07-31 08:00:40 Fetching artifacts...
2025-07-31 08:00:40 Cannot copy contents EOF
2025-07-31 08:00:40 Restoring google-nested:ubuntu-24.04-64 (jul310600-372859)...
##[error]2025-07-31 08:00:40 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372859) : EOF
2025-07-31 08:00:40 Discarding google-nested:ubuntu-24.04-64 (jul310600-372859)...
2025-07-31 08:00:40 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2404 (jul310600-372844) : serial output saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_hybrid-fde-recovery-keys.serial.log
2025-07-31 08:00:40 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2404 (jul310600-372844)...
##[error]2025-07-31 08:00:40 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2404 (jul310600-372844) : EOF
2025-07-31 08:00:40 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372844)...
##[error]2025-07-31 08:00:40 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372844) : EOF
2025-07-31 08:00:40 Fetching artifacts...
2025-07-31 08:00:40 Cannot copy contents EOF
2025-07-31 08:00:40 Restoring google-nested:ubuntu-24.04-64 (jul310600-372844)...
##[error]2025-07-31 08:00:40 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372844) : EOF
2025-07-31 08:00:40 Discarding google-nested:ubuntu-24.04-64 (jul310600-372844)...
2025-07-31 08:00:40 Error executing google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:passphrase_auth (jul310600-372854) :
-----
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : ''
++ : false
++ : 512
++ : 512
+ os.query is-noble
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ snap download --basename=pc --channel=24/beta pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ unsquashfs -d pc-gadget pc.snap
Parallel unsquashfs: Using 2 processors
19 inodes (43 blocks) to write

[=================================================================|] 62/62 100%

created 17 files
created 10 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ echo console=ttyS0
+ cat
+ echo 'Sign the shim binary'
Sign the shim binary
++ tests.nested download snakeoil-key
+ KEY_NAME=DB
+ SNAKEOIL_KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/DB.key
+ SNAKEOIL_CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/DB.pem
+ tests.nested secboot-sign gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/DB.pem
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
signature 1
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
Signing Unsigned original image
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ snap pack --filename=pc.snap pc-gadget/
built: pc.snap
+ snap download --basename=pc-kernel --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ unsquashfs -d tmp-pc-kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=====/                                                      ]  1871/19159   9%
[==============-                                             ]  4643/19159  24%
[===================\                                        ]  6275/19159  32%
[===================|                                        ]  6367/19159  33%
[====================|                                       ]  6642/19159  34%
[=====================================/                      ] 12140/19159  63%
[=======================================================-    ] 17919/19159  93%
[===========================================================-] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
+ cat
+ rm pc-kernel.snap
+ snap pack tmp-pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
+ mv pc-kernel_6.8.0-72.72_amd64.snap pc-kernel.snap
+ os.query is-ubuntu-ge 24.04
+ uc24_build_initramfs_kernel_snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/pc-kernel.snap /var/tmp/work-dir/assets
+ local ORIG_SNAP=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/muinstaller-core/pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=====/                                                      ]  1851/19159   9%
[==============-                                             ]  4656/19159  24%
[===================\                                        ]  6268/19159  32%
[===================|                                        ]  6361/19159  33%
[====================|                                       ]  6616/19159  34%
[====================================/                       ] 11903/19159  62%
[======================================================-     ] 17583/19159  91%
[===========================================================-] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmpfdi4li8uubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 606333      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 08:00:28.611145739 +0000
Modify: 2025-07-31 08:00:28.611145739 +0000
Change: 2025-07-31 08:00:28.611145739 +0000
Birth: 2025-07-31 08:00:28.611145739 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
-----
.
2025-07-31 08:00:40 Error executing google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system (jul310600-372865) :
-----
+ unsquashfs /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/component-recovery-system/fake-store-blobdir/pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10367 blocks) to write

[===/                                                        ]  1091/19160   5%
[=======-                                                    ]  2585/19160  13%
[============-                                               ]  4215/19160  21%
[==================|                                         ]  6160/19160  32%
[===================-                                        ]  6351/19160  33%
[====================|                                       ]  6524/19160  34%
[========================|                                   ]  8014/19160  41%
[===================================/                        ] 11581/19160  60%
[================================================\           ] 15678/19160  81%
[========================================================|   ] 18417/19160  96%
[===========================================================|] 19160/19160 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
+ sed -i -e '/^version/ s/$/-with-comps/' squashfs-root/meta/snap.yaml
+ snap pack --filename=pc-kernel-with-comps.snap ./squashfs-root
built: pc-kernel-with-comps.snap
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/build_kernel_with_comps.sh mac80211_hwsim wifi-comp pc-kernel-with-comps.snap
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/component-recovery-system/fake-store-blobdir
++ : true
++ : true
++ : ''
++ : http://localhost:11028
++ : ''
++ : ''
++ : ''
++ : ''
++ : false
++ : 512
++ : 512
+ build_kernel_with_comp mac80211_hwsim wifi-comp pc-kernel-with-comps.snap
+ mod_name=mac80211_hwsim
+ comp_name=wifi-comp
+ kernel_snap_file=pc-kernel-with-comps.snap
+ use_provided_kernel=true
+ '[' -z pc-kernel-with-comps.snap ']'
+ '[' true = false ']'
+ unsquashfs -d kernel pc-kernel-with-comps.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10367 blocks) to write

[=======/                                                    ]  2493/19160  13%
[===============-                                            ]  5085/19160  26%
[===================\                                        ]  6343/19160  33%
[========================\                                   ]  8044/19160  41%
[===========================================|                ] 14053/19160  73%
[==========================================================/ ] 19038/19160  99%
[===========================================================/] 19160/19160 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ grep name: kernel/meta/snap.yaml
++ awk '{ print $2 }'
+ kernel_name=pc-kernel
++ find kernel/modules/6.8.0-72-generic -maxdepth 0 -printf '%f\n'
+ kern_ver=6.8.0-72-generic
+ comp_ko_dir=wifi-comp/modules/6.8.0-72-generic/kmod/
+ mkdir -p wifi-comp/modules/6.8.0-72-generic/kmod/
+ mkdir -p wifi-comp/meta/
+ cat
++ printf %s mac80211_hwsim
++ sed -r 's/[-_]/[-_]/g'
+ glob_mod_name='mac80211[-_]hwsim'
++ find kernel -name 'mac80211[-_]hwsim.ko*'
+ module_path=kernel/modules/6.8.0-72-generic/kernel/drivers/net/wireless/virtual/mac80211_hwsim.ko.zst
+ cp kernel/modules/6.8.0-72-generic/kernel/drivers/net/wireless/virtual/mac80211_hwsim.ko.zst wifi-comp/modules/6.8.0-72-generic/kmod/
+ snap pack --filename=pc-kernel+wifi-comp.comp wifi-comp
built: pc-kernel+wifi-comp.comp
+ rm kernel/modules/6.8.0-72-generic/kernel/drivers/net/wireless/virtual/mac80211_hwsim.ko.zst
+ mkdir -p kernel/lib
+ ln -s ../modules kernel/lib/modules
+ depmod -b kernel/ 6.8.0-72-generic
+ rm pc-kernel-with-comps.snap
+ gojq --arg COMP_NAME wifi-comp '.components = {$COMP_NAME:{"type":"kernel-modules"}}' --yaml-input kernel/meta/snap.yaml --yaml-output
+ mv kernel/meta/snap.yaml.new kernel/meta/snap.yaml
+ snap pack --filename=pc-kernel-with-comps.snap kernel
built: pc-kernel-with-comps.snap
+ '[' true = false ']'
+ rm -r kernel
+ kernel_id=pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-snap-installable --noack --revision 2 /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/component-recovery-system/fake-store-blobdir ./pc-kernel-with-comps.snap pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
Parallel unsquashfs: Using 2 processors
1 inodes (1 blocks) to write

[===================================================================|] 2/2 100%

created 1 file
created 2 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
'./pc-kernel-with-comps.snap' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/component-recovery-system/fake-store-blobdir/pc-kernel-with-comps.snap'
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-component-installable --noack --snap-revision 2 --component-revision 1 --snap-id pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/component-recovery-system/fake-store-blobdir ./pc-kernel+wifi-comp.comp
'./pc-kernel+wifi-comp.comp' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/component-recovery-system/fake-store-blobdir/pc-kernel+wifi-comp.comp'
++ tests.nested boot-id
+ boot_id=f392a49a-3200-4721-a0db-90f84fb66569
++ remote.exec 'sudo snap refresh --no-wait pc-kernel+wifi-comp'
+ change_id=4
+ remote.wait-for reboot f392a49a-3200-4721-a0db-90f84fb66569
remote.wait-for: waiting for reboot
....................Connection timed out during banner exchange
.Connection timed out during banner exchange
.Connection timed out during banner exchange
-----
.
2025-07-31 08:00:41 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetwithoutopinion (jul310600-372870) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetwithoutopinion '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ '[' true = false ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-signed.model'
++ : '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-auto-import.assert'
++ : /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir
++ : true
++ : false
++ : ''
++ : http://localhost:11028
++ : ''
++ : ''
++ : ''
++ : ''
++ : false
++ : 512
++ : 512
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state setup-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir
Name                     Version  Publisher             Notes  Summary
test-snapd-tools         1.0      test-snaps-canonical  -      Tools for testing the snapd application
test-snapd-tools-core24  1.0      cachio                -      test snap with basic tools used to test snapd
test-snapd-tools-core22  1.0      cachio                -
test-snapd-tools-core20  1.0      test-snaps-canonical  -
test-snapd-tools-core18  1.0      test-snaps-canonical  -
Unit fakestore.service could not be found.
Running as unit: fakestore.service; invocation ID: 9c39e3c92e9c42fa87ba7436b044eba2
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state teardown-staging-store
+ echo 'Expose the needed assertions through the fakestore'
Expose the needed assertions through the fakestore
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir/asserts
++ nested_get_snakeoil_key
++ nested_ensure_ovmf
++ '[' -d /var/tmp/work-dir/assets/ovmf ']'
++ '[' -f /var/tmp/work-dir/assets/test-snapd-ovmf.snap ']'
++ snap download --channel=latest/edge test-snapd-ovmf --basename=test-snapd-ovmf --target-directory=/var/tmp/work-dir/assets
++ unsquashfs -d /var/tmp/work-dir/assets/ovmf /var/tmp/work-dir/assets/test-snapd-ovmf.snap
++ os.query is-arm
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.key DB.key
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.crt DB.pem
++ echo DB
+ KEY_NAME=DB
+ SNAKEOIL_KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key
+ SNAKEOIL_CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
++ tests.nested show version
+ VERSION=24
+ snap download --basename=pc --channel=24/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ unsquashfs -d pc-gadget pc.snap
Parallel unsquashfs: Using 2 processors
19 inodes (43 blocks) to write

[=================================================================|] 62/62 100%

created 17 files
created 10 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
++ date '--date=next week' +%Y-%m-%dT%H:%M:%S%:z
+ sed defaults.yaml -e s/@HOLD-TIME@/2025-08-07T07:54:11+00:00/
+ case "$GADGET_DATASOURCE" in
+ mkdir -p pc-gadget/meta/hooks/
+ cp prepare-device pc-gadget/meta/hooks/
+ nested_secboot_sign_gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ local GADGET_DIR=pc-gadget
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ '[' -f pc-gadget/fb.efi ']'
+ nested_secboot_sign_file pc-gadget/fb.efi /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/fb.efi
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/fb.efi
+ local FILE=pc-gadget/fb.efi
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/fb.efi
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem --output pc-gadget/fb.efi pc-gadget/fb.efi
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
Signing Unsigned original image
+ nested_secboot_sign_file pc-gadget/shim.efi.signed /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/shim.efi.signed
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/shim.efi.signed
+ local FILE=pc-gadget/shim.efi.signed
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem --output pc-gadget/shim.efi.signed pc-gadget/shim.efi.signed
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
++ tests.nested get extra-snaps-path
+ snap pack pc-gadget/ /tmp/extra-snaps
built: /tmp/extra-snaps/pc_24-0.2_amd64.snap
+ rm -rf pc-gadget/
+ rm -f /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ systemd-run --collect --unit fakedevicesvc fakedevicesvc localhost:11029
Running as unit: fakedevicesvc.service; invocation ID: d2a5b0f7b5bd4a5db66bebc34519ca24
+ tests.nested build-image core
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
+ local IMAGE_NAME
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/core20-cloud-init-maas-signed-seed-data
+++ NAME=core20-cloud-init-maas-signed-seed-data
+++ '[' -n gadgetwithoutopinion ']'
+++ NAME=core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
+++++ nested_get_extra_snaps_path
++++ wc -l
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
+++++ find /tmp/extra-snaps -name '*.snap'
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 1 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion
++ BASE_NAME=ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion
++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ IMAGE_NAME=ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ mkdir -p /var/tmp/work-dir/images
+ '[' -f /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img ']'
+ '[' -n '' ']'
+ local UBUNTU_IMAGE=/home/gopath/bin/ubuntu-image
+ os.query is-xenial
+ os.query is-arm
+ '[' true = true ']'
+ nested_prepare_snapd
+ '[' true = true ']'
+ echo 'Repacking snapd snap'
Repacking snapd snap
+ local snap_name output_name snap_id
+ nested_is_core_16_system
+ os.query is-xenial
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename '/var/tmp/work-dir/assets/snapd_*.snap'
+ snap_name='snapd_*.snap'
+ break
+ '[' '!' -f '/var/tmp/work-dir/assets/snapd_*.snap' ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ build_snapd_snap /var/tmp/work-dir/assets
+ local TARGET
+ local snapd_snap_cache
+ TARGET=/var/tmp/work-dir/assets
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap /var/tmp/work-dir/assets/
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename /var/tmp/work-dir/assets/snapd_from_ci.snap
+ snap_name=snapd_from_ci.snap
+ break
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/snapd_from_ci.snap /tmp/extra-snaps/
+ '[' true = true ']'
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-snap-installable --noack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir /tmp/extra-snaps/snapd_from_ci.snap PMrrV4ml8uWuEUDBT8dSGnKUYbevVhc4
Parallel unsquashfs: Using 2 processors
1 inodes (1 blocks) to write

[===================================================================|] 2/2 100%

created 1 file
created 2 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
'/tmp/extra-snaps/snapd_from_ci.snap' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir/snapd_from_ci.snap'
+ nested_prepare_kernel
+ '[' true = true ']'
+ echo 'Repacking kernel snap'
Repacking kernel snap
+ local kernel_snap output_name snap_id version
+ output_name=pc-kernel.snap
+ snap_id=pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ '[' '!' -f /var/tmp/work-dir/assets/pc-kernel.snap ']'
+ nested_is_core_le 18
+ local VERSION=18
+ os.query is-ubuntu-le 18.04
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ snap download --basename=pc-kernel --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ local epochBumpTime
+ epochBumpTime=
+ '[' -n '' ']'
+ nested_is_core_24_system
+ os.query is-noble
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ uc24_build_initramfs_kernel_snap pc-kernel.snap /var/tmp/work-dir/assets ''
+ local ORIG_SNAP=pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=======/                                                    ]  2418/19159  12%
[================-                                           ]  5470/19159  28%
[===================\                                        ]  6351/19159  33%
[====================-                                       ]  6515/19159  34%
[==========================\                                 ]  8671/19159  45%
[=====================================================|      ] 17455/19159  91%
[===========================================================|] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmpup11uukdubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 605064      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:54:28.654086036 +0000
Modify: 2025-07-31 07:54:28.654086036 +0000
Change: 2025-07-31 07:54:28.654086036 +0000
Birth: 2025-07-31 07:54:28.654086036 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ rm -f pc-kernel.snap pc-kernel.assert
++ ls /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ kernel_snap=/var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ chmod 0600 /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets/pc-kernel.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc-kernel.snap /tmp/extra-snaps/pc-kernel.snap
+ '[' true = true ']'
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-snap-installable --noack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir /tmp/extra-snaps/pc-kernel.snap pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
Parallel unsquashfs: Using 2 processors
1 inodes (1 blocks) to write

[===================================================================|] 2/2 100%

created 1 file
created 2 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
'/tmp/extra-snaps/pc-kernel.snap' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir/pc-kernel.snap'
+ nested_prepare_gadget
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ local snap_id version gadget_snap
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ snap_id=UqFziVZDHLSyO3TqSWgNBoAdHbLI4dAH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'pc_*.snap'
+ existing_snap=/tmp/extra-snaps/pc_24-0.2_amd64.snap
+ '[' -n /tmp/extra-snaps/pc_24-0.2_amd64.snap ']'
+ echo 'Using generated pc gadget snap /tmp/extra-snaps/pc_24-0.2_amd64.snap'
Using generated pc gadget snap /tmp/extra-snaps/pc_24-0.2_amd64.snap
+ '[' true = true ']'
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-snap-installable --noack --extra-decl-json '' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir /tmp/extra-snaps/pc_24-0.2_amd64.snap UqFziVZDHLSyO3TqSWgNBoAdHbLI4dAH
Parallel unsquashfs: Using 2 processors
1 inodes (1 blocks) to write

[===================================================================|] 2/2 100%

created 1 file
created 2 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
'/tmp/extra-snaps/pc_24-0.2_amd64.snap' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir/pc_24-0.2_amd64.snap'
+ return
+ nested_prepare_base
+ '[' true = true ']'
+ nested_is_core_16_system
+ os.query is-xenial
+ nested_is_core_18_system
+ os.query is-bionic
+ nested_is_core_20_system
+ os.query is-focal
+ nested_is_core_22_system
+ os.query is-jammy
+ nested_is_core_24_system
+ os.query is-noble
+ snap_name=core24
+ snap_id=dwTAh7MZZ01zyriOZErqd1JynQLiOGvM
+ output_name=core24.snap
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'core24*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ '[' '!' -f /var/tmp/work-dir/assets/core24.snap ']'
+ echo 'Repacking core24 snap'
Repacking core24 snap
+ snap download --channel=edge --basename=core24 core24
Fetching snap "core24"
Fetching assertions for "core24"
Install the snap with:
snap ack core24.assert
snap install core24.snap
+ repack_core_snap_with_tweaks core24.snap new-core24.snap
+ local CORESNAP=core24.snap
+ local TARGET=new-core24.snap
+ local UNPACK_DIR
++ mktemp -d /tmp/core-unpack.XXXXXXXX
+ UNPACK_DIR=/tmp/core-unpack.3qKgQZBH
+ unsquashfs -no-progress -f -d /tmp/core-unpack.3qKgQZBH core24.snap
Parallel unsquashfs: Using 2 processors
9250 inodes (8496 blocks) to write


created 7574 files
created 1387 directories
created 1669 symlinks
created 4 devices
created 0 fifos
created 0 sockets
created 3 hardlinks
+ mkdir -p /tmp/core-unpack.3qKgQZBH/etc/systemd/journald.conf.d
+ cat
+ mkdir -p /tmp/core-unpack.3qKgQZBH/etc/systemd/system/snapd.service.d
+ cat
+ '[' false = true ']'
+ cp /home/gopath/src/github.com/snapcore/snapd/data/completion/bash/complete.sh /tmp/core-unpack.3qKgQZBH/usr/lib/snapd/complete.sh
+ snap pack --filename=new-core24.snap /tmp/core-unpack.3qKgQZBH
built: new-core24.snap
+ rm -rf /tmp/core-unpack.3qKgQZBH
+ rm -f core24.snap core24.assert
+ mv new-core24.snap /var/tmp/work-dir/assets/core24.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/core24.snap /tmp/extra-snaps/core24.snap
+ '[' true = true ']'
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-snap-installable --noack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir /tmp/extra-snaps/core24.snap dwTAh7MZZ01zyriOZErqd1JynQLiOGvM
Parallel unsquashfs: Using 2 processors
1 inodes (1 blocks) to write

[===================================================================|] 2/2 100%

created 1 file
created 2 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
'/tmp/extra-snaps/core24.snap' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir/core24.snap'
+ local NESTED_MODEL
++ nested_get_model
++ '[' -n '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-signed.model' ']'
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ echo '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-signed.model'
++ sed 's/{VERSION}/24/g'
++ return
+ NESTED_MODEL=/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-24-signed.model
+ local EXTRA_SNAPS=
++ nested_get_extra_snaps
++ nested_get_extra_containers snap
++ local SUFFIX=snap
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.snap'
++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/pc-kernel.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/snapd_from_ci.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/core24.snap
++ IFS=
++ read -r mysnap
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap'
++ nested_get_extra_comps
++ nested_get_extra_containers comp
++ local SUFFIX=comp
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.comp'
+ '[' -n '' ']'
+ SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ export SNAPPY_FORCE_SAS_URL
+ UBUNTU_IMAGE_SNAP_CMD=/usr/bin/snap
+ export UBUNTU_IMAGE_SNAP_CMD
+ '[' -n '' ']'
+ UBUNTU_IMAGE_CHANNEL_ARG=
+ declare -a UBUNTU_IMAGE_PRESEED_ARGS
+ '[' -n '' ']'
+ SNAPD_DEBUG=1
+ /home/gopath/bin/ubuntu-image snap --image-size 10G --validation=enforce /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-24-signed.model '' --output-dir /var/tmp/work-dir/images --sector-size 512 --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap
+ tee /var/tmp/work-dir/logs/ubuntu-image.log
[0] prepare_image
[1] load_gadget_yaml
[2] set_artifact_names
[3] populate_rootfs_contents
[4] generate_disk_info
[5] calculate_rootfs_size
[6] populate_bootfs_contents
[7] populate_prepare_partitions
WARNING: No mkfs configuration found for this series: 16.04. Will fallback on the default one.
[8] make_disk
[9] generate_snap_manifest
Build successful
+ local IMAGE_BASE_NAME
++ nested_get_image_name_base core
++ local TYPE=core
++ local SOURCE=
++ local NAME=unset
++ local VERSION
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ '[' unset = unset ']'
+++ basename tests/nested/manual/core20-cloud-init-maas-signed-seed-data
++ NAME=core20-cloud-init-maas-signed-seed-data
++ '[' -n gadgetwithoutopinion ']'
++ NAME=core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion
++ '[' true = true ']'
++ SOURCE=custom
+++ nested_get_extra_snaps
+++ nested_get_extra_containers snap
+++ wc -l
+++ local SUFFIX=snap
+++ local EXTRA_SNAPS_PATH
++++ nested_get_extra_snaps_path
++++ echo /tmp/extra-snaps
+++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
+++ '[' -d /tmp/extra-snaps ']'
+++ IFS=
+++ read -r mysnap
++++ find /tmp/extra-snaps -name '*.snap'
+++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/pc-kernel.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/snapd_from_ci.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/core24.snap
+++ IFS=
+++ read -r mysnap
++ '[' 4 '!=' 0 ']'
++ SOURCE=custom
++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion
+ IMAGE_BASE_NAME=ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion
+ find /var/tmp/work-dir/images/ -maxdepth 1 -name '*.img'
+ read -r imgname
++ basename /var/tmp/work-dir/images/pc.img .img
+ volname=pc
+ mv /var/tmp/work-dir/images/pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion-pc.img
+ read -r imgname
+ local BOOTVOLUME
+ BOOTVOLUME=pc
+ '[' -e pc-gadget/meta/gadget.yaml ']'
+ ln -s /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ unset SNAPPY_FORCE_SAS_URL
+ unset UBUNTU_IMAGE_SNAP_CMD
+ nested_configure_default_user
+ local IMAGE_NAME
+ local IMAGE_PATH
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/core20-cloud-init-maas-signed-seed-data
+++ NAME=core20-cloud-init-maas-signed-seed-data
+++ '[' -n gadgetwithoutopinion ']'
+++ NAME=core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ wc -l
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/snapd_from_ci.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/core24.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 4 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion
++ BASE_NAME=ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion
++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ IMAGE_NAME=ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
++ realpath /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ IMAGE_PATH=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion-pc.img
+ '[' false = true ']'
+ nested_create_assertions_disk
+ mkdir -p /var/tmp/work-dir/assets
+ local ASSERTIONS_DISK LOOP_DEV
+ ASSERTIONS_DISK=/var/tmp/work-dir/assets/assertions.disk
+ dd if=/dev/null of=/var/tmp/work-dir/assets/assertions.disk bs=1M seek=1
0+0 records in
0+0 records out
0 bytes copied, 2.3389e-05 s, 0.0 kB/s
+ printf 'o\nn\np\n1\n\n\nt\nc\nw\n'
+ fdisk /var/tmp/work-dir/assets/assertions.disk

Welcome to fdisk (util-linux 2.39.3).
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.

Device does not contain a recognized partition table.
Created a new DOS (MBR) disklabel with disk identifier 0xbd8d3493.

Command (m for help): Created a new DOS (MBR) disklabel with disk identifier 0x87357379.

Command (m for help): Partition type
p   primary (0 primary, 0 extended, 4 free)
e   extended (container for logical partitions)
Select (default p): Partition number (1-4, default 1): First sector (1-2047, default 1): Last sector, +/-sectors or +/-size{K,M,G,T,P} (1-2047, default 2047):
Created a new partition 1 of type 'Linux' and of size 1023.5 KiB.

Command (m for help): Selected partition 1
Hex code or alias (type L to list all): Changed type of partition 'Linux' to 'W95 FAT32 (LBA)'.

Command (m for help): The partition table has been altered.
Syncing disks.

+ kpartx -av /var/tmp/work-dir/assets/assertions.disk
add map loop2p1 (252:0): 0 2047 linear 7:2 1
++ losetup --list
++ grep /var/tmp/work-dir/assets/assertions.disk
++ awk '{print $1}'
++ grep -Po '/dev/loop\K([0-9]*)'
+ LOOP_DEV=2
+ retry -n 3 --wait 1 test -e /dev/mapper/loop2p1
+ mkfs.vfat -n SYSUSER /dev/mapper/loop2p1
mkfs.fat 4.2 (2021-01-31)
+ mkdir -p /var/tmp/work-dir/assets/sys-user-partition
+ mount /dev/mapper/loop2p1 /var/tmp/work-dir/assets/sys-user-partition
+ local AUTO_IMPORT_ASSERT
+ '[' -n '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-auto-import.assert' ']'
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ VERSION=24
++ echo '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-auto-import.assert'
++ sed 's/{VERSION}/24/g'
+ AUTO_IMPORT_ASSERT=/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-24-auto-import.assert
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-24-auto-import.assert /var/tmp/work-dir/assets/sys-user-partition/auto-import.assert
+ sudo umount /var/tmp/work-dir/assets/sys-user-partition
+ sudo kpartx -d /var/tmp/work-dir/assets/assertions.disk
+ cp -v /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion-pc.img.pristine
'/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion-pc.img.pristine'
+ exit
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/core20-cloud-init-maas-signed-seed-data
+++ NAME=core20-cloud-init-maas-signed-seed-data
+++ '[' -n gadgetwithoutopinion ']'
+++ NAME=core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/snapd_from_ci.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/core24.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 4 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion
++ BASE_NAME=ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion
++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ img=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img 50-cloudconfig-maas-cloud-config.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ local FILE=50-cloudconfig-maas-cloud-config.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ devloop=/dev/loop2
+ ubuntuSeedDev=/dev/loop2p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop2p2
+ '[' -b /dev/loop2p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.pFsCLXqNep
+ retry -n 5 --wait 2 mount /dev/loop2p2 /tmp/tmp.pFsCLXqNep
+ mkdir -p /tmp/tmp.pFsCLXqNep/data/etc/cloud/cloud.cfg.d/
+ cp -f 50-cloudconfig-maas-cloud-config.cfg /tmp/tmp.pFsCLXqNep/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.pFsCLXqNep
+ losetup -d /dev/loop2
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img 50-cloudconfig-maas-datasource.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ local FILE=50-cloudconfig-maas-datasource.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ devloop=/dev/loop2
+ ubuntuSeedDev=/dev/loop2p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop2p2
+ '[' -b /dev/loop2p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.PQKiDDF2uD
+ retry -n 5 --wait 2 mount /dev/loop2p2 /tmp/tmp.PQKiDDF2uD
+ mkdir -p /tmp/tmp.PQKiDDF2uD/data/etc/cloud/cloud.cfg.d/
+ cp -f 50-cloudconfig-maas-datasource.cfg /tmp/tmp.PQKiDDF2uD/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.PQKiDDF2uD
+ losetup -d /dev/loop2
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img 50-cloudconfig-maas-reporting.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ local FILE=50-cloudconfig-maas-reporting.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ devloop=/dev/loop2
+ ubuntuSeedDev=/dev/loop2p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop2p2
+ '[' -b /dev/loop2p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.InX9OUHGSf
+ retry -n 5 --wait 2 mount /dev/loop2p2 /tmp/tmp.InX9OUHGSf
+ mkdir -p /tmp/tmp.InX9OUHGSf/data/etc/cloud/cloud.cfg.d/
+ cp -f 50-cloudconfig-maas-reporting.cfg /tmp/tmp.InX9OUHGSf/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.InX9OUHGSf
+ losetup -d /dev/loop2
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img 50-cloudconfig-maas-ubuntu-sso.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ local FILE=50-cloudconfig-maas-ubuntu-sso.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ devloop=/dev/loop2
+ ubuntuSeedDev=/dev/loop2p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop2p2
+ '[' -b /dev/loop2p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.0x1YczwfCZ
+ retry -n 5 --wait 2 mount /dev/loop2p2 /tmp/tmp.0x1YczwfCZ
+ mkdir -p /tmp/tmp.0x1YczwfCZ/data/etc/cloud/cloud.cfg.d/
+ cp -f 50-cloudconfig-maas-ubuntu-sso.cfg /tmp/tmp.0x1YczwfCZ/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.0x1YczwfCZ
+ losetup -d /dev/loop2
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img 50-curtin-networking.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ local FILE=50-curtin-networking.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ devloop=/dev/loop2
+ ubuntuSeedDev=/dev/loop2p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop2p2
+ '[' -b /dev/loop2p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.hAkifsJLFa
+ retry -n 5 --wait 2 mount /dev/loop2p2 /tmp/tmp.hAkifsJLFa
+ mkdir -p /tmp/tmp.hAkifsJLFa/data/etc/cloud/cloud.cfg.d/
+ cp -f 50-curtin-networking.cfg /tmp/tmp.hAkifsJLFa/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.hAkifsJLFa
+ losetup -d /dev/loop2
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img 50-cloudconfig-gce-unsupported-config.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ local FILE=50-cloudconfig-gce-unsupported-config.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion.img
+ devloop=/dev/loop2
+ ubuntuSeedDev=/dev/loop2p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop2p2
+ '[' -b /dev/loop2p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.Z1nKvLGPN8
+ retry -n 5 --wait 2 mount /dev/loop2p2 /tmp/tmp.Z1nKvLGPN8
+ mkdir -p /tmp/tmp.Z1nKvLGPN8/data/etc/cloud/cloud.cfg.d/
+ cp -f 50-cloudconfig-gce-unsupported-config.cfg /tmp/tmp.Z1nKvLGPN8/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.Z1nKvLGPN8
+ losetup -d /dev/loop2
+ tests.nested create-vm core
'/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetwithoutopinion-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
'/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.enrolled.fd' -> '/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.current.fd'
error: no matching snaps installed
test-snapd-swtpm (edge) 0.1.0 from Test snaps (test-snaps-canonical) installed
retry: command test -S /var/snap/test-snapd-swtpm/current/swtpm-sock failed with code 1
retry: next attempt in 1.0 second(s) (attempt 1 of 10)
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
active
active
active
-----
.
2025-07-31 08:00:41 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system (jul310600-372865) : serial output saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_component-recovery-system.serial.log
2025-07-31 08:00:41 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system (jul310600-372865)...
##[error]2025-07-31 08:00:41 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system (jul310600-372865) : EOF
2025-07-31 08:00:41 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372865)...
##[error]2025-07-31 08:00:41 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372865) : EOF
2025-07-31 08:00:41 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:passphrase_auth (jul310600-372854) : serial output saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_muinstaller-core.serial.log
2025-07-31 08:00:41 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:passphrase_auth (jul310600-372854)...
##[error]2025-07-31 08:00:41 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:passphrase_auth (jul310600-372854) : EOF
2025-07-31 08:00:41 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372854)...
##[error]2025-07-31 08:00:41 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372854) : EOF
2025-07-31 08:00:41 Fetching artifacts...
2025-07-31 08:00:41 Fetching artifacts...
2025-07-31 08:00:41 Cannot copy contents EOF
2025-07-31 08:00:41 Restoring google-nested:ubuntu-24.04-64 (jul310600-372854)...
##[error]2025-07-31 08:00:41 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372854) : EOF
2025-07-31 08:00:41 Discarding google-nested:ubuntu-24.04-64 (jul310600-372854)...
2025-07-31 08:00:41 Cannot copy contents EOF
2025-07-31 08:00:41 Restoring google-nested:ubuntu-24.04-64 (jul310600-372865)...
##[error]2025-07-31 08:00:41 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372865) : EOF
2025-07-31 08:00:41 Discarding google-nested:ubuntu-24.04-64 (jul310600-372865)...
2025-07-31 08:00:41 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-above-testkeys-boot:secured (jul310600-372836) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-above-testkeys-boot:secured '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ '[' true = false ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-secured.model'
++ : '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-auto-import.assert'
++ : /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/fake-store-blobdir
++ : true
++ : false
++ : ''
++ : http://localhost:11028
++ : ''
++ : ''
++ : ''
++ : ''
++ : false
++ : 512
++ : 512
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state setup-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/fake-store-blobdir
Name                     Version  Publisher             Notes  Summary
test-snapd-tools         1.0      test-snaps-canonical  -      Tools for testing the snapd application
test-snapd-tools-core24  1.0      cachio                -      test snap with basic tools used to test snapd
test-snapd-tools-core22  1.0      cachio                -
test-snapd-tools-core20  1.0      test-snaps-canonical  -
test-snapd-tools-core18  1.0      test-snaps-canonical  -
Unit fakestore.service could not be found.
Running as unit: fakestore.service; invocation ID: 3adc9dffdc164acb92b7471860914bb6
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state teardown-staging-store
+ echo Expose the needed assertions through the fakestore
Expose the needed assertions through the fakestore
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/fake-store-blobdir/asserts
++ tests.nested download snakeoil-key
+ KEY_NAME=DB
+ SNAKEOIL_KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/DB.key
+ SNAKEOIL_CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/DB.pem
++ tests.nested show version
+ VERSION=24
+ snap download --basename=pc --channel=24/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ unsquashfs -d pc-gadget pc.snap
Parallel unsquashfs: Using 2 processors
19 inodes (43 blocks) to write

[=================================================================|] 62/62 100%

created 17 files
created 10 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
++ date '--date=next week' +%Y-%m-%dT%H:%M:%S%:z
+ sed defaults.yaml -e s/HOLD-TIME/2025-08-07T07:57:52+00:00/
+ mkdir -p pc-gadget/meta/hooks/
+ cp prepare-device pc-gadget/meta/hooks/
+ tests.nested secboot-sign gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/DB.pem
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
signature 1
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
Signing Unsigned original image
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
++ tests.nested get extra-snaps-path
+ snap pack pc-gadget/ /tmp/extra-snaps
built: /tmp/extra-snaps/pc_24-0.2_amd64.snap
+ rm -rf pc-gadget/
+ rm -f /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/DB.pem
+ systemd-run --collect --unit fakedevicesvc fakedevicesvc localhost:11029
Running as unit: fakedevicesvc.service; invocation ID: e81deaa881dc420eaa141febdd7dcdf6
+ tests.nested build-image core
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
+ local IMAGE_NAME
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/core20-grade-signed-above-testkeys-boot
+++ NAME=core20-grade-signed-above-testkeys-boot
+++ '[' -n secured ']'
+++ NAME=core20-grade-signed-above-testkeys-boot_secured
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 1 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-core20-grade-signed-above-testkeys-boot_secured
++ BASE_NAME=ubuntu-core-24-custom-core20-grade-signed-above-testkeys-boot_secured
++ echo ubuntu-core-24-custom-core20-grade-signed-above-testkeys-boot_secured.img
+ IMAGE_NAME=ubuntu-core-24-custom-core20-grade-signed-above-testkeys-boot_secured.img
+ mkdir -p /var/tmp/work-dir/images
+ '[' -f /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-grade-signed-above-testkeys-boot_secured.img ']'
+ '[' -n '' ']'
+ local UBUNTU_IMAGE=/home/gopath/bin/ubuntu-image
+ os.query is-xenial
+ os.query is-arm
+ '[' true = true ']'
+ nested_prepare_snapd
+ '[' true = true ']'
+ echo 'Repacking snapd snap'
Repacking snapd snap
+ local snap_name output_name snap_id
+ nested_is_core_16_system
+ os.query is-xenial
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename '/var/tmp/work-dir/assets/snapd_*.snap'
+ snap_name='snapd_*.snap'
+ break
+ '[' '!' -f '/var/tmp/work-dir/assets/snapd_*.snap' ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ build_snapd_snap /var/tmp/work-dir/assets
+ local TARGET
+ local snapd_snap_cache
+ TARGET=/var/tmp/work-dir/assets
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap /var/tmp/work-dir/assets/
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename /var/tmp/work-dir/assets/snapd_from_ci.snap
+ snap_name=snapd_from_ci.snap
+ break
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/snapd_from_ci.snap /tmp/extra-snaps/
+ '[' true = true ']'
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-snap-installable --noack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/fake-store-blobdir /tmp/extra-snaps/snapd_from_ci.snap PMrrV4ml8uWuEUDBT8dSGnKUYbevVhc4
Parallel unsquashfs: Using 2 processors
1 inodes (1 blocks) to write

[===================================================================|] 2/2 100%

created 1 file
created 2 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
'/tmp/extra-snaps/snapd_from_ci.snap' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/fake-store-blobdir/snapd_from_ci.snap'
+ nested_prepare_kernel
+ '[' true = true ']'
+ echo 'Repacking kernel snap'
Repacking kernel snap
+ local kernel_snap output_name snap_id version
+ output_name=pc-kernel.snap
+ snap_id=pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ '[' '!' -f /var/tmp/work-dir/assets/pc-kernel.snap ']'
+ nested_is_core_le 18
+ local VERSION=18
+ os.query is-ubuntu-le 18.04
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ snap download --basename=pc-kernel --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ local epochBumpTime
+ epochBumpTime=
+ '[' -n '' ']'
+ nested_is_core_24_system
+ os.query is-noble
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ uc24_build_initramfs_kernel_snap pc-kernel.snap /var/tmp/work-dir/assets ''
+ local ORIG_SNAP=pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=======/                                                    ]  2421/19159  12%
[===============-                                            ]  5124/19159  26%
[===================\                                        ]  6337/19159  33%
[=======================\                                    ]  7533/19159  39%
[=============================================|              ] 14921/19159  77%
[===========================================================|] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmpk4z4l_9hubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 603935      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:58:09.602069032 +0000
Modify: 2025-07-31 07:58:09.602069032 +0000
Change: 2025-07-31 07:58:09.602069032 +0000
Birth: 2025-07-31 07:58:09.602069032 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ rm -f pc-kernel.snap pc-kernel.assert
++ ls /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ kernel_snap=/var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ chmod 0600 /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets/pc-kernel.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc-kernel.snap /tmp/extra-snaps/pc-kernel.snap
+ '[' true = true ']'
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-snap-installable --noack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/fake-store-blobdir /tmp/extra-snaps/pc-kernel.snap pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
Parallel unsquashfs: Using 2 processors
1 inodes (1 blocks) to write

[===================================================================|] 2/2 100%

created 1 file
created 2 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
'/tmp/extra-snaps/pc-kernel.snap' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/fake-store-blobdir/pc-kernel.snap'
+ nested_prepare_gadget
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ local snap_id version gadget_snap
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ snap_id=UqFziVZDHLSyO3TqSWgNBoAdHbLI4dAH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'pc_*.snap'
+ existing_snap=/tmp/extra-snaps/pc_24-0.2_amd64.snap
+ '[' -n /tmp/extra-snaps/pc_24-0.2_amd64.snap ']'
+ echo 'Using generated pc gadget snap /tmp/extra-snaps/pc_24-0.2_amd64.snap'
Using generated pc gadget snap /tmp/extra-snaps/pc_24-0.2_amd64.snap
+ '[' true = true ']'
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-snap-installable --noack --extra-decl-json '' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/fake-store-blobdir /tmp/extra-snaps/pc_24-0.2_amd64.snap UqFziVZDHLSyO3TqSWgNBoAdHbLI4dAH
Parallel unsquashfs: Using 2 processors
1 inodes (1 blocks) to write

[===================================================================|] 2/2 100%

created 1 file
created 2 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
'/tmp/extra-snaps/pc_24-0.2_amd64.snap' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/fake-store-blobdir/pc_24-0.2_amd64.snap'
+ return
+ nested_prepare_base
+ '[' true = true ']'
+ nested_is_core_16_system
+ os.query is-xenial
+ nested_is_core_18_system
+ os.query is-bionic
+ nested_is_core_20_system
+ os.query is-focal
+ nested_is_core_22_system
+ os.query is-jammy
+ nested_is_core_24_system
+ os.query is-noble
+ snap_name=core24
+ snap_id=dwTAh7MZZ01zyriOZErqd1JynQLiOGvM
+ output_name=core24.snap
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'core24*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ '[' '!' -f /var/tmp/work-dir/assets/core24.snap ']'
+ echo 'Repacking core24 snap'
Repacking core24 snap
+ snap download --channel=edge --basename=core24 core24
Fetching snap "core24"
Fetching assertions for "core24"
Install the snap with:
snap ack core24.assert
snap install core24.snap
+ repack_core_snap_with_tweaks core24.snap new-core24.snap
+ local CORESNAP=core24.snap
+ local TARGET=new-core24.snap
+ local UNPACK_DIR
++ mktemp -d /tmp/core-unpack.XXXXXXXX
+ UNPACK_DIR=/tmp/core-unpack.Lht9jZE0
+ unsquashfs -no-progress -f -d /tmp/core-unpack.Lht9jZE0 core24.snap
Parallel unsquashfs: Using 2 processors
9250 inodes (8496 blocks) to write


created 7574 files
created 1387 directories
created 1669 symlinks
created 4 devices
created 0 fifos
created 0 sockets
created 3 hardlinks
+ mkdir -p /tmp/core-unpack.Lht9jZE0/etc/systemd/journald.conf.d
+ cat
+ mkdir -p /tmp/core-unpack.Lht9jZE0/etc/systemd/system/snapd.service.d
+ cat
+ '[' false = true ']'
+ cp /home/gopath/src/github.com/snapcore/snapd/data/completion/bash/complete.sh /tmp/core-unpack.Lht9jZE0/usr/lib/snapd/complete.sh
+ snap pack --filename=new-core24.snap /tmp/core-unpack.Lht9jZE0
built: new-core24.snap
+ rm -rf /tmp/core-unpack.Lht9jZE0
+ rm -f core24.snap core24.assert
+ mv new-core24.snap /var/tmp/work-dir/assets/core24.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/core24.snap /tmp/extra-snaps/core24.snap
+ '[' true = true ']'
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-snap-installable --noack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/fake-store-blobdir /tmp/extra-snaps/core24.snap dwTAh7MZZ01zyriOZErqd1JynQLiOGvM
Parallel unsquashfs: Using 2 processors
1 inodes (1 blocks) to write

[===================================================================|] 2/2 100%

created 1 file
created 2 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
'/tmp/extra-snaps/core24.snap' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-grade-signed-above-testkeys-boot/fake-store-blobdir/core24.snap'
+ local NESTED_MODEL
++ nested_get_model
++ '[' -n '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-secured.model' ']'
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ echo '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-secured.model'
++ sed 's/{VERSION}/24/g'
++ return
+ NESTED_MODEL=/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-24-secured.model
+ local EXTRA_SNAPS=
++ nested_get_extra_snaps
++ nested_get_extra_containers snap
++ local SUFFIX=snap
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.snap'
++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/pc-kernel.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/snapd_from_ci.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/core24.snap
++ IFS=
++ read -r mysnap
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap'
++ nested_get_extra_comps
++ nested_get_extra_containers comp
++ local SUFFIX=comp
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.comp'
+ '[' -n '' ']'
+ SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ export SNAPPY_FORCE_SAS_URL
+ UBUNTU_IMAGE_SNAP_CMD=/usr/bin/snap
+ export UBUNTU_IMAGE_SNAP_CMD
+ '[' -n '' ']'
+ UBUNTU_IMAGE_CHANNEL_ARG=
+ declare -a UBUNTU_IMAGE_PRESEED_ARGS
+ '[' -n '' ']'
+ SNAPD_DEBUG=1
+ /home/gopath/bin/ubuntu-image snap --image-size 10G --validation=enforce /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-24-secured.model '' --output-dir /var/tmp/work-dir/images --sector-size 512 --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap
+ tee /var/tmp/work-dir/logs/ubuntu-image.log
[0] prepare_image
-----
.
2025-07-31 08:00:42 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetwithoutopinion (jul310600-372870) : serial output saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_core20-cloud-init-maas-signed-seed-data.serial.log
2025-07-31 08:00:42 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetwithoutopinion (jul310600-372870)...
##[error]2025-07-31 08:00:42 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetwithoutopinion (jul310600-372870) : EOF
2025-07-31 08:00:42 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372870)...
##[error]2025-07-31 08:00:42 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372870) : EOF
2025-07-31 08:00:42 Fetching artifacts...
2025-07-31 08:00:42 Cannot copy contents EOF
2025-07-31 08:00:42 Restoring google-nested:ubuntu-24.04-64 (jul310600-372870)...
##[error]2025-07-31 08:00:42 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372870) : EOF
2025-07-31 08:00:42 Discarding google-nested:ubuntu-24.04-64 (jul310600-372870)...
2025-07-31 08:00:42 Error executing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:gadget_panic_remodel_boot_assets (jul310600-372880) :
-----
++ tests.nested show version
+ VERSION=24
+ SNAP=
+ REBOOT=false
+ SECOND_REBOOT=false
+ '[' panic = reboot ']'
+ case "$SPREAD_VARIANT" in
+ SNAP=pc
++ tests.nested boot-id
+ boot_id=d252c403-7ec7-4617-9c96-13323027ff6b
+ remote.push /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/valid-for-testing-pc-revno-2-24.model
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ remote.exec sudo snap remodel --no-wait valid-for-testing-pc-revno-2-24.model
+ change_id=4
+ '[' false = true ']'
+ '[' false = true ']'
+ echo 'And snap remodel is completed'
And snap remodel is completed
+ remote.exec 'snap watch 4'
2025-07-31T07:59:37Z INFO Task set to wait until a system restart allows to continue
snapd is about to reboot the system
+ retry --wait 1 -n 300 --env CHANGE_ID=4 --env SNAP=pc sh -c 'remote.exec snap changes | MATCH "${CHANGE_ID} .* (Done|Error) .*"'
grep error: pattern not found, got:

retry: command sh -c remote.exec snap changes | MATCH "${CHANGE_ID} .* (Done|Error) .*" failed with code 1
retry: next attempt in 1.0 second(s) (attempt 1 of 300)
Connection timed out during banner exchange
grep error: pattern not found, got:

retry: command sh -c remote.exec snap changes | MATCH "${CHANGE_ID} .* (Done|Error) .*" failed with code 1
retry: next attempt in 1.0 second(s) (attempt 2 of 300)
Connection timed out during banner exchange
grep error: pattern not found, got:

retry: command sh -c remote.exec snap changes | MATCH "${CHANGE_ID} .* (Done|Error) .*" failed with code 1
retry: next attempt in 1.0 second(s) (attempt 3 of 300)
Connection timed out during banner exchange
grep error: pattern not found, got:

retry: command sh -c remote.exec snap changes | MATCH "${CHANGE_ID} .* (Done|Error) .*" failed with code 1
retry: next attempt in 1.0 second(s) (attempt 4 of 300)
-----
.
2025-07-31 08:00:42 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-above-testkeys-boot:secured (jul310600-372836) : serial output saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_core20-grade-signed-above-testkeys-boot.serial.log
2025-07-31 08:00:42 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-above-testkeys-boot:secured (jul310600-372836)...
##[error]2025-07-31 08:00:42 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-above-testkeys-boot:secured (jul310600-372836) : EOF
2025-07-31 08:00:42 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372836)...
##[error]2025-07-31 08:00:42 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372836) : EOF
2025-07-31 08:00:42 Fetching artifacts...
2025-07-31 08:00:42 Cannot copy contents EOF
2025-07-31 08:00:42 Restoring google-nested:ubuntu-24.04-64 (jul310600-372836)...
##[error]2025-07-31 08:00:42 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372836) : EOF
2025-07-31 08:00:42 Discarding google-nested:ubuntu-24.04-64 (jul310600-372836)...
2025-07-31 08:00:42 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:kernel_reboot_remodel_boot_assets (jul310600-372875) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:kernel_reboot_remodel_boot_assets '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ tests.nested build-image core
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
+ local IMAGE_NAME
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/core20-fault-inject-on-remodel
+++ NAME=core20-fault-inject-on-remodel
+++ '[' -n kernel_reboot_remodel_boot_assets ']'
+++ NAME=core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
+++ '[' 0 '!=' 0 ']'
+++ echo ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets
++ BASE_NAME=ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets
++ echo ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets.img
+ IMAGE_NAME=ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets.img
+ mkdir -p /var/tmp/work-dir/images
+ '[' -f /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets.img ']'
+ '[' -n '' ']'
+ local UBUNTU_IMAGE=/home/gopath/bin/ubuntu-image
+ os.query is-xenial
+ os.query is-arm
+ '[' true = true ']'
+ nested_prepare_snapd
+ '[' true = true ']'
+ echo 'Repacking snapd snap'
Repacking snapd snap
+ local snap_name output_name snap_id
+ nested_is_core_16_system
+ os.query is-xenial
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename '/var/tmp/work-dir/assets/snapd_*.snap'
+ snap_name='snapd_*.snap'
+ break
+ '[' '!' -f '/var/tmp/work-dir/assets/snapd_*.snap' ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ build_snapd_snap /var/tmp/work-dir/assets
+ local TARGET
+ local snapd_snap_cache
+ TARGET=/var/tmp/work-dir/assets
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap /var/tmp/work-dir/assets/
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename /var/tmp/work-dir/assets/snapd_from_ci.snap
+ snap_name=snapd_from_ci.snap
+ break
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/snapd_from_ci.snap /tmp/extra-snaps/
+ '[' false = true ']'
+ nested_prepare_kernel
+ '[' true = true ']'
+ echo 'Repacking kernel snap'
Repacking kernel snap
+ local kernel_snap output_name snap_id version
+ output_name=pc-kernel.snap
+ snap_id=pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ '[' '!' -f /var/tmp/work-dir/assets/pc-kernel.snap ']'
+ nested_is_core_le 18
+ local VERSION=18
+ os.query is-ubuntu-le 18.04
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ snap download --basename=pc-kernel --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ local epochBumpTime
+ epochBumpTime=
+ '[' -n '' ']'
+ nested_is_core_24_system
+ os.query is-noble
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ uc24_build_initramfs_kernel_snap pc-kernel.snap /var/tmp/work-dir/assets ''
+ local ORIG_SNAP=pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=======|                                                    ]  2502/19159  13%
[===============-                                            ]  5132/19159  26%
[===================\                                        ]  6351/19159  33%
[=========================\                                  ]  8250/19159  43%
[=================================================|          ] 16108/19159  84%
[===========================================================|] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmpgr2m9c0_ubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 605371      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:54:14.920269175 +0000
Modify: 2025-07-31 07:54:14.920269175 +0000
Change: 2025-07-31 07:54:14.920269175 +0000
Birth: 2025-07-31 07:54:14.920269175 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ rm -f pc-kernel.snap pc-kernel.assert
++ ls /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ kernel_snap=/var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ chmod 0600 /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets/pc-kernel.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc-kernel.snap /tmp/extra-snaps/pc-kernel.snap
+ '[' false = true ']'
+ nested_prepare_gadget
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ local snap_id version gadget_snap
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ snap_id=UqFziVZDHLSyO3TqSWgNBoAdHbLI4dAH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'pc_*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ echo 'Repacking pc snap'
Repacking pc snap
+ local key_name snakeoil_key snakeoil_cert
++ nested_get_snakeoil_key
++ nested_ensure_ovmf
++ '[' -d /var/tmp/work-dir/assets/ovmf ']'
++ '[' -f /var/tmp/work-dir/assets/test-snapd-ovmf.snap ']'
++ snap download --channel=latest/edge test-snapd-ovmf --basename=test-snapd-ovmf --target-directory=/var/tmp/work-dir/assets
++ unsquashfs -d /var/tmp/work-dir/assets/ovmf /var/tmp/work-dir/assets/test-snapd-ovmf.snap
++ os.query is-arm
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.key DB.key
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.crt DB.pem
++ echo DB
+ key_name=DB
+ snakeoil_key=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.key
+ snakeoil_cert=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.pem
+ snap download --basename=pc --channel=24/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ unsquashfs -d pc-gadget pc.snap
Parallel unsquashfs: Using 2 processors
19 inodes (43 blocks) to write

[=================================================================|] 62/62 100%

created 17 files
created 10 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ nested_secboot_sign_gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.pem
+ local GADGET_DIR=pc-gadget
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.pem
+ '[' -f pc-gadget/fb.efi ']'
+ nested_secboot_sign_file pc-gadget/fb.efi /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/fb.efi
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/fb.efi
+ local FILE=pc-gadget/fb.efi
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/fb.efi
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.pem --output pc-gadget/fb.efi pc-gadget/fb.efi
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
Signing Unsigned original image
+ nested_secboot_sign_file pc-gadget/shim.efi.signed /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/shim.efi.signed
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/shim.efi.signed
+ local FILE=pc-gadget/shim.efi.signed
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.pem --output pc-gadget/shim.efi.signed pc-gadget/shim.efi.signed
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ case "${NESTED_UBUNTU_SAVE:-}" in
+ cat
+ local GADGET_EXTRA_CMDLINE=
+ '[' false = true ']'
+ os.query is-arm
+ '[' -n '' ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ '[' false = true ']'
+ snap pack pc-gadget/ /var/tmp/work-dir/assets
built: /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
++ ls /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
+ gadget_snap=/var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap /tmp/extra-snaps/pc.snap
+ rm -f pc.snap pc.assert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-fault-inject-on-remodel/DB.pem
+ '[' false = true ']'
+ nested_prepare_base
+ '[' true = true ']'
+ nested_is_core_16_system
+ os.query is-xenial
+ nested_is_core_18_system
+ os.query is-bionic
+ nested_is_core_20_system
+ os.query is-focal
+ nested_is_core_22_system
+ os.query is-jammy
+ nested_is_core_24_system
+ os.query is-noble
+ snap_name=core24
+ snap_id=dwTAh7MZZ01zyriOZErqd1JynQLiOGvM
+ output_name=core24.snap
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'core24*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ '[' '!' -f /var/tmp/work-dir/assets/core24.snap ']'
+ echo 'Repacking core24 snap'
Repacking core24 snap
+ snap download --channel=edge --basename=core24 core24
Fetching snap "core24"
Fetching assertions for "core24"
Install the snap with:
snap ack core24.assert
snap install core24.snap
+ repack_core_snap_with_tweaks core24.snap new-core24.snap
+ local CORESNAP=core24.snap
+ local TARGET=new-core24.snap
+ local UNPACK_DIR
++ mktemp -d /tmp/core-unpack.XXXXXXXX
+ UNPACK_DIR=/tmp/core-unpack.PCcv4NCK
+ unsquashfs -no-progress -f -d /tmp/core-unpack.PCcv4NCK core24.snap
Parallel unsquashfs: Using 2 processors
9250 inodes (8496 blocks) to write


created 7574 files
created 1387 directories
created 1669 symlinks
created 4 devices
created 0 fifos
created 0 sockets
created 3 hardlinks
+ mkdir -p /tmp/core-unpack.PCcv4NCK/etc/systemd/journald.conf.d
+ cat
+ mkdir -p /tmp/core-unpack.PCcv4NCK/etc/systemd/system/snapd.service.d
+ cat
+ '[' false = true ']'
+ cp /home/gopath/src/github.com/snapcore/snapd/data/completion/bash/complete.sh /tmp/core-unpack.PCcv4NCK/usr/lib/snapd/complete.sh
+ snap pack --filename=new-core24.snap /tmp/core-unpack.PCcv4NCK
built: new-core24.snap
+ rm -rf /tmp/core-unpack.PCcv4NCK
+ rm -f core24.snap core24.assert
+ mv new-core24.snap /var/tmp/work-dir/assets/core24.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/core24.snap /tmp/extra-snaps/core24.snap
+ '[' false = true ']'
+ local NESTED_MODEL
++ nested_get_model
++ '[' -n '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/valid-for-testing-pc-{VERSION}.model' ']'
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ echo '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/valid-for-testing-pc-{VERSION}.model'
++ sed 's/{VERSION}/24/g'
++ return
+ NESTED_MODEL=/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/valid-for-testing-pc-24.model
+ local EXTRA_SNAPS=
++ nested_get_extra_snaps
++ nested_get_extra_containers snap
++ local SUFFIX=snap
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.snap'
++ echo /tmp/extra-snaps/pc.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/pc-kernel.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/snapd_from_ci.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/core24.snap
++ IFS=
++ read -r mysnap
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap'
++ nested_get_extra_comps
++ nested_get_extra_containers comp
++ local SUFFIX=comp
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.comp'
+ '[' -n '' ']'
+ SNAPPY_FORCE_SAS_URL=
+ export SNAPPY_FORCE_SAS_URL
+ UBUNTU_IMAGE_SNAP_CMD=/usr/bin/snap
+ export UBUNTU_IMAGE_SNAP_CMD
+ '[' -n beta ']'
+ UBUNTU_IMAGE_CHANNEL_ARG='--channel beta'
+ declare -a UBUNTU_IMAGE_PRESEED_ARGS
+ '[' -n '' ']'
+ SNAPD_DEBUG=1
+ /home/gopath/bin/ubuntu-image snap --image-size 10G --validation=enforce /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/valid-for-testing-pc-24.model --channel beta '' --output-dir /var/tmp/work-dir/images --sector-size 512 --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap
+ tee /var/tmp/work-dir/logs/ubuntu-image.log
[0] prepare_image
WARNING: "snapd", "pc-kernel", "core24", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
[1] load_gadget_yaml
[2] set_artifact_names
[3] populate_rootfs_contents
[4] generate_disk_info
[5] calculate_rootfs_size
[6] populate_bootfs_contents
[7] populate_prepare_partitions
WARNING: No mkfs configuration found for this series: 16.04. Will fallback on the default one.
[8] make_disk
[9] generate_snap_manifest
Build successful
+ local IMAGE_BASE_NAME
++ nested_get_image_name_base core
++ local TYPE=core
++ local SOURCE=beta
++ local NAME=unset
++ local VERSION
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ '[' unset = unset ']'
+++ basename tests/nested/manual/core20-fault-inject-on-remodel
++ NAME=core20-fault-inject-on-remodel
++ '[' -n kernel_reboot_remodel_boot_assets ']'
++ NAME=core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets
++ '[' true = true ']'
++ SOURCE=custom
+++ nested_get_extra_snaps
+++ nested_get_extra_containers snap
+++ wc -l
+++ local SUFFIX=snap
+++ local EXTRA_SNAPS_PATH
++++ nested_get_extra_snaps_path
++++ echo /tmp/extra-snaps
+++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
+++ '[' -d /tmp/extra-snaps ']'
+++ IFS=
+++ read -r mysnap
++++ find /tmp/extra-snaps -name '*.snap'
+++ echo /tmp/extra-snaps/pc.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/pc-kernel.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/snapd_from_ci.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/core24.snap
+++ IFS=
+++ read -r mysnap
++ '[' 4 '!=' 0 ']'
++ SOURCE=custom
++ echo ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets
+ IMAGE_BASE_NAME=ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets
+ find /var/tmp/work-dir/images/ -maxdepth 1 -name '*.img'
+ read -r imgname
++ basename /var/tmp/work-dir/images/pc.img .img
+ volname=pc
+ mv /var/tmp/work-dir/images/pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets-pc.img
+ read -r imgname
+ local BOOTVOLUME
+ BOOTVOLUME=pc
+ '[' -e pc-gadget/meta/gadget.yaml ']'
++ gojq --yaml-input --raw-output '.volumes | to_entries[] | .key as $p | .value.structure[] | select(.name == "ubuntu-boot") | $p' pc-gadget/meta/gadget.yaml
+ BOOTVOLUME=pc
+ '[' -z pc ']'
+ ln -s /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets.img
+ unset SNAPPY_FORCE_SAS_URL
+ unset UBUNTU_IMAGE_SNAP_CMD
+ nested_configure_default_user
+ local IMAGE_NAME
+ local IMAGE_PATH
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/core20-fault-inject-on-remodel
+++ NAME=core20-fault-inject-on-remodel
+++ '[' -n kernel_reboot_remodel_boot_assets ']'
+++ NAME=core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ wc -l
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/snapd_from_ci.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/core24.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 4 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets
++ BASE_NAME=ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets
++ echo ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets.img
+ IMAGE_NAME=ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets.img
++ realpath /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets.img
+ IMAGE_PATH=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets-pc.img
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ nested_configure_cloud_init_on_core20_vm /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets-pc.img
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets-pc.img
+ nested_create_cloud_init_uc20_config /var/tmp/work-dir/assets/data.cfg
+ local CONFIG_PATH=/var/tmp/work-dir/assets/data.cfg
+ cat
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets-pc.img /var/tmp/work-dir/assets/data.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets-pc.img
+ local FILE=/var/tmp/work-dir/assets/data.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets-pc.img
+ devloop=/dev/loop1
+ ubuntuSeedDev=/dev/loop1p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop1p2
+ '[' -b /dev/loop1p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.cQ4FmkNTNc
+ retry -n 5 --wait 2 mount /dev/loop1p2 /tmp/tmp.cQ4FmkNTNc
+ mkdir -p /tmp/tmp.cQ4FmkNTNc/data/etc/cloud/cloud.cfg.d/
+ cp -f /var/tmp/work-dir/assets/data.cfg /tmp/tmp.cQ4FmkNTNc/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.cQ4FmkNTNc
+ losetup -d /dev/loop1
+ cp -v /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets-pc.img.pristine
'/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets-pc.img.pristine'
+ exit
+ tests.nested create-vm core
'/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-fault-inject-on-remodel_kernel_reboot_remodel_boot_assets-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
'/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.enrolled.fd' -> '/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.current.fd'
error: no matching snaps installed
test-snapd-swtpm (edge) 0.1.0 from Test snaps (test-snaps-canonical) installed
retry: command test -S /var/snap/test-snapd-swtpm/current/swtpm-sock failed with code 1
retry: next attempt in 1.0 second(s) (attempt 1 of 10)
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
active
active
active
active
active
active
-----
.
2025-07-31 08:00:42 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:gadget_panic_remodel_boot_assets (jul310600-372880) : serial output saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_core20-fault-inject-on-remodel.serial.log
2025-07-31 08:00:42 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:gadget_panic_remodel_boot_assets (jul310600-372880)...
##[error]2025-07-31 08:00:42 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:gadget_panic_remodel_boot_assets (jul310600-372880) : EOF
2025-07-31 08:00:42 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372880)...
##[error]2025-07-31 08:00:42 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372880) : EOF
2025-07-31 08:00:42 Fetching artifacts...
2025-07-31 08:00:42 Cannot copy contents EOF
2025-07-31 08:00:42 Restoring google-nested:ubuntu-24.04-64 (jul310600-372880)...
##[error]2025-07-31 08:00:42 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372880) : EOF
2025-07-31 08:00:42 Discarding google-nested:ubuntu-24.04-64 (jul310600-372880)...
2025-07-31 08:00:43 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:kernel_reboot_remodel_boot_assets (jul310600-372875) : serial output saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_core20-fault-inject-on-remodel.serial.log
2025-07-31 08:00:43 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:kernel_reboot_remodel_boot_assets (jul310600-372875)...
##[error]2025-07-31 08:00:43 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:kernel_reboot_remodel_boot_assets (jul310600-372875) : EOF
2025-07-31 08:00:43 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372875)...
##[error]2025-07-31 08:00:43 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372875) : EOF
2025-07-31 08:00:43 Fetching artifacts...
2025-07-31 08:00:43 Cannot copy contents EOF
2025-07-31 08:00:43 Restoring google-nested:ubuntu-24.04-64 (jul310600-372875)...
##[error]2025-07-31 08:00:43 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372875) : EOF
2025-07-31 08:00:43 Discarding google-nested:ubuntu-24.04-64 (jul310600-372875)...
2025-07-31 08:00:44 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2404 (jul310600-372889) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2404 '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ '[' true = false ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : true
++ : ''
++ : false
++ : 512
++ : 512
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state setup-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
Name                     Version  Publisher             Notes  Summary
test-snapd-tools         1.0      test-snaps-canonical  -      Tools for testing the snapd application
test-snapd-tools-core24  1.0      cachio                -      test snap with basic tools used to test snapd
test-snapd-tools-core22  1.0      cachio                -
test-snapd-tools-core20  1.0      test-snaps-canonical  -
test-snapd-tools-core18  1.0      test-snaps-canonical  -
Unit fakestore.service could not be found.
Running as unit: fakestore.service; invocation ID: 2626c1d4b9f143709882a38d092ac9ef
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/testrootorg-store.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir/asserts
+ export SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ snap download --basename=pc --channel=classic-24.04/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ snap download --basename=pc-kernel --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ uc24_build_initramfs_kernel_snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap /var/tmp/work-dir/assets
+ local ORIG_SNAP=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=======/                                                    ]  2390/19159  12%
[=================-                                          ]  5566/19159  29%
[===================\                                        ]  6339/19159  33%
[=========================\                                  ]  8174/19159  42%
[====================================================|       ] 16968/19159  88%
[===========================================================|] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmp6rjdk3e7ubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 605364      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:47:39.271265217 +0000
Modify: 2025-07-31 07:47:39.271265217 +0000
Change: 2025-07-31 07:47:39.271265217 +0000
Birth: 2025-07-31 07:47:39.271265217 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap pc-kernel.snap
+ '[' 24.04 = 25.04 ']'
+ model_version_string=2404
+ curl -q https://raw.githubusercontent.com/canonical/models/refs/heads/master/ubuntu-classic-2404-amd64-dangerous.json
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
Dload  Upload   Total   Spent    Left  Speed
0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100  2371  100  2371    0     0  19472      0 --:--:-- --:--:-- --:--:-- 19595
+ gojq 'del(.snaps[] | select(.name | test("^(pc|pc-kernel|core.*|snapd)$") | not))' classic.json
+ mv classic-tmp.json classic.json
+ gojq '."authority-id" = "developer1" | ."brand-id" = "developer1"' classic.json
+ mv classic-tmp.json classic.json
+ gendeveloper1 sign-model
+ cat
+ export HYBRID_SYSTEM_MK_ROOT_FS=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/prepare-rootfs.sh
+ HYBRID_SYSTEM_MK_ROOT_FS=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/prepare-rootfs.sh
+ [[ default == \d\e\f\a\u\l\t ]]
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/setup_nested_hybrid_system.sh --model classic.model --store-dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir --gadget pc.snap --gadget-assertion pc.assert --kernel pc-kernel.snap --kernel-assertion pc-kernel.assert --passphrase 'ubuntu test'
+ main --model classic.model --store-dir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir --gadget pc.snap --gadget-assertion pc.assert --kernel pc-kernel.snap --kernel-assertion pc-kernel.assert --passphrase 'ubuntu test'
+ local model_assertion=
+ local store_dir=
+ local gadget_snap=
+ local gadget_assertion=
+ local kernel_snap=
+ local kernel_assertion=
+ local label=classic
+ local disk=
+ local kern_mods_comp=
+ local passphrase=
+ local recovery_key_out=
+ extra_muinstaller_args=()
+ local extra_muinstaller_args
+ '[' 14 -gt 0 ']'
+ case "$1" in
+ model_assertion=classic.model
+ shift 2
+ '[' 12 -gt 0 ']'
+ case "$1" in
+ store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ shift 2
+ '[' 10 -gt 0 ']'
+ case "$1" in
+ gadget_snap=pc.snap
+ shift 2
+ '[' 8 -gt 0 ']'
+ case "$1" in
+ gadget_assertion=pc.assert
+ shift 2
+ '[' 6 -gt 0 ']'
+ case "$1" in
+ kernel_snap=pc-kernel.snap
+ shift 2
+ '[' 4 -gt 0 ']'
+ case "$1" in
+ kernel_assertion=pc-kernel.assert
+ shift 2
+ '[' 2 -gt 0 ']'
+ case "$1" in
+ passphrase='ubuntu test'
+ shift 2
+ '[' 0 -gt 0 ']'
+ '[' -z classic.model ']'
+ '[' -n pc-kernel.snap ']'
+ '[' -z pc-kernel.assert ']'
+ '[' -n pc-kernel.assert ']'
+ '[' -z pc-kernel.snap ']'
+ '[' -n pc.snap ']'
+ '[' -z pc.assert ']'
+ '[' -n pc.assert ']'
+ '[' -z pc.snap ']'
++ realpath classic.model
+ model_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model
+ '[' -n '' ']'
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir ']'
++ realpath /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ '[' -n pc.snap ']'
++ realpath pc.snap
+ gadget_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap
++ realpath pc.assert
+ gadget_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert
+ '[' -n pc-kernel.snap ']'
++ realpath pc-kernel.snap
+ kernel_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
++ realpath pc-kernel.assert
+ kernel_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert
+ '[' -n '' ']'
++ mktemp -d --tmpdir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid
+ cd /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl
+ '[' -z '' ']'
+ disk=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/disk.img
+ truncate --size=6G /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/disk.img
+ '[' -z /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap ']'
+ '[' -z /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap ']'
+ run_muinstaller /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert classic /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/disk.img '' 'ubuntu test' ''
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : ''
++ : ''
++ : /var/tmp/work-dir/fakestore/blobs
++ : false
++ : false
++ : ''
++ : ''
++ : ''
++ : ''
++ : true
++ : ''
++ : false
++ : 512
++ : 512
+ local model_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model
+ local store_dir=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
+ local gadget_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap
+ local gadget_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert
+ local kernel_snap=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap
+ local kernel_assertion=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert
+ local label=classic
+ local disk=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/disk.img
+ local kern_mods_comp=
+ local 'passphrase=ubuntu test'
+ local recovery_key_out=
+ shift 11
+ extra_muinstaller_args=()
+ local extra_muinstaller_args
+ snap ack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.assert
+ snap ack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.assert
+ local key_name
++ nested_get_snakeoil_key
++ nested_ensure_ovmf
++ '[' -d /var/tmp/work-dir/assets/ovmf ']'
++ '[' -f /var/tmp/work-dir/assets/test-snapd-ovmf.snap ']'
++ snap download --channel=latest/edge test-snapd-ovmf --basename=test-snapd-ovmf --target-directory=/var/tmp/work-dir/assets
++ unsquashfs -d /var/tmp/work-dir/assets/ovmf /var/tmp/work-dir/assets/test-snapd-ovmf.snap
++ os.query is-arm
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.key DB.key
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.crt DB.pem
++ echo DB
+ key_name=DB
+ local snakeoil_key=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.key
+ local snakeoil_cert=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.pem
+ unsquashfs -d pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc.snap
Parallel unsquashfs: Using 2 processors
14 inodes (37 blocks) to write

[=================================================================|] 51/51 100%

created 12 files
created 9 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ tests.nested secboot-sign gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.pem
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ snap pack --filename=pc.snap pc-gadget/
built: pc.snap
+ build_snapd_snap .
+ local TARGET
+ local snapd_snap_cache
+ TARGET=.
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ./
+ mv snapd_from_ci.snap snapd.snap
+ kmodsarg=
+ '[' -n '' ']'
+ snap prepare-image --classic --channel=edge --snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap --snap pc.snap --snap snapd.snap /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/classic.model ./classic-seed
Fetching core22 (2111)
WARNING: "snapd", "pc-kernel", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
Copying "snapd.snap" (snapd)
Copying "/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/pc-kernel.snap" (pc-kernel)
Copying "pc.snap" (pc)
+ mv ./classic-seed/system-seed/systems/20250731 ./classic-seed/system-seed/systems/classic
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir ']'
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state teardown-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
Failed to reset failed state of unit fakestore.service: Unit fakestore.service not loaded.
++ command -v snapcraft
+ '[' -z '' ']'
+ snap install snapcraft --candidate --classic
snapcraft (candidate) 8.10.2 from Canonical** installed
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/lxd-state prepare-snap
lxd-state: installing lxd snap
lxd (candidate) 6.4-25e10d4 from Canonical** installed
dpkg-query: no packages found matching lxd-client
lxd-state: initializing lxd
lxd-state: setting up proxy for lxc
To start your first container, try: lxc launch ubuntu:24.04
Or for a virtual machine: lxc launch ubuntu:24.04 --vm

+ cd /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller
+ snapcraft
Launching instance...
Creating new instance from remote
Creating new base instance from remote
Creating new instance from base instance
Starting instance
Initializing parts lifecycle
Installing build-packages
Installing build-snaps
Pulling muinstaller
Building muinstaller
:: + snapcraftctl build
:: Warning: use 'craftctl default' to execute the default step handler
:: + go mod download all
:: + go install -p 2 ./...
::
:: Users are encouraged to replace 'snapcraftctl' with 'craftctl' and use
:: 'CRAFT_*' environment variables in scriptlets when building snaps based
:: on core22. Please refer to the core22 migration guide for details.
:: + cp -a mk-classic-rootfs.sh /root/parts/muinstaller/install/bin
Staging muinstaller
Priming muinstaller
Extracting and updating metadata...
Copying snap assets...
Generating snap metadata...
Generated snap metadata
Reading snap metadata...
Running linters...
Running linter: classic
Running linter: library
Lint OK:
- classic: Snap confinement is set to classic.
Creating snap package...
Created snap package muinstaller_0.1_amd64.snap
+ local muinstaller_snap
++ find /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/ -maxdepth 1 -name '*.snap'
+ muinstaller_snap=/home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
+ tests.nested build-image classic
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
Dload  Upload   Total   Spent    Left  Speed
0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
 22  585M   22  129M    0     0   173M      0  0:00:03 --:--:--  0:00:03  173M
 54  585M   54  320M    0     0   183M      0  0:00:03  0:00:01  0:00:02  183M
 86  585M   86  504M    0     0   183M      0  0:00:03  0:00:02  0:00:01  183M
100  585M  100  585M    0     0   184M      0  0:00:03  0:00:03 --:--:--  184M
Image doesn't need to be decompressed
'/var/tmp/work-dir/images/ubuntu-classic-24-custom-passphrase-support-on-hybrid_2404.img' -> '/var/tmp/work-dir/images/ubuntu-classic-24-custom-passphrase-support-on-hybrid_2404.img.pristine'
+ NESTED_PARAM_EXTRA='-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
+ tests.nested create-vm classic --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
Image resized.
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
active
active
SSH connection ready
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
PATH=/writable/test-tools:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
[Service]
Environment=SNAPD_DEBUG=1 SNAPPY_TESTING=1 SNAPD_TRACE=1 SNAPD_JSON_LOGGING=1
SNAPD_DEBUG=1
SNAPD_TRACE=1
SNAPD_JSON_LOGGING=1
SNAP_LOG_TO_JOURNAL=1
+ for s in BOOT/BOOTX64.EFI ubuntu/shimx64.efi
+ remote.exec 'sudo cp -a /boot/efi/EFI/BOOT/BOOTX64.EFI /tmp'
++ basename BOOT/BOOTX64.EFI
+ remote.exec 'sudo chmod 755 /tmp/BOOTX64.EFI'
++ basename BOOT/BOOTX64.EFI
+ remote.pull /tmp/BOOTX64.EFI .
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename BOOT/BOOTX64.EFI
+ nested_secboot_sign_file BOOTX64.EFI /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=BOOTX64.EFI
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature BOOTX64.EFI
+ local FILE=BOOTX64.EFI
+ grep '^signature [0-9]*$'
+ sbverify --list BOOTX64.EFI
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove BOOTX64.EFI
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
+ sbverify --list BOOTX64.EFI
+ grep '^signature [0-9]*$'
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.pem --output BOOTX64.EFI BOOTX64.EFI
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
++ basename BOOT/BOOTX64.EFI
+ remote.push BOOTX64.EFI
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename BOOT/BOOTX64.EFI
+ remote.exec 'sudo mv BOOTX64.EFI /boot/efi/EFI/BOOT/BOOTX64.EFI'
mv: failed to preserve ownership for '/boot/efi/EFI/BOOT/BOOTX64.EFI': Operation not permitted
+ for s in BOOT/BOOTX64.EFI ubuntu/shimx64.efi
+ remote.exec 'sudo cp -a /boot/efi/EFI/ubuntu/shimx64.efi /tmp'
++ basename ubuntu/shimx64.efi
+ remote.exec 'sudo chmod 755 /tmp/shimx64.efi'
++ basename ubuntu/shimx64.efi
+ remote.pull /tmp/shimx64.efi .
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename ubuntu/shimx64.efi
+ nested_secboot_sign_file shimx64.efi /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=shimx64.efi
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature shimx64.efi
+ local FILE=shimx64.efi
+ sbverify --list shimx64.efi
+ grep '^signature [0-9]*$'
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove shimx64.efi
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
+ sbverify --list shimx64.efi
+ grep '^signature [0-9]*$'
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/DB.pem --output shimx64.efi shimx64.efi
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
++ basename ubuntu/shimx64.efi
+ remote.push shimx64.efi
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename ubuntu/shimx64.efi
+ remote.exec 'sudo mv shimx64.efi /boot/efi/EFI/ubuntu/shimx64.efi'
mv: failed to preserve ownership for '/boot/efi/EFI/ubuntu/shimx64.efi': Operation not permitted
+ remote.exec 'sudo sh -c '\''echo SNAPD_DEBUG=1 >> /etc/environment'\'''
+ remote.push /home/gopath/snapd_1337.2.70_amd64.deb
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
+ remote.exec 'sudo mv snapd_*.deb /var/lib/snapd/'
+ remote.exec 'sudo apt install -y /var/lib/snapd/snapd_*.deb'

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Reading state information...
Suggested packages:
zenity | kdialog
The following packages will be upgraded:
snapd
1 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Need to get 0 B/34.2 MB of archives.
After this operation, 11.4 MB of additional disk space will be used.
Get:1 /var/lib/snapd/snapd_1337.2.70_amd64.deb snapd amd64 1337.2.70 [34.2 MB]
debconf: unable to initialize frontend: Dialog
debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype
dpkg-preconfigure: unable to re-open stdin:
(Reading database ... 
(Reading database ... 5%
(Reading database ... 10%
(Reading database ... 15%
(Reading database ... 20%
(Reading database ... 25%
(Reading database ... 30%
(Reading database ... 35%
(Reading database ... 40%
(Reading database ... 45%
(Reading database ... 50%
(Reading database ... 55%
(Reading database ... 60%
(Reading database ... 65%
(Reading database ... 70%
(Reading database ... 75%
(Reading database ... 80%
(Reading database ... 85%
(Reading database ... 90%
(Reading database ... 95%
(Reading database ... 100%
(Reading database ... 74795 files and directories currently installed.)
Preparing to unpack .../snapd_1337.2.70_amd64.deb ...
Unpacking snapd (1337.2.70) over (2.67.1+24.04) ...
Setting up snapd (1337.2.70) ...
Installing new version of config file /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
snapd.failure.service is a disabled or a static unit not running, not starting it.
snapd.gpio-chardev-setup.target is a disabled or a static unit not running, not starting it.
snapd.snap-repair.service is a disabled or a static unit not running, not starting it.
Processing triggers for dbus (1.14.10-4ubuntu4.1) ...
Processing triggers for man-db (2.12.0-4build2) ...
debconf: unable to initialize frontend: Dialog
debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
+ sshpass -p ubuntu scp -r -P 8022 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no ./classic-seed/system-seed/ 'user1@localhost:~/install-seed'
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
+ remote.exec 'sudo mv /home/user1/install-seed /var/lib/snapd/'
+ tests.nested vm stop
+ sync
++ nested_get_image_name classic
++ local BASE_NAME
+++ nested_get_image_name_base classic
+++ local TYPE=classic
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/passphrase-support-on-hybrid
+++ NAME=passphrase-support-on-hybrid
+++ '[' -n 2404 ']'
+++ NAME=passphrase-support-on-hybrid_2404
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
+++ '[' 0 '!=' 0 ']'
+++ echo ubuntu-classic-24-custom-passphrase-support-on-hybrid_2404
++ BASE_NAME=ubuntu-classic-24-custom-passphrase-support-on-hybrid_2404
++ echo ubuntu-classic-24-custom-passphrase-support-on-hybrid_2404.img
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/passphrase-support-on-hybrid
+++ NAME=passphrase-support-on-hybrid
+++ '[' -n 2404 ']'
+++ NAME=passphrase-support-on-hybrid_2404
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
+++ '[' 0 '!=' 0 ']'
+++ echo ubuntu-core-24-custom-passphrase-support-on-hybrid_2404
++ BASE_NAME=ubuntu-core-24-custom-passphrase-support-on-hybrid_2404
++ echo ubuntu-core-24-custom-passphrase-support-on-hybrid_2404.img
+ qemu-img convert -f qcow2 -O raw /var/tmp/work-dir/images/ubuntu-classic-24-custom-passphrase-support-on-hybrid_2404.img /var/tmp/work-dir/images/ubuntu-core-24-custom-passphrase-support-on-hybrid_2404.img
+ local image_name
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/passphrase-support-on-hybrid
+++ NAME=passphrase-support-on-hybrid
+++ '[' -n 2404 ']'
+++ NAME=passphrase-support-on-hybrid_2404
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
+++ '[' 0 '!=' 0 ']'
+++ echo ubuntu-core-24-custom-passphrase-support-on-hybrid_2404
++ BASE_NAME=ubuntu-core-24-custom-passphrase-support-on-hybrid_2404
++ echo ubuntu-core-24-custom-passphrase-support-on-hybrid_2404.img
+ image_name=ubuntu-core-24-custom-passphrase-support-on-hybrid_2404.img
+ touch /var/tmp/work-dir/images/ubuntu-core-24-custom-passphrase-support-on-hybrid_2404.img.configured
+ tests.nested create-vm core --extra-param '-drive file=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/disk.img,if=none,snapshot=off,format=raw,id=disk2         -device virtio-blk-pci,drive=disk2,serial=target'
'/var/tmp/work-dir/images/ubuntu-core-24-custom-passphrase-support-on-hybrid_2404.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
'/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.enrolled.fd' -> '/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.current.fd'
error: no matching snaps installed
test-snapd-swtpm (edge) 0.1.0 from Test snaps (test-snaps-canonical) installed
retry: command test -S /var/snap/test-snapd-swtpm/current/swtpm-sock failed with code 1
retry: next attempt in 1.0 second(s) (attempt 1 of 10)
tests.systemd: unit service file already exist, it is going to be overwritten
Waiting the vm is ready to be used
active
active
SSH connection ready
[Service]
Environment=SNAPD_DEBUG=1 SNAPPY_TESTING=1 SNAPD_TRACE=1 SNAPD_JSON_LOGGING=1
SNAPD_DEBUG=1
SNAPD_TRACE=1
SNAPD_JSON_LOGGING=1
SNAP_LOG_TO_JOURNAL=1
status: disabled
+ remote.exec 'sudo mkdir -p /var/lib/snapd/seed'
+ remote.exec 'sudo mount -o bind /var/lib/snapd/install-seed /var/lib/snapd/seed'
+ remote.push /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
++ basename /home/gopath/src/github.com/snapcore/snapd/tests/lib/muinstaller/muinstaller_0.1_amd64.snap
+ remote.exec 'sudo snap install --classic --dangerous muinstaller_0.1_amd64.snap'
2025-07-31T07:56:29Z INFO Waiting for automatic snapd restart...
muinstaller 0.1 installed
+ local install_disk
++ remote.exec 'readlink -f /dev/disk/by-id/virtio-target'
+ install_disk=/dev/vda
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/prepare-rootfs.sh ']'
+ remote.push /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/prepare-rootfs.sh /home/user1/custom-rootfs.sh
Warning: Permanently added '[localhost]:8022' (ED25519) to the list of known hosts.
+ remote.exec 'chmod +x /home/user1/custom-rootfs.sh'
+ remote.exec 'tee /home/user1/mk-classic-rootfs-wrapper.sh'
#!/bin/bash
set -eu
/snap/muinstaller/current/bin/mk-classic-rootfs.sh "$@"
if [ -x /home/user1/custom-rootfs.sh ]; then
/home/user1/custom-rootfs.sh "$@"
fi
+ remote.exec 'chmod +x /home/user1/mk-classic-rootfs-wrapper.sh'
+ muinstaller_args=()
+ muinstaller_args+=("-label" "$label")
+ muinstaller_args+=("-device" "$install_disk")
+ muinstaller_args+=("-rootfs-creator" "/home/user1/mk-classic-rootfs-wrapper.sh")
+ '[' -n 'ubuntu test' ']'
+ muinstaller_args+=("-passphrase" "\"$passphrase\"")
+ '[' -n '' ']'
+ muinstaller_args+=("${extra_muinstaller_args[@]}")
+ remote.exec sudo muinstaller -label classic -device /dev/vda -rootfs-creator /home/user1/mk-classic-rootfs-wrapper.sh -passphrase '"ubuntu test"'
DEBUG: -- snap startup {"stage":"snap-confine enter", "time":"1753948602.408003"}
DEBUG: caps at startup: cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_setgid,cap_setuid,cap_sys_chroot,cap_sys_ptrace,cap_sys_admin,cap_sys_resource,cap_bpf=ep
DEBUG: ruid: 0, euid: 0, suid: 0
DEBUG: rgid: 0, egid: 0, sgid: 0
DEBUG: apparmor label on snap-confine is: /usr/lib/snapd/snap-confine
DEBUG: apparmor mode is: enforce
DEBUG: initial caps: cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_setgid,cap_setuid,cap_sys_chroot,cap_sys_ptrace,cap_sys_admin,cap_sys_resource,cap_bpf=ep
DEBUG: after setting privileged caps: cap_chown,cap_dac_override,cap_sys_admin=eip cap_dac_read_search,cap_fowner,cap_setgid,cap_setuid,cap_sys_chroot,cap_sys_ptrace,cap_sys_resource,cap_bpf+ep
DEBUG: the user is member of root group
DEBUG: SNAP_MOUNT_DIR (probed): /snap
DEBUG: security tag: snap.muinstaller.muinstaller
DEBUG: executable:   /usr/lib/snapd/snap-exec
DEBUG: confinement:  classic
DEBUG: base snap:    core22
DEBUG: umask reset, old umask was  022
DEBUG: -- snap startup {"stage":"snap-confine mount namespace start", "time":"1753948602.409009"}
DEBUG: preparing classic execution environment
DEBUG: -- snap startup {"stage":"snap-confine mount namespace finish", "time":"1753948602.409037"}
DEBUG: dropping caps
DEBUG: after dropping effective caps: cap_dac_override,cap_sys_admin=p
DEBUG: creating user data directory: /root/snap/muinstaller/x1
DEBUG: requesting changing of apparmor profile on next exec to snap.muinstaller.muinstaller
DEBUG: setting capabilities bounding set
DEBUG: drop caps as non-root? no
DEBUG: before seccomp: cap_sys_admin=ep cap_dac_override+p
DEBUG: loading bpf program for security tag snap.muinstaller.muinstaller
DEBUG: restore subset of capabilities for root
DEBUG: before exec to application: cap_dac_override=ep
DEBUG: execv(/usr/lib/snapd/snap-exec, /usr/lib/snapd/snap-exec...)
DEBUG:  argv[1] = muinstaller.muinstaller
DEBUG:  argv[2] = -label
DEBUG:  argv[3] = classic
DEBUG:  argv[4] = -device
DEBUG:  argv[5] = /dev/vda
DEBUG:  argv[6] = -rootfs-creator
DEBUG:  argv[7] = /home/user1/mk-classic-rootfs-wrapper.sh
DEBUG:  argv[8] = -passphrase
DEBUG:  argv[9] = ubuntu test
DEBUG: umask restored to  022
DEBUG: working directory restored to /home/user1
DEBUG: -- snap startup {"stage":"snap-confine to snap-exec", "time":"1753948602.409326"}
2025/07/31 07:56:43.022777 logger.go:289: DEBUG: -- snap startup {"stage":"snap-exec to app", "time":"1753948603.022773"}
2025/07/31 07:56:43.267680 main.go:557: installing on "/dev/vda"
2025/07/31 07:56:43.866182 main.go:454: detect encryption: &{Support:available Features:[passphrase-auth] StorageSafety:prefer-encrypted Type:cryptsetup UnavailableReason: AvailabilityCheckErrors:[]}
2025/07/31 07:56:44.430228 partition.go:98: DEBUG: create partitions on /dev/vda: /dev/vda1 : start=        2048, size=     1536000, type=C12A7328-F81F-11D2-BA4B-00A0C93EC93B, name="EFI System partition"
/dev/vda2 : start=     1538048, size=     1536000, type=0FC63DAF-8483-4772-8E79-3D69D8477DE4, name="ubuntu-boot"
/dev/vda3 : start=     3074048, size=       65536, type=0FC63DAF-8483-4772-8E79-3D69D8477DE4, name="ubuntu-save"
/dev/vda4 : start=     3139584, size=     9443295, type=0FC63DAF-8483-4772-8E79-3D69D8477DE4, name="ubuntu-data"
2025/07/31 07:56:45.002374 main.go:184: created 4 partitions
Change 6 created
2025/07/31 07:56:49.013452 main.go:377: DEBUG: making filesystem in "/dev/vda1"
2025/07/31 07:56:49.524072 main.go:377: DEBUG: making filesystem in "/dev/vda2"
2025/07/31 07:56:49.571879 main.go:377: DEBUG: making filesystem in "/dev/mapper/ubuntu-save"
2025/07/31 07:56:49.624864 main.go:377: DEBUG: making filesystem in "/dev/mapper/ubuntu-data"
2025/07/31 07:59:19.649386 main.go:297: DEBUG: partition to install: "/dev/vda1"
2025/07/31 07:59:19.649546 main.go:297: DEBUG: partition to install: "/dev/vda2"
2025/07/31 07:59:19.649558 main.go:297: DEBUG: partition to install: "/dev/vda3"
2025/07/31 07:59:19.649566 main.go:297: DEBUG: partition to install: "/dev/vda4"
Change 7 created
install done, please remove installation media and reboot
+ '[' -n '' ']'
+ remote.exec 'sudo sync'
+ tests.nested vm remove
active
enabled
Removed "/etc/systemd/system/multi-user.target.wants/nested-vm.service".
+ sync
+ mv /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/tmp.WsYMpcBOLl/disk.img /var/tmp/work-dir/images/ubuntu-core-24-custom-passphrase-support-on-hybrid_2404.img
+ image_path=/var/tmp/work-dir/images/ubuntu-core-24-custom-passphrase-support-on-hybrid_2404.img
+ kpartx -asv /var/tmp/work-dir/images/ubuntu-core-24-custom-passphrase-support-on-hybrid_2404.img
add map loop6p1 (252:0): 0 1536000 linear 7:6 2048
add map loop6p2 (252:1): 0 1536000 linear 7:6 1538048
add map loop6p3 (252:2): 0 65536 linear 7:6 3074048
add map loop6p4 (252:3): 0 9443295 linear 7:6 3139584
+ fatlabel /dev/disk/by-label/ubuntu-seed UBUNTU-SEED
+ kpartx -d /var/tmp/work-dir/images/ubuntu-core-24-custom-passphrase-support-on-hybrid_2404.img
+ '[' -n /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir ']'
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state setup-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/passphrase-support-on-hybrid/fake-store-blobdir
Name                     Version  Publisher             Notes  Summary
test-snapd-tools         1.0      test-snaps-canonical  -      Tools for testing the snapd application
test-snapd-tools-core24  1.0      cachio                -      test snap with basic tools used to test snapd
test-snapd-tools-core22  1.0      cachio                -
test-snapd-tools-core20  1.0      test-snaps-canonical  -
test-snapd-tools-core18  1.0      test-snaps-canonical  -
Unit fakestore.service could not be found.
Running as unit: fakestore.service; invocation ID: 3d7f1aa5707d4732a6e21c6c5c516cff
+ '[' -n 'ubuntu test' ']'
+ tests.nested create-vm core --keep-firmware-state --passphrase 'ubuntu test'
-----
.
2025-07-31 08:00:44 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetsaysnone (jul310600-372894) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetsaysnone '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ '[' true = false ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/nested.sh
++ : /var/tmp/work-dir
++ : /var/tmp/work-dir/images
++ : /var/tmp/work-dir/runtime
++ : /var/tmp/work-dir/assets
++ : /var/tmp/work-dir/logs
++ : amd64
++ : nested-vm
++ : 8022
++ : 8888
++ : '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-signed.model'
++ : '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-auto-import.assert'
++ : /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir
++ : true
++ : false
++ : ''
++ : http://localhost:11028
++ : ''
++ : ''
++ : ''
++ : ''
++ : false
++ : 512
++ : 512
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state setup-fake-store /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir
Name                     Version  Publisher             Notes  Summary
test-snapd-tools         1.0      test-snaps-canonical  -      Tools for testing the snapd application
test-snapd-tools-core24  1.0      cachio                -      test snap with basic tools used to test snapd
test-snapd-tools-core22  1.0      cachio                -
test-snapd-tools-core20  1.0      test-snaps-canonical  -
test-snapd-tools-core18  1.0      test-snaps-canonical  -
Unit fakestore.service could not be found.
Running as unit: fakestore.service; invocation ID: c230bcb867fe4f8998636d3ff300778d
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state teardown-staging-store
+ echo 'Expose the needed assertions through the fakestore'
Expose the needed assertions through the fakestore
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir/asserts
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1.account-key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir/asserts
++ nested_get_snakeoil_key
++ nested_ensure_ovmf
++ '[' -d /var/tmp/work-dir/assets/ovmf ']'
++ '[' -f /var/tmp/work-dir/assets/test-snapd-ovmf.snap ']'
++ snap download --channel=latest/edge test-snapd-ovmf --basename=test-snapd-ovmf --target-directory=/var/tmp/work-dir/assets
++ unsquashfs -d /var/tmp/work-dir/assets/ovmf /var/tmp/work-dir/assets/test-snapd-ovmf.snap
++ os.query is-arm
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.key DB.key
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.crt DB.pem
++ echo DB
+ KEY_NAME=DB
+ SNAKEOIL_KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key
+ SNAKEOIL_CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
++ tests.nested show version
+ VERSION=24
+ snap download --basename=pc --channel=24/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ unsquashfs -d pc-gadget pc.snap
Parallel unsquashfs: Using 2 processors
19 inodes (43 blocks) to write

[=================================================================|] 62/62 100%

created 17 files
created 10 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
++ date '--date=next week' +%Y-%m-%dT%H:%M:%S%:z
+ sed defaults.yaml -e s/@HOLD-TIME@/2025-08-07T07:55:42+00:00/
+ case "$GADGET_DATASOURCE" in
+ cp gadget-says-none.conf pc-gadget/cloud.conf
+ mkdir -p pc-gadget/meta/hooks/
+ cp prepare-device pc-gadget/meta/hooks/
+ nested_secboot_sign_gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ local GADGET_DIR=pc-gadget
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ '[' -f pc-gadget/fb.efi ']'
+ nested_secboot_sign_file pc-gadget/fb.efi /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/fb.efi
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/fb.efi
+ local FILE=pc-gadget/fb.efi
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/fb.efi
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem --output pc-gadget/fb.efi pc-gadget/fb.efi
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
Signing Unsigned original image
+ nested_secboot_sign_file pc-gadget/shim.efi.signed /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/shim.efi.signed
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/shim.efi.signed
+ local FILE=pc-gadget/shim.efi.signed
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem --output pc-gadget/shim.efi.signed pc-gadget/shim.efi.signed
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
++ tests.nested get extra-snaps-path
+ snap pack pc-gadget/ /tmp/extra-snaps
built: /tmp/extra-snaps/pc_24-0.2_amd64.snap
+ rm -rf pc-gadget/
+ rm -f /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/DB.pem
+ systemd-run --collect --unit fakedevicesvc fakedevicesvc localhost:11029
Running as unit: fakedevicesvc.service; invocation ID: e59830a3a8f048a9b7d028c62e7a946c
+ tests.nested build-image core
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
+ local IMAGE_NAME
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/core20-cloud-init-maas-signed-seed-data
+++ NAME=core20-cloud-init-maas-signed-seed-data
+++ '[' -n gadgetsaysnone ']'
+++ NAME=core20-cloud-init-maas-signed-seed-data_gadgetsaysnone
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
+++++ nested_get_extra_snaps_path
++++ wc -l
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 1 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone
++ BASE_NAME=ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone
++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ IMAGE_NAME=ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ mkdir -p /var/tmp/work-dir/images
+ '[' -f /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img ']'
+ '[' -n '' ']'
+ local UBUNTU_IMAGE=/home/gopath/bin/ubuntu-image
+ os.query is-xenial
+ os.query is-arm
+ '[' true = true ']'
+ nested_prepare_snapd
+ '[' true = true ']'
+ echo 'Repacking snapd snap'
Repacking snapd snap
+ local snap_name output_name snap_id
+ nested_is_core_16_system
+ os.query is-xenial
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename '/var/tmp/work-dir/assets/snapd_*.snap'
+ snap_name='snapd_*.snap'
+ break
+ '[' '!' -f '/var/tmp/work-dir/assets/snapd_*.snap' ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ build_snapd_snap /var/tmp/work-dir/assets
+ local TARGET
+ local snapd_snap_cache
+ TARGET=/var/tmp/work-dir/assets
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap /var/tmp/work-dir/assets/
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename /var/tmp/work-dir/assets/snapd_from_ci.snap
+ snap_name=snapd_from_ci.snap
+ break
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/snapd_from_ci.snap /tmp/extra-snaps/
+ '[' true = true ']'
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-snap-installable --noack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir /tmp/extra-snaps/snapd_from_ci.snap PMrrV4ml8uWuEUDBT8dSGnKUYbevVhc4
Parallel unsquashfs: Using 2 processors
1 inodes (1 blocks) to write

[===================================================================|] 2/2 100%

created 1 file
created 2 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
'/tmp/extra-snaps/snapd_from_ci.snap' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir/snapd_from_ci.snap'
+ nested_prepare_kernel
+ '[' true = true ']'
+ echo 'Repacking kernel snap'
Repacking kernel snap
+ local kernel_snap output_name snap_id version
+ output_name=pc-kernel.snap
+ snap_id=pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ '[' '!' -f /var/tmp/work-dir/assets/pc-kernel.snap ']'
+ nested_is_core_le 18
+ local VERSION=18
+ os.query is-ubuntu-le 18.04
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ snap download --basename=pc-kernel --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ local epochBumpTime
+ epochBumpTime=
+ '[' -n '' ']'
+ nested_is_core_24_system
+ os.query is-noble
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ uc24_build_initramfs_kernel_snap pc-kernel.snap /var/tmp/work-dir/assets ''
+ local ORIG_SNAP=pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=======/                                                    ]  2359/19159  12%
[================/                                           ]  5393/19159  28%
[===================\                                        ]  6344/19159  33%
[=========================-                                  ]  8178/19159  42%
[=====================================================|      ] 17214/19159  89%
[===========================================================|] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmpbflfw3y9ubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 607003      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:56:12.765556674 +0000
Modify: 2025-07-31 07:56:12.765556674 +0000
Change: 2025-07-31 07:56:12.765556674 +0000
Birth: 2025-07-31 07:56:12.765556674 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ rm -f pc-kernel.snap pc-kernel.assert
++ ls /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ kernel_snap=/var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ chmod 0600 /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets/pc-kernel.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc-kernel.snap /tmp/extra-snaps/pc-kernel.snap
+ '[' true = true ']'
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-snap-installable --noack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir /tmp/extra-snaps/pc-kernel.snap pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
Parallel unsquashfs: Using 2 processors
1 inodes (1 blocks) to write

[===================================================================|] 2/2 100%

created 1 file
created 2 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
'/tmp/extra-snaps/pc-kernel.snap' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir/pc-kernel.snap'
+ nested_prepare_gadget
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ local snap_id version gadget_snap
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ snap_id=UqFziVZDHLSyO3TqSWgNBoAdHbLI4dAH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'pc_*.snap'
+ existing_snap=/tmp/extra-snaps/pc_24-0.2_amd64.snap
+ '[' -n /tmp/extra-snaps/pc_24-0.2_amd64.snap ']'
+ echo 'Using generated pc gadget snap /tmp/extra-snaps/pc_24-0.2_amd64.snap'
Using generated pc gadget snap /tmp/extra-snaps/pc_24-0.2_amd64.snap
+ '[' true = true ']'
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-snap-installable --noack --extra-decl-json '' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir /tmp/extra-snaps/pc_24-0.2_amd64.snap UqFziVZDHLSyO3TqSWgNBoAdHbLI4dAH
Parallel unsquashfs: Using 2 processors
1 inodes (1 blocks) to write

[===================================================================|] 2/2 100%

created 1 file
created 2 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
'/tmp/extra-snaps/pc_24-0.2_amd64.snap' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir/pc_24-0.2_amd64.snap'
+ return
+ nested_prepare_base
+ '[' true = true ']'
+ nested_is_core_16_system
+ os.query is-xenial
+ nested_is_core_18_system
+ os.query is-bionic
+ nested_is_core_20_system
+ os.query is-focal
+ nested_is_core_22_system
+ os.query is-jammy
+ nested_is_core_24_system
+ os.query is-noble
+ snap_name=core24
+ snap_id=dwTAh7MZZ01zyriOZErqd1JynQLiOGvM
+ output_name=core24.snap
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'core24*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ '[' '!' -f /var/tmp/work-dir/assets/core24.snap ']'
+ echo 'Repacking core24 snap'
Repacking core24 snap
+ snap download --channel=edge --basename=core24 core24
Fetching snap "core24"
Fetching assertions for "core24"
Install the snap with:
snap ack core24.assert
snap install core24.snap
+ repack_core_snap_with_tweaks core24.snap new-core24.snap
+ local CORESNAP=core24.snap
+ local TARGET=new-core24.snap
+ local UNPACK_DIR
++ mktemp -d /tmp/core-unpack.XXXXXXXX
+ UNPACK_DIR=/tmp/core-unpack.2JtmVTlm
+ unsquashfs -no-progress -f -d /tmp/core-unpack.2JtmVTlm core24.snap
Parallel unsquashfs: Using 2 processors
9250 inodes (8496 blocks) to write


created 7574 files
created 1387 directories
created 1669 symlinks
created 4 devices
created 0 fifos
created 0 sockets
created 3 hardlinks
+ mkdir -p /tmp/core-unpack.2JtmVTlm/etc/systemd/journald.conf.d
+ cat
+ mkdir -p /tmp/core-unpack.2JtmVTlm/etc/systemd/system/snapd.service.d
+ cat
+ '[' false = true ']'
+ cp /home/gopath/src/github.com/snapcore/snapd/data/completion/bash/complete.sh /tmp/core-unpack.2JtmVTlm/usr/lib/snapd/complete.sh
+ snap pack --filename=new-core24.snap /tmp/core-unpack.2JtmVTlm
built: new-core24.snap
+ rm -rf /tmp/core-unpack.2JtmVTlm
+ rm -f core24.snap core24.assert
+ mv new-core24.snap /var/tmp/work-dir/assets/core24.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/core24.snap /tmp/extra-snaps/core24.snap
+ '[' true = true ']'
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/store-state make-snap-installable --noack /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir /tmp/extra-snaps/core24.snap dwTAh7MZZ01zyriOZErqd1JynQLiOGvM
Parallel unsquashfs: Using 2 processors
1 inodes (1 blocks) to write

[===================================================================|] 2/2 100%

created 1 file
created 2 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 0 hardlinks
'/tmp/extra-snaps/core24.snap' -> '/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/core20-cloud-init-maas-signed-seed-data/fake-store-blobdir/core24.snap'
+ local NESTED_MODEL
++ nested_get_model
++ '[' -n '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-signed.model' ']'
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ echo '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-signed.model'
++ sed 's/{VERSION}/24/g'
++ return
+ NESTED_MODEL=/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-24-signed.model
+ local EXTRA_SNAPS=
++ nested_get_extra_snaps
++ nested_get_extra_containers snap
++ local SUFFIX=snap
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.snap'
++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/pc-kernel.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/snapd_from_ci.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/core24.snap
++ IFS=
++ read -r mysnap
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap'
++ nested_get_extra_comps
++ nested_get_extra_containers comp
++ local SUFFIX=comp
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.comp'
+ '[' -n '' ']'
+ SNAPPY_FORCE_SAS_URL=http://localhost:11028
+ export SNAPPY_FORCE_SAS_URL
+ UBUNTU_IMAGE_SNAP_CMD=/usr/bin/snap
+ export UBUNTU_IMAGE_SNAP_CMD
+ '[' -n '' ']'
+ UBUNTU_IMAGE_CHANNEL_ARG=
+ declare -a UBUNTU_IMAGE_PRESEED_ARGS
+ '[' -n '' ']'
+ SNAPD_DEBUG=1
+ tee /var/tmp/work-dir/logs/ubuntu-image.log
+ /home/gopath/bin/ubuntu-image snap --image-size 10G --validation=enforce /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-24-signed.model '' --output-dir /var/tmp/work-dir/images --sector-size 512 --snap /tmp/extra-snaps/pc_24-0.2_amd64.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap
[0] prepare_image
[1] load_gadget_yaml
[2] set_artifact_names
[3] populate_rootfs_contents
[4] generate_disk_info
[5] calculate_rootfs_size
[6] populate_bootfs_contents
[7] populate_prepare_partitions
WARNING: No mkfs configuration found for this series: 16.04. Will fallback on the default one.
[8] make_disk
[9] generate_snap_manifest
Build successful
+ local IMAGE_BASE_NAME
++ nested_get_image_name_base core
++ local TYPE=core
++ local SOURCE=
++ local NAME=unset
++ local VERSION
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ '[' unset = unset ']'
+++ basename tests/nested/manual/core20-cloud-init-maas-signed-seed-data
++ NAME=core20-cloud-init-maas-signed-seed-data
++ '[' -n gadgetsaysnone ']'
++ NAME=core20-cloud-init-maas-signed-seed-data_gadgetsaysnone
++ '[' true = true ']'
++ SOURCE=custom
+++ nested_get_extra_snaps
+++ nested_get_extra_containers snap
+++ wc -l
+++ local SUFFIX=snap
+++ local EXTRA_SNAPS_PATH
++++ nested_get_extra_snaps_path
++++ echo /tmp/extra-snaps
+++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
+++ '[' -d /tmp/extra-snaps ']'
+++ IFS=
+++ read -r mysnap
++++ find /tmp/extra-snaps -name '*.snap'
+++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/pc-kernel.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/snapd_from_ci.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/core24.snap
+++ IFS=
+++ read -r mysnap
++ '[' 4 '!=' 0 ']'
++ SOURCE=custom
++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone
+ IMAGE_BASE_NAME=ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone
+ find /var/tmp/work-dir/images/ -maxdepth 1 -name '*.img'
+ read -r imgname
++ basename /var/tmp/work-dir/images/pc.img .img
+ volname=pc
+ mv /var/tmp/work-dir/images/pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone-pc.img
+ read -r imgname
+ local BOOTVOLUME
+ BOOTVOLUME=pc
+ '[' -e pc-gadget/meta/gadget.yaml ']'
+ ln -s /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ unset SNAPPY_FORCE_SAS_URL
+ unset UBUNTU_IMAGE_SNAP_CMD
+ nested_configure_default_user
+ local IMAGE_NAME
+ local IMAGE_PATH
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/core20-cloud-init-maas-signed-seed-data
+++ NAME=core20-cloud-init-maas-signed-seed-data
+++ '[' -n gadgetsaysnone ']'
+++ NAME=core20-cloud-init-maas-signed-seed-data_gadgetsaysnone
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ wc -l
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/snapd_from_ci.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/core24.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 4 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone
++ BASE_NAME=ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone
++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ IMAGE_NAME=ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
++ realpath /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ IMAGE_PATH=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone-pc.img
+ '[' false = true ']'
+ nested_create_assertions_disk
+ mkdir -p /var/tmp/work-dir/assets
+ local ASSERTIONS_DISK LOOP_DEV
+ ASSERTIONS_DISK=/var/tmp/work-dir/assets/assertions.disk
+ dd if=/dev/null of=/var/tmp/work-dir/assets/assertions.disk bs=1M seek=1
0+0 records in
0+0 records out
0 bytes copied, 2.4851e-05 s, 0.0 kB/s
+ fdisk /var/tmp/work-dir/assets/assertions.disk
+ printf 'o\nn\np\n1\n\n\nt\nc\nw\n'

Welcome to fdisk (util-linux 2.39.3).
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.

Device does not contain a recognized partition table.
Created a new DOS (MBR) disklabel with disk identifier 0x265f91e6.

Command (m for help): Created a new DOS (MBR) disklabel with disk identifier 0xfb93563a.

Command (m for help): Partition type
p   primary (0 primary, 0 extended, 4 free)
e   extended (container for logical partitions)
Select (default p): Partition number (1-4, default 1): First sector (1-2047, default 1): Last sector, +/-sectors or +/-size{K,M,G,T,P} (1-2047, default 2047):
Created a new partition 1 of type 'Linux' and of size 1023.5 KiB.

Command (m for help): Selected partition 1
Hex code or alias (type L to list all): Changed type of partition 'Linux' to 'W95 FAT32 (LBA)'.

Command (m for help): The partition table has been altered.
Syncing disks.

+ kpartx -av /var/tmp/work-dir/assets/assertions.disk
add map loop1p1 (252:0): 0 2047 linear 7:1 1
++ losetup --list
++ grep -Po '/dev/loop\K([0-9]*)'
++ awk '{print $1}'
++ grep /var/tmp/work-dir/assets/assertions.disk
+ LOOP_DEV=1
+ retry -n 3 --wait 1 test -e /dev/mapper/loop1p1
+ mkfs.vfat -n SYSUSER /dev/mapper/loop1p1
mkfs.fat 4.2 (2021-01-31)
+ mkdir -p /var/tmp/work-dir/assets/sys-user-partition
+ mount /dev/mapper/loop1p1 /var/tmp/work-dir/assets/sys-user-partition
+ local AUTO_IMPORT_ASSERT
+ '[' -n '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-auto-import.assert' ']'
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ VERSION=24
++ echo '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-{VERSION}-auto-import.assert'
++ sed 's/{VERSION}/24/g'
+ AUTO_IMPORT_ASSERT=/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-24-auto-import.assert
+ cp /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/developer1-24-auto-import.assert /var/tmp/work-dir/assets/sys-user-partition/auto-import.assert
+ sudo umount /var/tmp/work-dir/assets/sys-user-partition
+ sudo kpartx -d /var/tmp/work-dir/assets/assertions.disk
+ cp -v /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone-pc.img.pristine
'/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone-pc.img.pristine'
+ exit
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/core20-cloud-init-maas-signed-seed-data
+++ NAME=core20-cloud-init-maas-signed-seed-data
+++ '[' -n gadgetsaysnone ']'
+++ NAME=core20-cloud-init-maas-signed-seed-data_gadgetsaysnone
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
++++ wc -l
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc_24-0.2_amd64.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/snapd_from_ci.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/core24.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 4 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone
++ BASE_NAME=ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone
++ echo ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ img=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img 50-cloudconfig-maas-cloud-config.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ local FILE=50-cloudconfig-maas-cloud-config.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ devloop=/dev/loop1
+ ubuntuSeedDev=/dev/loop1p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop1p2
+ '[' -b /dev/loop1p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.3kfSfJbmd3
+ retry -n 5 --wait 2 mount /dev/loop1p2 /tmp/tmp.3kfSfJbmd3
+ mkdir -p /tmp/tmp.3kfSfJbmd3/data/etc/cloud/cloud.cfg.d/
+ cp -f 50-cloudconfig-maas-cloud-config.cfg /tmp/tmp.3kfSfJbmd3/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.3kfSfJbmd3
+ losetup -d /dev/loop1
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img 50-cloudconfig-maas-datasource.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ local FILE=50-cloudconfig-maas-datasource.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ devloop=/dev/loop1
+ ubuntuSeedDev=/dev/loop1p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop1p2
+ '[' -b /dev/loop1p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.TwJNG6WeQs
+ retry -n 5 --wait 2 mount /dev/loop1p2 /tmp/tmp.TwJNG6WeQs
+ mkdir -p /tmp/tmp.TwJNG6WeQs/data/etc/cloud/cloud.cfg.d/
+ cp -f 50-cloudconfig-maas-datasource.cfg /tmp/tmp.TwJNG6WeQs/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.TwJNG6WeQs
+ losetup -d /dev/loop1
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img 50-cloudconfig-maas-reporting.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ local FILE=50-cloudconfig-maas-reporting.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ devloop=/dev/loop1
+ ubuntuSeedDev=/dev/loop1p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop1p2
+ '[' -b /dev/loop1p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.2zoJ39y9Zo
+ retry -n 5 --wait 2 mount /dev/loop1p2 /tmp/tmp.2zoJ39y9Zo
+ mkdir -p /tmp/tmp.2zoJ39y9Zo/data/etc/cloud/cloud.cfg.d/
+ cp -f 50-cloudconfig-maas-reporting.cfg /tmp/tmp.2zoJ39y9Zo/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.2zoJ39y9Zo
+ losetup -d /dev/loop1
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img 50-cloudconfig-maas-ubuntu-sso.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ local FILE=50-cloudconfig-maas-ubuntu-sso.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ devloop=/dev/loop1
+ ubuntuSeedDev=/dev/loop1p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop1p2
+ '[' -b /dev/loop1p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.vvUZolRk7s
+ retry -n 5 --wait 2 mount /dev/loop1p2 /tmp/tmp.vvUZolRk7s
+ mkdir -p /tmp/tmp.vvUZolRk7s/data/etc/cloud/cloud.cfg.d/
+ cp -f 50-cloudconfig-maas-ubuntu-sso.cfg /tmp/tmp.vvUZolRk7s/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.vvUZolRk7s
+ losetup -d /dev/loop1
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img 50-curtin-networking.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ local FILE=50-curtin-networking.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ devloop=/dev/loop1
+ ubuntuSeedDev=/dev/loop1p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop1p2
+ '[' -b /dev/loop1p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.UwWN3uNQ0E
+ retry -n 5 --wait 2 mount /dev/loop1p2 /tmp/tmp.UwWN3uNQ0E
+ mkdir -p /tmp/tmp.UwWN3uNQ0E/data/etc/cloud/cloud.cfg.d/
+ cp -f 50-curtin-networking.cfg /tmp/tmp.UwWN3uNQ0E/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.UwWN3uNQ0E
+ losetup -d /dev/loop1
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img 50-cloudconfig-gce-unsupported-config.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ local FILE=50-cloudconfig-gce-unsupported-config.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone.img
+ devloop=/dev/loop1
+ ubuntuSeedDev=/dev/loop1p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop1p2
+ '[' -b /dev/loop1p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.KWQjB3bPCw
+ retry -n 5 --wait 2 mount /dev/loop1p2 /tmp/tmp.KWQjB3bPCw
+ mkdir -p /tmp/tmp.KWQjB3bPCw/data/etc/cloud/cloud.cfg.d/
+ cp -f 50-cloudconfig-gce-unsupported-config.cfg /tmp/tmp.KWQjB3bPCw/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.KWQjB3bPCw
+ losetup -d /dev/loop1
+ tests.nested create-vm core
'/var/tmp/work-dir/images/ubuntu-core-24-custom-core20-cloud-init-maas-signed-seed-data_gadgetsaysnone-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
'/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.enrolled.fd' -> '/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.current.fd'
error: no matching snaps installed
test-snapd-swtpm (edge) 0.1.0 from Test snaps (test-snaps-canonical) installed
retry: command test -S /var/snap/test-snapd-swtpm/current/swtpm-sock failed with code 1
retry: next attempt in 1.0 second(s) (attempt 1 of 10)
Created symlink /etc/systemd/system/multi-user.target.wants/nested-vm.service → /etc/systemd/system/nested-vm.service.
Waiting the vm is ready to be used
active
active
active
active
active
active
active
active
-----
.
2025-07-31 08:00:44 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetsaysnone (jul310600-372894) : EOF
2025-07-31 08:00:44 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetsaysnone (jul310600-372894)...
##[error]2025-07-31 08:00:44 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetsaysnone (jul310600-372894) : EOF
2025-07-31 08:00:44 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372894)...
##[error]2025-07-31 08:00:44 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372894) : EOF
2025-07-31 08:00:44 Fetching artifacts...
2025-07-31 08:00:44 Cannot copy contents EOF
2025-07-31 08:00:44 Restoring google-nested:ubuntu-24.04-64 (jul310600-372894)...
##[error]2025-07-31 08:00:44 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372894) : EOF
2025-07-31 08:00:44 Discarding google-nested:ubuntu-24.04-64 (jul310600-372894)...
2025-07-31 08:00:44 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2404 (jul310600-372889) : serial output saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_passphrase-support-on-hybrid.serial.log
2025-07-31 08:00:44 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2404 (jul310600-372889)...
##[error]2025-07-31 08:00:44 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2404 (jul310600-372889) : EOF
2025-07-31 08:00:44 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372889)...
##[error]2025-07-31 08:00:44 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372889) : EOF
2025-07-31 08:00:44 Fetching artifacts...
2025-07-31 08:00:44 Cannot copy contents EOF
2025-07-31 08:00:44 Restoring google-nested:ubuntu-24.04-64 (jul310600-372889)...
##[error]2025-07-31 08:00:44 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372889) : EOF
2025-07-31 08:00:44 Discarding google-nested:ubuntu-24.04-64 (jul310600-372889)...
2025-07-31 08:00:49 Error preparing google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:tested_and_default (jul310600-372884) :
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_project_each
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-suite-each
+ set -e
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
+ case "$1" in
+ prepare_suite_each full
+ local variant=full
+ touch /var/tmp/snapd-tools/runtime-state/runs
+ touch /var/tmp/snapd-tools/runtime-state/journalctl_cursor
+ dmesg --read-clear
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/fs-state start-monitor
+ os.query is-classic
+ tests.pkgs list-installed

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

+ tests.backup prepare
tar: Removing leading `/' from member names
+ echo -n 'google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:tested_and_default '
+ systemctl reset-failed systemd-journald.service
+ systemctl restart systemd-journald.service
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state start-new-log
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/tools/journal-state check-log-started
+ tests.nested is-nested
+ return 0
+ tests.nested prepare
+ os.query is-xenial
+ tests.nested build-image core
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
+ local IMAGE_NAME
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/recovery-system
+++ NAME=recovery-system
+++ '[' -n tested_and_default ']'
+++ NAME=recovery-system_tested_and_default
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ local SUFFIX=snap
++++ wc -l
++++ local EXTRA_SNAPS_PATH
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
+++ '[' 0 '!=' 0 ']'
+++ echo ubuntu-core-24-custom-recovery-system_tested_and_default
++ BASE_NAME=ubuntu-core-24-custom-recovery-system_tested_and_default
++ echo ubuntu-core-24-custom-recovery-system_tested_and_default.img
+ IMAGE_NAME=ubuntu-core-24-custom-recovery-system_tested_and_default.img
+ mkdir -p /var/tmp/work-dir/images
+ '[' -f /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default.img ']'
+ '[' -n '' ']'
+ local UBUNTU_IMAGE=/home/gopath/bin/ubuntu-image
+ os.query is-xenial
+ os.query is-arm
+ '[' true = true ']'
+ nested_prepare_snapd
+ '[' true = true ']'
+ echo 'Repacking snapd snap'
Repacking snapd snap
+ local snap_name output_name snap_id
+ nested_is_core_16_system
+ os.query is-xenial
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename '/var/tmp/work-dir/assets/snapd_*.snap'
+ snap_name='snapd_*.snap'
+ break
+ '[' '!' -f '/var/tmp/work-dir/assets/snapd_*.snap' ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ build_snapd_snap /var/tmp/work-dir/assets
+ local TARGET
+ local snapd_snap_cache
+ TARGET=/var/tmp/work-dir/assets
+ snapd_snap_cache=/var/tmp/work-dir/snapd_snap
+ mkdir -p /var/tmp/work-dir/snapd_snap
+ for snap in "${snapd_snap_cache}"/snapd_*.snap
+ '[' -f /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap ']'
+ break
+ cp /var/tmp/work-dir/snapd_snap/snapd_from_ci.snap /var/tmp/work-dir/assets/
+ for f in "${NESTED_ASSETS_DIR}"/snapd_*.snap
++ basename /var/tmp/work-dir/assets/snapd_from_ci.snap
+ snap_name=snapd_from_ci.snap
+ break
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/snapd_from_ci.snap /tmp/extra-snaps/
+ '[' false = true ']'
+ nested_prepare_kernel
+ '[' true = true ']'
+ echo 'Repacking kernel snap'
Repacking kernel snap
+ local kernel_snap output_name snap_id version
+ output_name=pc-kernel.snap
+ snap_id=pYVQrBcKmBa0mZ4CCN7ExT6jH8rY1hza
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ '[' '!' -f /var/tmp/work-dir/assets/pc-kernel.snap ']'
+ nested_is_core_le 18
+ local VERSION=18
+ os.query is-ubuntu-le 18.04
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ snap download --basename=pc-kernel --channel=24/beta pc-kernel
Fetching snap "pc-kernel"
Fetching assertions for "pc-kernel"
Install the snap with:
snap ack pc-kernel.assert
snap install pc-kernel.snap
+ local epochBumpTime
+ epochBumpTime=
+ '[' -n '' ']'
+ nested_is_core_24_system
+ os.query is-noble
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/state.sh
+++ SNAPD_STATE_PATH=/var/tmp/snapd-tools/snapd-state
+++ SNAPD_STATE_FILE=/var/tmp/snapd-tools/snapd-state/snapd-state.tar
+++ SNAPD_ACTIVE_UNITS=/var/tmp/snapd-tools/runtime-state/snapd-active-units
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/core-initrd.sh
+ uc24_build_initramfs_kernel_snap pc-kernel.snap /var/tmp/work-dir/assets ''
+ local ORIG_SNAP=pc-kernel.snap
+ local TARGET=/var/tmp/work-dir/assets
+ local OPT_ARG=
+ injectKernelPanic=false
+ case "$OPT_ARG" in
+ unsquashfs -d pc-kernel pc-kernel.snap
Parallel unsquashfs: Using 2 processors
8793 inodes (10366 blocks) to write

[=======/                                                    ]  2451/19159  12%
[=================-                                          ]  5724/19159  29%
[===================-                                        ]  6345/19159  33%
[=========================\                                  ]  8261/19159  43%
[=====================================================|      ] 17345/19159  90%
[===========================================================|] 19159/19159 100%

created 8754 files
created 1389 directories
created 38 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 1 hardlink
++ find pc-kernel/modules/ -maxdepth 1 -mindepth 1 -printf %f
+ kernelver=6.8.0-72-generic
+ ubuntu-core-initramfs create-initrd --kernelver=6.8.0-72-generic --kerneldir pc-kernel/modules/6.8.0-72-generic --firmwaredir pc-kernel/firmware --output initrd.img
module.alias: cannot find module nouveau
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module squashfs is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module kmod-nls-cp437 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dwc2 is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cryptomgr is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module dm_mod is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cbc is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xts is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c-bcm2708 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci-iproc not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module vc4 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module nvmem_mtk-efuse not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module mtk-pmic-wrap not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module =drivers/hid not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module xhci-pci-renesas exports symbols:
* symbol:renesas_xhci_check_request_fw
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module raid_class exports symbols:
* symbol:raid_class_attach
* symbol:raid_class_release
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module scsi_transport_sas exports symbols:
* symbol:sas_end_device_alloc
* symbol:sas_ata_ncq_prio_supported
* symbol:sas_port_get_phy
* symbol:sas_phy_delete
* symbol:scsi_is_sas_phy
* symbol:sas_release_transport
* symbol:sas_tlr_supported
* symbol:sas_rphy_unlink
* symbol:sas_remove_host
* symbol:sas_enable_tlr
* symbol:sas_attach_transport
* symbol:sas_expander_alloc
* symbol:sas_port_delete_phy
* symbol:sas_phy_alloc
* symbol:sas_read_port_mode_page
* symbol:sas_remove_children
* symbol:sas_port_add_phy
* symbol:sas_is_tlr_enabled
* symbol:sas_port_free
* symbol:scsi_is_sas_port
* symbol:sas_phy_add
* symbol:scsi_is_sas_rphy
* symbol:sas_port_delete
* symbol:sas_port_alloc
* symbol:sas_rphy_delete
* symbol:sas_rphy_free
* symbol:sas_rphy_add
* symbol:sas_phy_free
* symbol:sas_rphy_remove
* symbol:sas_port_mark_backlink
* symbol:sas_get_address
* symbol:sas_port_alloc_num
* symbol:sas_disable_tlr
* symbol:sas_port_add
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module ulpi exports symbols:
* symbol:ulpi_unregister_interface
* symbol:__ulpi_register_driver
* symbol:ulpi_write
* symbol:ulpi_read
* symbol:ulpi_register_interface
* symbol:ulpi_unregister_driver
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module sdhci_brcmstb not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module cqhci exports symbols:
* symbol:cqhci_irq
* symbol:cqhci_pltfm_init
* symbol:cqhci_resume
* symbol:cqhci_deactivate
* symbol:cqhci_init
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module rtc_rpi not found
WARNING: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module udc_core exports symbols:
* symbol:usb_gadget_set_selfpowered
* symbol:usb_initialize_gadget
* symbol:usb_ep_disable
* symbol:usb_gadget_vbus_disconnect
* symbol:usb_add_gadget_udc_release
* symbol:usb_gadget_vbus_connect
* symbol:usb_ep_clear_halt
* symbol:usb_ep_dequeue
* symbol:usb_gadget_clear_selfpowered
* symbol:usb_gadget_unmap_request
* symbol:usb_del_gadget
* symbol:usb_gadget_ep_match_desc
* symbol:usb_gadget_wakeup
* symbol:usb_gadget_deactivate
* symbol:gadget_find_ep_by_name
* symbol:usb_gadget_register_driver_owner
* symbol:usb_add_gadget_udc
* symbol:usb_gadget_udc_reset
* symbol:usb_gadget_vbus_draw
* symbol:usb_ep_fifo_flush
* symbol:usb_gadget_connect
* symbol:usb_ep_free_request
* symbol:usb_ep_alloc_request
* symbol:usb_gadget_unregister_driver
* symbol:usb_gadget_map_request
* symbol:usb_gadget_set_state
* symbol:usb_gadget_giveback_request
* symbol:usb_ep_queue
* symbol:usb_gadget_unmap_request_by_dev
* symbol:usb_gadget_set_remote_wakeup
* symbol:usb_ep_set_halt
* symbol:usb_del_gadget_udc
* symbol:usb_gadget_check_config
* symbol:usb_ep_set_maxpacket_limit
* symbol:usb_ep_set_wedge
* symbol:usb_udc_vbus_handler
* symbol:usb_get_gadget_udc_name
* symbol:usb_gadget_map_request_by_dev
* symbol:usb_add_gadget
* symbol:usb_ep_fifo_status
* symbol:usb_ep_enable
* symbol:usb_gadget_frame_number
* symbol:usb_gadget_activate
* symbol:usb_gadget_disconnect
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module reset_brcmstb_rescal not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module i2c_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module spi_bcm2835 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module gpio_brcmstb not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/main/extra-modules.conf: Module 8250_bcm7271 not found
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_scsi is builtin
NOTE: /usr/lib/ubuntu-core-initramfs/modules/server/extra-modules.conf: Module virtio_blk is builtin
iucode_tool: Writing selected microcodes to: /tmp/tmpxm2ercnyubuntu-core-initramfs/kernel/x86/microcode/GenuineIntel.bin
+ stat manifest-initramfs.yaml-6.8.0-72-generic
File: manifest-initramfs.yaml-6.8.0-72-generic
Size: 3025      	Blocks: 8          IO Block: 4096   regular file
Device: 8,1	Inode: 606366      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2025-07-31 07:55:51.483437319 +0000
Modify: 2025-07-31 07:55:51.483437319 +0000
Change: 2025-07-31 07:55:51.483437319 +0000
Birth: 2025-07-31 07:55:51.483437319 +0000
+ initrd_f=initrd.img-6.8.0-72-generic
+ unmkinitramfs initrd.img-6.8.0-72-generic initrd
+ '[' -d ./extra-initrd ']'
+ '[' -d ./initrd/early ']'
+ uc_write_bootstrap_wrapper ./initrd/main false
+ local SKELETON_PATH=./initrd/main
+ local INJECT_ERR=false
+ cp -a /usr/lib/snapd/snap-bootstrap ./initrd/main/usr/lib/snapd/snap-bootstrap.real
+ cat
+ '[' false = true ']'
+ chmod +x ./initrd/main/usr/lib/snapd/snap-bootstrap
+ cd ./initrd/early
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ cd ./initrd/main
+ find .
+ cpio --create --quiet --format=newc --owner=0:0
+ zstd -1 -T0
+ objcopy -O binary -j .linux pc-kernel/kernel.efi linux-6.8.0-72-generic
+ ubuntu-core-initramfs create-efi --kernelver=6.8.0-72-generic --initrd initrd.img --kernel linux --output kernel.efi
Wrote unsigned kernel.efi-6.8.0-72-generic
Signing Unsigned original image
+ cp kernel.efi-6.8.0-72-generic pc-kernel/kernel.efi
+ '[' -d ./extra-kernel-snap/ ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ snap pack pc-kernel
built: pc-kernel_6.8.0-72.72_amd64.snap
++ pwd
+ '[' /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system '!=' /var/tmp/work-dir/assets ']'
+ mv pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets
+ rm -rf pc-kernel
+ rm -f pc-kernel.snap pc-kernel.assert
++ ls /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ kernel_snap=/var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ chmod 0600 /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap
+ mv /var/tmp/work-dir/assets/pc-kernel_6.8.0-72.72_amd64.snap /var/tmp/work-dir/assets/pc-kernel.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc-kernel.snap /tmp/extra-snaps/pc-kernel.snap
+ '[' false = true ']'
+ nested_prepare_gadget
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ local snap_id version gadget_snap
++ nested_get_version
++ nested_is_core_16_system
++ os.query is-xenial
++ nested_is_core_18_system
++ os.query is-bionic
++ nested_is_core_20_system
++ os.query is-focal
++ nested_is_core_22_system
++ os.query is-jammy
++ nested_is_core_24_system
++ os.query is-noble
++ echo 24
+ version=24
+ snap_id=UqFziVZDHLSyO3TqSWgNBoAdHbLI4dAH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'pc_*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ echo 'Repacking pc snap'
Repacking pc snap
+ local key_name snakeoil_key snakeoil_cert
++ nested_get_snakeoil_key
++ nested_ensure_ovmf
++ '[' -d /var/tmp/work-dir/assets/ovmf ']'
++ '[' -f /var/tmp/work-dir/assets/test-snapd-ovmf.snap ']'
++ snap download --channel=latest/edge test-snapd-ovmf --basename=test-snapd-ovmf --target-directory=/var/tmp/work-dir/assets
++ unsquashfs -d /var/tmp/work-dir/assets/ovmf /var/tmp/work-dir/assets/test-snapd-ovmf.snap
++ os.query is-arm
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.key DB.key
++ cp /var/tmp/work-dir/assets/ovmf/secboot/DB.crt DB.pem
++ echo DB
+ key_name=DB
+ snakeoil_key=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.key
+ snakeoil_cert=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.pem
+ snap download --basename=pc --channel=24/edge pc
Fetching snap "pc"
Fetching assertions for "pc"
Install the snap with:
snap ack pc.assert
snap install pc.snap
+ unsquashfs -d pc-gadget pc.snap
Parallel unsquashfs: Using 2 processors
19 inodes (43 blocks) to write

[=================================================================|] 62/62 100%

created 17 files
created 10 directories
created 0 symlinks
created 0 devices
created 0 fifos
created 0 sockets
created 2 hardlinks
+ nested_secboot_sign_gadget pc-gadget /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.pem
+ local GADGET_DIR=pc-gadget
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.pem
+ '[' -f pc-gadget/fb.efi ']'
+ nested_secboot_sign_file pc-gadget/fb.efi /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/fb.efi
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/fb.efi
+ local FILE=pc-gadget/fb.efi
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/fb.efi
warning: data remaining[74120 vs 88344]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/fb.efi
+ grep '^signature [0-9]*$'
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.pem --output pc-gadget/fb.efi pc-gadget/fb.efi
warning: data remaining[72192 vs 86416]: gaps between PE/COFF sections?
Signing Unsigned original image
+ nested_secboot_sign_file pc-gadget/shim.efi.signed /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.pem
+ local keep_signatures
+ args=()
+ '[' 3 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 2 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 1 -gt 0 ']'
+ case "${1}" in
+ args+=("${1}")
+ shift
+ '[' 0 -gt 0 ']'
+ local FILE=pc-gadget/shim.efi.signed
+ local KEY=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.key
+ local CERT=/home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.pem
+ '[' '' '!=' set ']'
+ nested_secboot_remove_signature pc-gadget/shim.efi.signed
+ local FILE=pc-gadget/shim.efi.signed
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
signature 1
signature 2
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[842520 vs 968592]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
signature 1
+ sbattach --remove pc-gadget/shim.efi.signed
warning: data remaining[840592 vs 966664]: gaps between PE/COFF sections?
+ sbverify --list pc-gadget/shim.efi.signed
+ grep '^signature [0-9]*$'
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
No signature table present
+ sbsign --key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.key --cert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.pem --output pc-gadget/shim.efi.signed pc-gadget/shim.efi.signed
warning: data remaining[830976 vs 957048]: gaps between PE/COFF sections?
Signing Unsigned original image
+ case "${NESTED_UBUNTU_SAVE:-}" in
+ cat
+ local GADGET_EXTRA_CMDLINE=
+ '[' false = true ']'
+ os.query is-arm
+ '[' -n '' ']'
+ '[' -n '' ']'
+ '[' -n '' ']'
+ '[' false = true ']'
+ snap pack pc-gadget/ /var/tmp/work-dir/assets
built: /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
++ ls /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
+ gadget_snap=/var/tmp/work-dir/assets/pc_24-0.2_amd64.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/pc_24-0.2_amd64.snap /tmp/extra-snaps/pc.snap
+ rm -f pc.snap pc.assert /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.key /home/gopath/src/github.com/snapcore/snapd/tests/nested/manual/recovery-system/DB.pem
+ '[' false = true ']'
+ nested_prepare_base
+ '[' true = true ']'
+ nested_is_core_16_system
+ os.query is-xenial
+ nested_is_core_18_system
+ os.query is-bionic
+ nested_is_core_20_system
+ os.query is-focal
+ nested_is_core_22_system
+ os.query is-jammy
+ nested_is_core_24_system
+ os.query is-noble
+ snap_name=core24
+ snap_id=dwTAh7MZZ01zyriOZErqd1JynQLiOGvM
+ output_name=core24.snap
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ find /tmp/extra-snaps -name 'core24*.snap'
+ existing_snap=
+ '[' -n '' ']'
+ '[' '!' -f /var/tmp/work-dir/assets/core24.snap ']'
+ echo 'Repacking core24 snap'
Repacking core24 snap
+ snap download --channel=edge --basename=core24 core24
Fetching snap "core24"
Fetching assertions for "core24"
Install the snap with:
snap ack core24.assert
snap install core24.snap
+ repack_core_snap_with_tweaks core24.snap new-core24.snap
+ local CORESNAP=core24.snap
+ local TARGET=new-core24.snap
+ local UNPACK_DIR
++ mktemp -d /tmp/core-unpack.XXXXXXXX
+ UNPACK_DIR=/tmp/core-unpack.vVsLTq5c
+ unsquashfs -no-progress -f -d /tmp/core-unpack.vVsLTq5c core24.snap
Parallel unsquashfs: Using 2 processors
9250 inodes (8496 blocks) to write


created 7574 files
created 1387 directories
created 1669 symlinks
created 4 devices
created 0 fifos
created 0 sockets
created 3 hardlinks
+ mkdir -p /tmp/core-unpack.vVsLTq5c/etc/systemd/journald.conf.d
+ cat
+ mkdir -p /tmp/core-unpack.vVsLTq5c/etc/systemd/system/snapd.service.d
+ cat
+ '[' false = true ']'
+ cp /home/gopath/src/github.com/snapcore/snapd/data/completion/bash/complete.sh /tmp/core-unpack.vVsLTq5c/usr/lib/snapd/complete.sh
+ snap pack --filename=new-core24.snap /tmp/core-unpack.vVsLTq5c
built: new-core24.snap
+ rm -rf /tmp/core-unpack.vVsLTq5c
+ rm -f core24.snap core24.assert
+ mv new-core24.snap /var/tmp/work-dir/assets/core24.snap
++ nested_get_extra_snaps_path
++ echo /tmp/extra-snaps
+ cp /var/tmp/work-dir/assets/core24.snap /tmp/extra-snaps/core24.snap
+ '[' false = true ']'
+ local NESTED_MODEL
++ nested_get_model
++ '[' -n '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/test-snapd-recovery-system-pc-{VERSION}.model' ']'
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ echo '/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/test-snapd-recovery-system-pc-{VERSION}.model'
++ sed 's/{VERSION}/24/g'
++ return
+ NESTED_MODEL=/home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/test-snapd-recovery-system-pc-24.model
+ local EXTRA_SNAPS=
++ nested_get_extra_snaps
++ nested_get_extra_containers snap
++ local SUFFIX=snap
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.snap'
++ echo /tmp/extra-snaps/pc.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/pc-kernel.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/snapd_from_ci.snap
++ IFS=
++ read -r mysnap
++ echo /tmp/extra-snaps/core24.snap
++ IFS=
++ read -r mysnap
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap'
+ for mysnap in $(nested_get_extra_snaps)
+ EXTRA_SNAPS=' --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap'
++ nested_get_extra_comps
++ nested_get_extra_containers comp
++ local SUFFIX=comp
++ local EXTRA_SNAPS_PATH
+++ nested_get_extra_snaps_path
+++ echo /tmp/extra-snaps
++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++ '[' -d /tmp/extra-snaps ']'
++ IFS=
++ read -r mysnap
+++ find /tmp/extra-snaps -name '*.comp'
+ '[' -n '' ']'
+ SNAPPY_FORCE_SAS_URL=
+ export SNAPPY_FORCE_SAS_URL
+ UBUNTU_IMAGE_SNAP_CMD=/usr/bin/snap
+ export UBUNTU_IMAGE_SNAP_CMD
+ '[' -n beta ']'
+ UBUNTU_IMAGE_CHANNEL_ARG='--channel beta'
+ declare -a UBUNTU_IMAGE_PRESEED_ARGS
+ '[' -n '' ']'
+ SNAPD_DEBUG=1
+ /home/gopath/bin/ubuntu-image snap --image-size 10G --validation=enforce /home/gopath/src/github.com/snapcore/snapd/tests/lib/assertions/test-snapd-recovery-system-pc-24.model --channel beta '' --output-dir /var/tmp/work-dir/images --sector-size 512 --snap /tmp/extra-snaps/pc.snap --snap /tmp/extra-snaps/pc-kernel.snap --snap /tmp/extra-snaps/snapd_from_ci.snap --snap /tmp/extra-snaps/core24.snap
+ tee /var/tmp/work-dir/logs/ubuntu-image.log
[0] prepare_image
WARNING: "snapd", "pc-kernel", "core24", "pc" installed from local snaps disconnected from a store cannot be refreshed subsequently!
[1] load_gadget_yaml
[2] set_artifact_names
[3] populate_rootfs_contents
[4] generate_disk_info
[5] calculate_rootfs_size
[6] populate_bootfs_contents
[7] populate_prepare_partitions
WARNING: No mkfs configuration found for this series: 16.04. Will fallback on the default one.
[8] make_disk
[9] generate_snap_manifest
Build successful
+ local IMAGE_BASE_NAME
++ nested_get_image_name_base core
++ local TYPE=core
++ local SOURCE=beta
++ local NAME=unset
++ local VERSION
+++ nested_get_version
+++ nested_is_core_16_system
+++ os.query is-xenial
+++ nested_is_core_18_system
+++ os.query is-bionic
+++ nested_is_core_20_system
+++ os.query is-focal
+++ nested_is_core_22_system
+++ os.query is-jammy
+++ nested_is_core_24_system
+++ os.query is-noble
+++ echo 24
++ VERSION=24
++ '[' unset = unset ']'
+++ basename tests/nested/manual/recovery-system
++ NAME=recovery-system
++ '[' -n tested_and_default ']'
++ NAME=recovery-system_tested_and_default
++ '[' true = true ']'
++ SOURCE=custom
+++ nested_get_extra_snaps
+++ nested_get_extra_containers snap
+++ wc -l
+++ local SUFFIX=snap
+++ local EXTRA_SNAPS_PATH
++++ nested_get_extra_snaps_path
++++ echo /tmp/extra-snaps
+++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
+++ '[' -d /tmp/extra-snaps ']'
+++ IFS=
+++ read -r mysnap
++++ find /tmp/extra-snaps -name '*.snap'
+++ echo /tmp/extra-snaps/pc.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/pc-kernel.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/snapd_from_ci.snap
+++ IFS=
+++ read -r mysnap
+++ echo /tmp/extra-snaps/core24.snap
+++ IFS=
+++ read -r mysnap
++ '[' 4 '!=' 0 ']'
++ SOURCE=custom
++ echo ubuntu-core-24-custom-recovery-system_tested_and_default
+ IMAGE_BASE_NAME=ubuntu-core-24-custom-recovery-system_tested_and_default
+ find /var/tmp/work-dir/images/ -maxdepth 1 -name '*.img'
+ read -r imgname
++ basename /var/tmp/work-dir/images/pc.img .img
+ volname=pc
+ mv /var/tmp/work-dir/images/pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default-pc.img
+ read -r imgname
+ local BOOTVOLUME
+ BOOTVOLUME=pc
+ '[' -e pc-gadget/meta/gadget.yaml ']'
++ gojq --yaml-input --raw-output '.volumes | to_entries[] | .key as $p | .value.structure[] | select(.name == "ubuntu-boot") | $p' pc-gadget/meta/gadget.yaml
+ BOOTVOLUME=pc
+ '[' -z pc ']'
+ ln -s /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default.img
+ unset SNAPPY_FORCE_SAS_URL
+ unset UBUNTU_IMAGE_SNAP_CMD
+ nested_configure_default_user
+ local IMAGE_NAME
+ local IMAGE_PATH
++ nested_get_image_name core
++ local BASE_NAME
+++ nested_get_image_name_base core
+++ local TYPE=core
+++ local SOURCE=beta
+++ local NAME=unset
+++ local VERSION
++++ nested_get_version
++++ nested_is_core_16_system
++++ os.query is-xenial
++++ nested_is_core_18_system
++++ os.query is-bionic
++++ nested_is_core_20_system
++++ os.query is-focal
++++ nested_is_core_22_system
++++ os.query is-jammy
++++ nested_is_core_24_system
++++ os.query is-noble
++++ echo 24
+++ VERSION=24
+++ '[' unset = unset ']'
++++ basename tests/nested/manual/recovery-system
+++ NAME=recovery-system
+++ '[' -n tested_and_default ']'
+++ NAME=recovery-system_tested_and_default
+++ '[' true = true ']'
+++ SOURCE=custom
++++ nested_get_extra_snaps
++++ nested_get_extra_containers snap
++++ wc -l
++++ local SUFFIX=snap
++++ local EXTRA_SNAPS_PATH
+++++ nested_get_extra_snaps_path
+++++ echo /tmp/extra-snaps
++++ EXTRA_SNAPS_PATH=/tmp/extra-snaps
++++ '[' -d /tmp/extra-snaps ']'
++++ IFS=
++++ read -r mysnap
+++++ find /tmp/extra-snaps -name '*.snap'
++++ echo /tmp/extra-snaps/pc.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/pc-kernel.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/snapd_from_ci.snap
++++ IFS=
++++ read -r mysnap
++++ echo /tmp/extra-snaps/core24.snap
++++ IFS=
++++ read -r mysnap
+++ '[' 4 '!=' 0 ']'
+++ SOURCE=custom
+++ echo ubuntu-core-24-custom-recovery-system_tested_and_default
++ BASE_NAME=ubuntu-core-24-custom-recovery-system_tested_and_default
++ echo ubuntu-core-24-custom-recovery-system_tested_and_default.img
+ IMAGE_NAME=ubuntu-core-24-custom-recovery-system_tested_and_default.img
++ realpath /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default.img
+ IMAGE_PATH=/var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default-pc.img
+ '[' true = true ']'
+ nested_is_core_ge 20
+ local VERSION=20
+ os.query is-ubuntu-ge 20.04
+ nested_configure_cloud_init_on_core20_vm /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default-pc.img
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default-pc.img
+ nested_create_cloud_init_uc20_config /var/tmp/work-dir/assets/data.cfg
+ local CONFIG_PATH=/var/tmp/work-dir/assets/data.cfg
+ cat
+ nested_add_file_to_image /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default-pc.img /var/tmp/work-dir/assets/data.cfg
+ local IMAGE=/var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default-pc.img
+ local FILE=/var/tmp/work-dir/assets/data.cfg
+ local devloop ubuntuSeedDev tmp
++ retry -n 3 --wait 1 losetup -f --show -P --sector-size 512 /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default-pc.img
+ devloop=/dev/loop1
+ ubuntuSeedDev=/dev/loop1p2
+ os.query is-arm
+ retry -n 2 --wait 1 test -b /dev/loop1p2
+ '[' -b /dev/loop1p2 ']'
++ mktemp -d
+ tmp=/tmp/tmp.7CzXySrecD
+ retry -n 5 --wait 2 mount /dev/loop1p2 /tmp/tmp.7CzXySrecD
+ mkdir -p /tmp/tmp.7CzXySrecD/data/etc/cloud/cloud.cfg.d/
+ cp -f /var/tmp/work-dir/assets/data.cfg /tmp/tmp.7CzXySrecD/data/etc/cloud/cloud.cfg.d/
+ sync
+ umount /tmp/tmp.7CzXySrecD
+ losetup -d /dev/loop1
+ cp -v /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default-pc.img /var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default-pc.img.pristine
'/var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default-pc.img.pristine'
+ exit
+ tests.nested create-vm core
'/var/tmp/work-dir/images/ubuntu-core-24-custom-recovery-system_tested_and_default-pc.img' -> '/var/tmp/work-dir/images/ubuntu-core-current.img'
'/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.enrolled.fd' -> '/var/tmp/work-dir/assets/ovmf/fw/OVMF_VARS.current.fd'
error: no matching snaps installed
-----
.
2025-07-31 08:00:49 Error debugging google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:tested_and_default (jul310600-372884) : serial output saved to file spread-logs/google-nested_ubuntu-24.04-64_tests_nested_manual_recovery-system.serial.log
2025-07-31 08:00:49 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:tested_and_default (jul310600-372884)...
##[error]2025-07-31 08:00:49 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:tested_and_default (jul310600-372884) : EOF
2025-07-31 08:00:49 Restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372884)...
##[error]2025-07-31 08:00:49 Error restoring google-nested:ubuntu-24.04-64:tests/nested/manual/ (jul310600-372884) : EOF
2025-07-31 08:00:49 Fetching artifacts...
2025-07-31 08:00:49 Cannot copy contents EOF
2025-07-31 08:00:49 Restoring google-nested:ubuntu-24.04-64 (jul310600-372884)...
##[error]2025-07-31 08:00:49 Error restoring google-nested:ubuntu-24.04-64 (jul310600-372884) : EOF
2025-07-31 08:00:49 Discarding google-nested:ubuntu-24.04-64 (jul310600-372884)...
2025-07-31 08:00:50 Successful tasks: 142
2025-07-31 08:00:50 Aborted tasks: 25
2025-07-31 08:00:50 Failed tasks: 6
- google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-early-config
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:gadget_panic_remodel_boot_assets
- google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:install_optional_snap_and_comp
- google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:passphrase_auth
- google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:seeded
2025-07-31 08:00:50 Failed task prepare: 14
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-4k-sector-size:logical
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:gadgetextra
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetsaysnone
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetwithoutopinion
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:kernel_reboot_remodel_boot_assets
error: cannot copy contents: EOF
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-above-testkeys-boot:secured
- google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2404
- google-nested:ubuntu-24.04-64:tests/nested/manual/kernel-modules-components:encrypted
- google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2404
- google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2i
- google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:argon2id
- google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:pbkdf2
- google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:untested
- google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:tested_and_default
2025-07-31 08:00:50 Failed task restore: 14
- google-nested:ubuntu-24.04-64:tests/nested/manual/component-recovery-system
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-4k-sector-size:logical
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-boot-config-update:gadgetextra
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetsaysnone
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-cloud-init-maas-signed-seed-data:gadgetwithoutopinion
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:gadget_panic_remodel_boot_assets
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-fault-inject-on-remodel:kernel_reboot_remodel_boot_assets
- google-nested:ubuntu-24.04-64:tests/nested/manual/core20-grade-signed-above-testkeys-boot:secured
- google-nested:ubuntu-24.04-64:tests/nested/manual/hybrid-fde-recovery-keys:2404
- google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-core:passphrase_auth
- google-nested:ubuntu-24.04-64:tests/nested/manual/muinstaller-real:seeded
- google-nested:ubuntu-24.04-64:tests/nested/manual/passphrase-support-on-hybrid:2404
- google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system-offline:untested
- google-nested:ubuntu-24.04-64:tests/nested/manual/recovery-system:tested_and_default
2025-07-31 08:00:50 Failed suite restore: 14
- google-nested:ubuntu-24.04-64:tests/nested/manual/
- google-nested:ubuntu-24.04-64:tests/nested/manual/
- google-nested:ubuntu-24.04-64:tests/nested/manual/
- google-nested:ubuntu-24.04-64:tests/nested/manual/
- google-nested:ubuntu-24.04-64:tests/nested/manual/
- google-nested:ubuntu-24.04-64:tests/nested/manual/
- google-nested:ubuntu-24.04-64:tests/nested/manual/
- google-nested:ubuntu-24.04-64:tests/nested/manual/
- google-nested:ubuntu-24.04-64:tests/nested/manual/
- google-nested:ubuntu-24.04-64:tests/nested/manual/
- google-nested:ubuntu-24.04-64:tests/nested/manual/
- google-nested:ubuntu-24.04-64:tests/nested/manual/
- google-nested:ubuntu-24.04-64:tests/nested/manual/
- google-nested:ubuntu-24.04-64:tests/nested/manual/
2025-07-31 08:00:50 Failed project restore: 14
- google-nested:ubuntu-24.04-64:project
- google-nested:ubuntu-24.04-64:project
- google-nested:ubuntu-24.04-64:project
- google-nested:ubuntu-24.04-64:project
- google-nested:ubuntu-24.04-64:project
- google-nested:ubuntu-24.04-64:project
- google-nested:ubuntu-24.04-64:project
- google-nested:ubuntu-24.04-64:project
- google-nested:ubuntu-24.04-64:project
- google-nested:ubuntu-24.04-64:project
- google-nested:ubuntu-24.04-64:project
- google-nested:ubuntu-24.04-64:project
- google-nested:ubuntu-24.04-64:project
- google-nested:ubuntu-24.04-64:project
